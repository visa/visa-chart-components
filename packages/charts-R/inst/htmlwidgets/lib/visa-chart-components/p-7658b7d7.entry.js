/**
 * Copyright (c) 2024 Visa, Inc.
 *
 * This source code is licensed under the MIT license
 * https://github.com/visa/visa-chart-components/blob/master/LICENSE
 *
 **/
import{r as t,c as i,h as s,g as h}from"./p-eeee2e3c.js";import{v as e,s as r,e as a}from"./p-a494a9b5.js";import{m as o}from"./p-cbe185fc.js";import{v as n}from"./p-9cc83250.js";const{propDefaultValues:c}=e;class l{}function u(t){var i=0,s=t.children,h=s&&s.length;if(h)for(;--h>=0;)i+=s[h].value;else i=1;t.value=i}function d(t,i){var s,h,e,r,a,o=new v(t),n=+t.value&&(o.value=t.value),c=[o];for(null==i&&(i=f);s=c.pop();)if(n&&(s.value=+s.data.value),(e=i(s.data))&&(a=e.length))for(s.children=new Array(a),r=a-1;r>=0;--r)c.push(h=s.children[r]=new v(e[r])),h.parent=s,h.depth=s.depth+1;return o.eachBefore(g)}function f(t){return t.children}function p(t){t.data=t.data.data}function g(t){var i=0;do{t.height=i}while((t=t.parent)&&t.height<++i)}function v(t){this.data=t,this.depth=this.height=0,this.parent=null}l.mainTitle="Circle Packing Title",l.subTitle=c.subTitle.text,l.height=400,l.width=400,l.circlePadding=5,l.margin={top:4,bottom:4,right:4,left:4},l.padding={top:4,bottom:4,right:4,left:4},l.localization=c.localization,l.dataDepth=5,l.displayDepth=2,l.parentAccessor="parentNode",l.nodeAccessor="childNode",l.sizeAccessor="value",l.colorPalette=c.colorPaletteSequentialGrey,l.dataLabel=c.dataLabelCenter,l.hoverStyle=c.hoverStyle,l.clickStyle=c.clickStyle,l.hoverOpacity=c.hoverOpacity,l.cursor=c.cursor,l.interactionKeys=c.interactionKeys,l.highestHeadingLevel=c.highestHeadingLevel,l.annotations=c.annotations,l.accessibility=c.accessibility,l.animationConfig=c.animationConfig,l.tooltipLabel=c.tooltipLabel,l.showTooltip=c.showTooltip,l.clickHighlight=c.clickHighlight,l.suppressEvents=c.suppressEvents,v.prototype=d.prototype={constructor:v,count:function(){return this.eachAfter(u)},each:function(t){var i,s,h,e,r=this,a=[r];do{for(i=a.reverse(),a=[];r=i.pop();)if(t(r),s=r.children)for(h=0,e=s.length;h<e;++h)a.push(s[h])}while(a.length);return this},eachAfter:function(t){for(var i,s,h,e=this,r=[e],a=[];e=r.pop();)if(a.push(e),i=e.children)for(s=0,h=i.length;s<h;++s)r.push(i[s]);for(;e=a.pop();)t(e);return this},eachBefore:function(t){for(var i,s,h=this,e=[h];h=e.pop();)if(t(h),i=h.children)for(s=i.length-1;s>=0;--s)e.push(i[s]);return this},sum:function(t){return this.eachAfter((function(i){for(var s=+t(i.data)||0,h=i.children,e=h&&h.length;--e>=0;)s+=h[e].value;i.value=s}))},sort:function(t){return this.eachBefore((function(i){i.children&&i.children.sort(t)}))},path:function(t){for(var i=this,s=function(t,i){if(t===i)return t;var s=t.ancestors(),h=i.ancestors(),e=null;for(t=s.pop(),i=h.pop();t===i;)e=t,t=s.pop(),i=h.pop();return e}(i,t),h=[i];i!==s;)h.push(i=i.parent);for(var e=h.length;t!==s;)h.splice(e,0,t),t=t.parent;return h},ancestors:function(){for(var t=this,i=[t];t=t.parent;)i.push(t);return i},descendants:function(){var t=[];return this.each((function(i){t.push(i)})),t},leaves:function(){var t=[];return this.eachBefore((function(i){i.children||t.push(i)})),t},links:function(){var t=this,i=[];return t.each((function(s){s!==t&&i.push({source:s.parent,target:s})})),i},copy:function(){return d(this).eachBefore(p)}};var m=Array.prototype.slice;function y(t,i){var s,h;if(W(i,t))return[i];for(s=0;s<t.length;++s)if(b(i,t[s])&&W(x(t[s],i),t))return[t[s],i];for(s=0;s<t.length-1;++s)for(h=s+1;h<t.length;++h)if(b(x(t[s],t[h]),i)&&b(x(t[s],i),t[h])&&b(x(t[h],i),t[s])&&W(T(t[s],t[h],i),t))return[t[s],t[h],i];throw new Error}function b(t,i){var s=t.r-i.r,h=i.x-t.x,e=i.y-t.y;return s<0||s*s<h*h+e*e}function w(t,i){var s=t.r-i.r+1e-6,h=i.x-t.x,e=i.y-t.y;return s>0&&s*s>h*h+e*e}function W(t,i){for(var s=0;s<i.length;++s)if(!w(t,i[s]))return!1;return!0}function k(t){switch(t.length){case 1:return{x:(i=t[0]).x,y:i.y,r:i.r};case 2:return x(t[0],t[1]);case 3:return T(t[0],t[1],t[2])}var i}function x(t,i){var s=t.x,h=t.y,e=t.r,r=i.x,a=i.y,o=i.r,n=r-s,c=a-h,l=o-e,u=Math.sqrt(n*n+c*c);return{x:(s+r+n/u*l)/2,y:(h+a+c/u*l)/2,r:(u+e+o)/2}}function T(t,i,s){var h=t.x,e=t.y,r=t.r,a=i.x,o=i.y,n=i.r,c=s.x,l=s.y,u=s.r,d=h-a,f=h-c,p=e-o,g=e-l,v=n-r,m=u-r,y=h*h+e*e-r*r,b=y-a*a-o*o+n*n,w=y-c*c-l*l+u*u,W=f*p-d*g,k=(p*w-g*b)/(2*W)-h,x=(g*v-p*m)/W,T=(f*b-d*w)/(2*W)-e,A=(d*m-f*v)/W,D=x*x+A*A-1,S=2*(r+k*x+T*A),C=k*k+T*T-r*r,E=-(D?(S+Math.sqrt(S*S-4*D*C))/(2*D):C/S);return{x:h+k+x*E,y:e+T+A*E,r:E}}function A(t,i,s){var h,e,r,a,o=t.x-i.x,n=t.y-i.y,c=o*o+n*n;c?(e=i.r+s.r,a=t.r+s.r,(e*=e)>(a*=a)?(h=(c+a-e)/(2*c),r=Math.sqrt(Math.max(0,a/c-h*h)),s.x=t.x-h*o-r*n,s.y=t.y-h*n+r*o):(h=(c+e-a)/(2*c),r=Math.sqrt(Math.max(0,e/c-h*h)),s.x=i.x+h*o-r*n,s.y=i.y+h*n+r*o)):(s.x=i.x+s.r,s.y=i.y)}function D(t,i){var s=t.r+i.r-1e-6,h=i.x-t.x,e=i.y-t.y;return s>0&&s*s>h*h+e*e}function S(t){var i=t._,s=t.next._,h=i.r+s.r,e=(i.x*s.r+s.x*i.r)/h,r=(i.y*s.r+s.y*i.r)/h;return e*e+r*r}function C(t){this._=t,this.next=null,this.previous=null}function E(t){return null==t?null:L(t)}function L(t){if("function"!=typeof t)throw new Error;return t}function N(){return 0}function P(t){return function(){return t}}function I(t){return Math.sqrt(t.value)}function z(t){return function(i){i.children||(i.r=Math.max(0,+t(i)||0))}}function K(t,i){return function(s){if(h=s.children){var h,e,r,a=h.length,o=t(s)*i||0;if(o)for(e=0;e<a;++e)h[e].r+=o;if(r=function(t){if(!(e=t.length))return 0;var i,s,h,e,r,a,o,n,c,l,u;if((i=t[0]).x=0,i.y=0,!(e>1))return i.r;if(i.x=-(s=t[1]).r,s.x=i.r,s.y=0,!(e>2))return i.r+s.r;A(s,i,h=t[2]),i=new C(i),s=new C(s),h=new C(h),i.next=h.previous=s,s.next=i.previous=h,h.next=s.previous=i;t:for(o=3;o<e;++o){A(i._,s._,h=t[o]),h=new C(h),n=s.next,c=i.previous,l=s._.r,u=i._.r;do{if(l<=u){if(D(n._,h._)){i.next=s=n,s.previous=i,--o;continue t}l+=n._.r,n=n.next}else{if(D(c._,h._)){(i=c).next=s,s.previous=i,--o;continue t}u+=c._.r,c=c.previous}}while(n!==c.next);for(h.previous=i,h.next=s,i.next=s.previous=s=h,r=S(i);(h=h.next)!==s;)(a=S(h))<r&&(i=h,r=a);s=i.next}for(i=[s._],h=s;(h=h.next)!==s;)i.push(h._);for(h=function(t){for(var i,s,h=0,e=(t=function(t){for(var i,s,h=t.length;h;)s=Math.random()*h--|0,i=t[h],t[h]=t[s],t[s]=i;return t}(m.call(t))).length,r=[];h<e;)i=t[h],s&&w(s,i)?++h:(s=k(r=y(r,i)),h=0);return s}(i),o=0;o<e;++o)(i=t[o]).x-=h.x,i.y-=h.y;return h.r}(h),o)for(e=0;e<a;++e)h[e].r-=o;s.r=r+o}}}function M(t){return function(i){var s=i.parent;i.r*=t,s&&(i.x=s.x+t*i.x,i.y=s.y+t*i.y)}}var O={depth:-1},G={};function H(t){return t.id}function q(t){return t.parentId}const{configLocalization:j,getGlobalInstances:$,getActiveLanguageString:V,getContrastingStroke:F,createTextStrokeFilter:R,convertColorsToTextures:U,initializeElementAccess:_,initializeDescriptionRoot:B,setElementFocusHandler:Z,setElementAccessID:J,setAccessibilityController:Q,hideNonessentialGroups:X,setAccessTitle:Y,setAccessSubtitle:tt,setAccessLongDescription:it,setAccessExecutiveSummary:st,setAccessPurpose:ht,setAccessContext:et,setAccessStatistics:rt,setAccessChartCounts:at,setAccessStructure:ot,setAccessAnnotation:nt,retainAccessFocus:ct,checkAccessFocus:lt,setElementInteractionAccessState:ut,drawTooltip:dt,setAccessibilityDescriptionWidth:ft,annotate:pt,getPadding:gt,chartAccessors:vt,checkInteraction:mt,checkClicked:yt,checkHovered:bt,convertVisaColor:wt,getColors:Wt,getLicenses:kt,getScopedData:xt,initTooltipStyle:Tt,transitionEndAll:At,overrideTitleTooltip:Dt,roundTo:St,scopeDataKeys:Ct,visaColors:Et,validateAccessibilityProps:Lt,validateLocalizationProps:Nt,findTagLevel:Pt,prepareRenderChange:It,resolveLabelCollision:zt,setSubTitle:Kt}=e,Mt=class{constructor(s){t(this,s),this.clickEvent=i(this,"clickEvent",7),this.hoverEvent=i(this,"hoverEvent",7),this.mouseOutEvent=i(this,"mouseOutEvent",7),this.initialLoadEvent=i(this,"initialLoadEvent",7),this.initialLoadEndEvent=i(this,"initialLoadEndEvent",7),this.drawStartEvent=i(this,"drawStartEvent",7),this.drawEndEvent=i(this,"drawEndEvent",7),this.transitionEndEvent=i(this,"transitionEndEvent",7),this.shouldValidateAccessibility=!0,this.shouldValidateLocalization=!0,this.currentDepth=0,this.zooming=!1,this.timer=0,this.delay=200,this.prevent=!1,this.updated=!1,this.exitSize=0,this.enterSize=0,this.shouldZoom=!1,this.shouldValidateInteractionKeys=!1,this.shouldDrawInteractionState=!1,this.shouldUpdateAnnotations=!1,this.shouldResetRoot=!1,this.shouldSetColors=!1,this.shouldSetSubTitle=!1,this.shouldUpdateDisplayDepth=!1,this.shouldUpdateLabels=!1,this.shouldAddStrokeUnder=!1,this.shouldUpdateCursor=!1,this.shouldUpdateData=!1,this.shouldUpdateTableData=!1,this.shouldValidate=!1,this.shouldBindInteractivity=!1,this.shouldUpdateDescriptionWrapper=!1,this.shouldSetChartAccessibilityTitle=!1,this.shouldSetChartAccessibilitySubtitle=!1,this.shouldSetChartAccessibilityLongDescription=!1,this.shouldSetChartAccessibilityExecutiveSummary=!1,this.shouldSetChartAccessibilityStatisticalNotes=!1,this.shouldSetChartAccessibilityStructureNotes=!1,this.shouldSetParentSVGAccessibility=!1,this.shouldSetGeometryAccessibilityAttributes=!1,this.shouldSetGeometryAriaLabels=!1,this.shouldSetGroupAccessibilityAttributes=!1,this.shouldSetGroupAccessibilityLabel=!1,this.shouldSetChartAccessibilityPurpose=!1,this.shouldSetChartAccessibilityContext=!1,this.shouldSetChartAccessibilityCount=!1,this.shouldSetAnnotationAccessibility=!1,this.shouldUpdateLayout=!1,this.shouldSetTextures=!1,this.shouldSetStrokes=!1,this.shouldSetTextStrokes=!1,this.shouldSetTagLevels=!1,this.shouldRedrawWrapper=!1,this.shouldSetIDs=!1,this.shouldSetLocalizationConfig=!1,this.innerInteractionKeys=[],this.defaultsLoaded={},this.bottomLevel="p",this.topLevel="h2",this.strokes={},this.setCircleFilter=(t,i,s)=>r(s[i]).classed("moving")||this.accessibility.hideStrokes?null:this.filter,this.setIDs=()=>{this.rootG.selectAll("circle:not(.vcl-accessibility-focus-highlight)").attr("id",(t=>"circle-in-pack-"+this.generateValidId(t.data.id)))},this.generateValidId=t=>((t instanceof Date?t.getTime():t)+"-"+this.chartID).replace(/\W/g,"-"),this.setCircleStyle=(t,i,s)=>{const h=r(s[i].parentNode).datum(),e=h.data.data,a=this.colorArr[h.depth]||"#fff",o=yt(e,this.clickHighlight,this.innerInteractionKeys),n=bt(e,this.hoverHighlight,this.innerInteractionKeys),c=0!==h.depth?o&&this.clickStyle.color?Et[this.clickStyle.color]||this.clickStyle.color||a:n&&this.hoverStyle.color&&(Et[this.hoverStyle.color]||this.hoverStyle.color)||a:a;return r(s[i]).attr("stroke",o?F(Et[this.clickStyle.color]||this.clickStyle.color||this.preparedColors[h.depth]):n?F(Et[this.hoverStyle.color]||this.hoverStyle.color||this.preparedColors[h.depth]):this.strokes[h.depth]).attr("stroke-width",o?this.clickStyle.strokeWidth||3:n?this.hoverStyle.strokeWidth||2:this.accessibility.hideStrokes?0:1).attr("stroke-dasharray",n&&!o?"4 3":""),c},this.localization=l.localization,this.mainTitle=l.mainTitle,this.subTitle=l.subTitle,this.height=l.height,this.width=l.width,this.margin=l.margin,this.padding=l.padding,this.circlePadding=l.circlePadding,this.highestHeadingLevel=l.highestHeadingLevel,this.data=void 0,this.uniqueID=void 0,this.dataDepth=l.dataDepth,this.displayDepth=l.displayDepth,this.parentAccessor=l.parentAccessor,this.nodeAccessor=l.nodeAccessor,this.sizeAccessor=l.sizeAccessor,this.colorPalette=l.colorPalette,this.colors=void 0,this.cursor=l.cursor,this.hoverStyle=l.hoverStyle,this.clickStyle=l.clickStyle,this.hoverOpacity=l.hoverOpacity,this.animationConfig=l.animationConfig,this.showTooltip=l.showTooltip,this.tooltipLabel=l.tooltipLabel,this.dataLabel=l.dataLabel,this.dataKeyNames=void 0,this.annotations=l.annotations,this.accessibility=l.accessibility,this.suppressEvents=l.suppressEvents,this.interactionKeys=void 0,this.hoverHighlight=void 0,this.clickHighlight=l.clickHighlight,this.zoomToNode=void 0}dataWatcher(t,i){this.updated=!0,this.shouldUpdateData=!0,this.shouldUpdateTableData=!0,this.shouldValidate=!0,this.shouldZoom=!0,this.shouldAddStrokeUnder=!0,this.shouldSetGeometryAccessibilityAttributes=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldDrawInteractionState=!0,this.shouldSetTextures=!0,this.shouldSetStrokes=!0,this.shouldSetColors=!0}titleWatcher(t,i){this.shouldValidate=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetChartAccessibilityTitle=!0,this.shouldSetParentSVGAccessibility=!0}subtitleWatcher(t,i){this.shouldSetSubTitle=!0,this.shouldSetChartAccessibilitySubtitle=!0,this.shouldSetParentSVGAccessibility=!0}headingWatcher(t,i){this.shouldRedrawWrapper=!0,this.shouldSetTagLevels=!0,this.shouldSetChartAccessibilityCount=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetSubTitle=!0,this.shouldSetChartAccessibilityTitle=!0,this.shouldSetChartAccessibilitySubtitle=!0,this.shouldSetChartAccessibilityLongDescription=!0,this.shouldSetChartAccessibilityContext=!0,this.shouldSetChartAccessibilityExecutiveSummary=!0,this.shouldSetChartAccessibilityPurpose=!0,this.shouldSetChartAccessibilityStatisticalNotes=!0,this.shouldSetChartAccessibilityStructureNotes=!0,this.shouldSetAnnotationAccessibility=!0}clusterWatcher(t,i){this.shouldUpdateData=!0,this.shouldUpdateTableData=!0,this.shouldZoom=!0,this.shouldAddStrokeUnder=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldDrawInteractionState=!0}nodeWatcher(t,i){this.shouldUpdateData=!0,this.shouldUpdateTableData=!0,this.shouldZoom=!0,this.shouldAddStrokeUnder=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldDrawInteractionState=!0}sizeWatcher(t,i){this.shouldUpdateData=!0,this.shouldUpdateTableData=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldZoom=!0}heightWatcher(t,i){this.shouldUpdateLayout=!0,this.shouldResetRoot=!0,this.shouldUpdateData=!0,this.shouldZoom=!0,this.shouldAddStrokeUnder=!0}dataDepthWatcher(t,i){this.shouldUpdateData=!0,this.shouldSetColors=!0,this.shouldZoom=!0}displayDepthWatcher(t,i){this.shouldUpdateDisplayDepth=!0,this.shouldZoom=!0}circlePaddingWatcher(t,i){this.shouldUpdateData=!0,this.shouldZoom=!0}colorsWatcher(t,i){this.shouldSetColors=!0,this.shouldDrawInteractionState=!0,this.shouldSetTextures=!0,this.shouldSetStrokes=!0}showTooltipWatcher(t,i){this.shouldDrawInteractionState=!0}tooltipLabelWatcher(t,i){this.shouldUpdateTableData=!0,this.shouldSetParentSVGAccessibility=!0,this.shouldSetGeometryAriaLabels=!0}hoverOpacityWatcher(t,i){this.shouldDrawInteractionState=!0}interactionStyleWatcher(t,i){this.shouldDrawInteractionState=!0,this.shouldSetTextures=!0,this.shouldSetStrokes=!0,this.shouldSetColors=!0}cursorWatcher(t,i){this.shouldUpdateCursor=!0}clickWatcher(t,i){this.shouldDrawInteractionState=!0}hoverWatcher(t,i){this.shouldDrawInteractionState=!0}zoomWatcher(t,i){this.shouldZoom=!0}interactionWatcher(t,i){this.shouldValidateInteractionKeys=!0,this.shouldUpdateTableData=!0,this.shouldDrawInteractionState=!0,this.shouldSetGeometryAriaLabels=!0}dataKeyNamesWatcher(t,i){this.shouldSetParentSVGAccessibility=!0,this.shouldSetGroupAccessibilityLabel=!0,this.shouldSetGeometryAriaLabels=!0}labelWatcher(t,i){this.shouldUpdateTableData=!0,this.shouldUpdateLabels=!0,this.shouldAddStrokeUnder=!0}accessibilityWatcher(t,i){this.shouldValidate=!0,(!(!t||!t.title)&&t.title)!==(!(!i||!i.title)&&i.title)&&(this.shouldUpdateDescriptionWrapper=!0,this.shouldSetChartAccessibilityTitle=!0,this.shouldSetParentSVGAccessibility=!0),(!(!t||!t.executiveSummary)&&t.executiveSummary)!==(!(!i||!i.executiveSummary)&&i.executiveSummary)&&(this.shouldSetChartAccessibilityExecutiveSummary=!0),(!(!t||!t.purpose)&&t.purpose)!==(!(!i||!i.purpose)&&i.purpose)&&(this.shouldSetChartAccessibilityPurpose=!0),(!(!t||!t.longDescription)&&t.longDescription)!==(!(!i||!i.longDescription)&&i.longDescription)&&(this.shouldSetChartAccessibilityLongDescription=!0),(!(!t||!t.contextExplanation)&&t.contextExplanation)!==(!(!i||!i.contextExplanation)&&i.contextExplanation)&&(this.shouldSetChartAccessibilityContext=!0),(!(!t||!t.statisticalNotes)&&t.statisticalNotes)!==(!(!i||!i.statisticalNotes)&&i.statisticalNotes)&&(this.shouldSetChartAccessibilityStatisticalNotes=!0),(!(!t||!t.structureNotes)&&t.structureNotes)!==(!(!i||!i.structureNotes)&&i.structureNotes)&&(this.shouldSetChartAccessibilityStructureNotes=!0);const s=t&&t.includeDataKeyNames,h=i&&i.includeDataKeyNames;s===h&&(!(!t||!t.elementDescriptionAccessor)&&t.elementDescriptionAccessor)===(!(!i||!i.elementDescriptionAccessor)&&i.elementDescriptionAccessor)||(s!==h&&(this.shouldSetGroupAccessibilityLabel=!0),this.shouldSetGeometryAriaLabels=!0,this.shouldSetParentSVGAccessibility=!0),(!(!t||!t.hideTextures)&&t.hideTextures)!==(!(!i||!i.hideTextures)&&i.hideTextures)&&(this.shouldSetTextures=!0,this.shouldDrawInteractionState=!0),(!(!t||!t.hideStrokes)&&t.hideStrokes)!==(!(!i||!i.hideStrokes)&&i.hideStrokes)&&(this.shouldSetStrokes=!0,this.shouldDrawInteractionState=!0);const e=!(!t||!t.elementsAreInterface)&&t.elementsAreInterface,r=!(!i||!i.elementsAreInterface)&&i.elementsAreInterface;(!!(t&&t.keyboardNavConfig&&t.keyboardNavConfig.disabled)&&t.keyboardNavConfig.disabled)===(!!(i&&i.keyboardNavConfig&&i.keyboardNavConfig.disabled)&&i.keyboardNavConfig.disabled)&&e===r||(this.shouldSetGeometryAriaLabels=!0,this.shouldSetParentSVGAccessibility=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldRedrawWrapper=!0,this.shouldSetChartAccessibilityTitle=!0,this.shouldSetChartAccessibilitySubtitle=!0,this.shouldSetChartAccessibilityLongDescription=!0,this.shouldSetChartAccessibilityContext=!0,this.shouldSetChartAccessibilityExecutiveSummary=!0,this.shouldSetChartAccessibilityPurpose=!0,this.shouldSetChartAccessibilityStatisticalNotes=!0,this.shouldSetChartAccessibilityStructureNotes=!0),e!==r&&(this.shouldDrawInteractionState=!0)}localizationWatcher(t,i){this.shouldValidate=!0,(!(!t||!t.language)&&t.language)!==(!(!i||!i.language)&&i.language)&&(this.shouldSetLocalizationConfig=!0,this.shouldUpdateTableData=!0,this.shouldRedrawWrapper=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetChartAccessibilityCount=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldSetParentSVGAccessibility=!0),(!(!t||!t.numeralLocale)&&t.numeralLocale)!==(!(!i||!i.numeralLocale)&&i.numeralLocale)&&(this.shouldSetLocalizationConfig=!0,this.shouldUpdateTableData=!0,this.shouldRedrawWrapper=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetChartAccessibilityCount=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldSetParentSVGAccessibility=!0)}annotationsWatcher(t,i){this.shouldValidate=!0,this.shouldUpdateAnnotations=!0,this.shouldSetAnnotationAccessibility=!0}idWatcher(t,i){console.error("Change detected in prop uniqueID from value "+i+" to value "+t+". This prop cannot be changed after component has loaded.")}suppressWatcher(t,i){this.shouldBindInteractivity=!0,this.shouldUpdateCursor=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldSetParentSVGAccessibility=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldRedrawWrapper=!0,this.shouldValidate=!0,this.shouldSetSubTitle=!0,this.shouldSetChartAccessibilityTitle=!0,this.shouldSetChartAccessibilitySubtitle=!0,this.shouldSetChartAccessibilityLongDescription=!0,this.shouldSetChartAccessibilityContext=!0,this.shouldSetChartAccessibilityExecutiveSummary=!0,this.shouldSetChartAccessibilityPurpose=!0,this.shouldSetChartAccessibilityStatisticalNotes=!0,this.shouldSetChartAccessibilityStructureNotes=!0}componentWillLoad(){const t=this.uniqueID||"circle-pack-"+n();return this.initialLoadEvent.emit({chartID:t}),new Promise((i=>{this.duration=0,this.chartID=t,this.circlePackingEl.id=this.chartID,this.setLocalizationConfig(),this.setTagLevels(),this.validateInteractionKeys(),this.setTableData(),this.setLayoutData(),this.restructureData(),this.shouldValidateAccessibilityProps(),this.shouldValidateLocalizationProps(),this.setColors(),i("component will load")}))}componentWillUpdate(){return new Promise((t=>{t("component will update")}))}componentDidLoad(){return new Promise((t=>{this.renderRootElements(),this.setTooltipInitialStyle(),this.setChartDescriptionWrapper(),this.setChartAccessibilityTitle(),this.setChartAccessibilitySubtitle(),this.setChartAccessibilityLongDescription(),this.setChartAccessibilityExecutiveSummary(),this.setChartAccessibilityPurpose(),this.setChartAccessibilityContext(),this.setChartAccessibilityStatisticalNotes(),this.setChartAccessibilityStructureNotes(),this.setParentSVGAccessibility(),this.prepareChartForDrawing(),this.reSetRoot(),this.setTextures(),this.setSubTitleElements(),this.setStrokes(),this.setTextStrokes(),this.updateDisplayDepth(),this.enterUpdateExitCircles(this.circleG,this.filterData(this.currentDepth));const i=this.getZoomTarget();this.drawZoomChildren(i),this.setChartCountAccessibility(),this.setGeometryAccessibilityAttributes(),this.setGeometryAriaLabels(),this.addStrokeUnder(),this.zoom(i),this.drawAnnotations(),this.setAnnotationAccessibility(),this.onChangeHandler(),X(this.root.node(),this.circleG.node(),!0),t("component did load")})).then((()=>this.initialLoadEndEvent.emit({chartID:this.chartID})))}componentDidUpdate(){return new Promise((t=>{if(this.duration=this.animationConfig&&this.animationConfig.disabled?0:750,this.prepareChartForDrawing(),this.shouldResetRoot&&(this.reSetRoot(),this.shouldResetRoot=!1),this.shouldSetColors&&(this.setColors(),this.shouldSetColors=!1),this.shouldSetTextures&&(this.setTextures(),this.shouldSetTextures=!1),this.shouldSetStrokes&&(this.setStrokes(),this.shouldSetStrokes=!1),this.shouldSetTextStrokes&&(this.setTextStrokes(),this.shouldSetTextStrokes=!1),this.shouldSetIDs&&(this.setIDs(),this.shouldSetIDs=!1),this.shouldUpdateDescriptionWrapper&&(this.setChartDescriptionWrapper(),this.shouldUpdateDescriptionWrapper=!1),this.shouldSetChartAccessibilityCount&&(this.setChartCountAccessibility(),this.shouldSetChartAccessibilityCount=!1),this.shouldSetChartAccessibilityTitle&&(this.setChartAccessibilityTitle(),this.shouldSetChartAccessibilityTitle=!1),this.shouldSetChartAccessibilitySubtitle&&(this.setChartAccessibilitySubtitle(),this.shouldSetChartAccessibilitySubtitle=!1),this.shouldSetChartAccessibilityLongDescription&&(this.setChartAccessibilityLongDescription(),this.shouldSetChartAccessibilityLongDescription=!1),this.shouldSetChartAccessibilityExecutiveSummary&&(this.setChartAccessibilityExecutiveSummary(),this.shouldSetChartAccessibilityExecutiveSummary=!1),this.shouldSetChartAccessibilityPurpose&&(this.setChartAccessibilityPurpose(),this.shouldSetChartAccessibilityPurpose=!1),this.shouldSetChartAccessibilityContext&&(this.setChartAccessibilityContext(),this.shouldSetChartAccessibilityContext=!1),this.shouldSetChartAccessibilityStatisticalNotes&&(this.setChartAccessibilityStatisticalNotes(),this.shouldSetChartAccessibilityStatisticalNotes=!1),this.shouldSetChartAccessibilityStructureNotes&&(this.setChartAccessibilityStructureNotes(),this.shouldSetChartAccessibilityStructureNotes=!1),this.shouldSetParentSVGAccessibility&&(this.setParentSVGAccessibility(),this.shouldSetParentSVGAccessibility=!1),this.shouldUpdateDisplayDepth&&(this.updateDisplayDepth(),this.shouldUpdateDisplayDepth=!1),this.shouldZoom){const t=this.getZoomTarget();this.drawZoomChildren(t),this.zoom(t),this.shouldZoom=!1}else if(this.shouldUpdateLabels){const t=this.getZoomTarget();t.children&&t.children.length&&this.setLabelSelections(t.children),this.shouldUpdateLabels=!1}this.shouldAddStrokeUnder&&(this.addStrokeUnder(),this.shouldAddStrokeUnder=!1),this.shouldSetGeometryAccessibilityAttributes&&(this.setGeometryAccessibilityAttributes(),this.shouldSetGeometryAccessibilityAttributes=!1),this.shouldSetGeometryAriaLabels&&(this.setGeometryAriaLabels(),this.shouldSetGeometryAriaLabels=!1),this.shouldBindInteractivity&&(this.bindInteractivity(),this.shouldBindInteractivity=!1),this.shouldDrawInteractionState&&(this.updateInteractionState(),this.shouldDrawInteractionState=!1),this.shouldSetSubTitle&&(this.setSubTitleElements(),this.shouldSetSubTitle=!1),this.shouldUpdateCursor&&(this.updateCursor(),this.shouldUpdateCursor=!1),this.shouldUpdateAnnotations&&(this.drawAnnotations(),this.shouldUpdateAnnotations=!1),this.shouldSetAnnotationAccessibility&&(this.setAnnotationAccessibility(),this.shouldSetAnnotationAccessibility=!1),this.onChangeHandler(),t("component did update")})).then((()=>this.drawEndEvent.emit({chartID:this.chartID})))}shouldValidateLocalizationProps(){const t=$(),i=t.i18Next.getResourceBundle(t.i18Next.language),s=t.numeral.localeData();this.shouldValidateLocalization&&!this.localization.skipValidation&&(this.shouldValidateLocalization=!1,Nt(this.chartID,Object.assign(Object.assign({},this.localization),{language:i,numeralLocale:s})))}shouldValidateAccessibilityProps(){this.shouldValidateAccessibility&&!this.accessibility.disableValidation&&(this.shouldValidateAccessibility=!1,Lt(this.chartID,Object.assign({},this.accessibility),{annotations:this.annotations,data:this.data,uniqueID:this.uniqueID,context:{mainTitle:this.mainTitle,onClickEvent:this.suppressEvents?void 0:this.clickEvent.emit}}))}setTableData(){const t=Ct(this,vt,"circle-packing");this.tableData=xt(this.data,t),this.tableColumns=Object.keys(t)}setLayoutData(){this.padding="string"==typeof this.padding?gt(this.padding):this.padding,this.innerHeight=this.height-this.margin.top-this.margin.bottom,this.innerWidth=this.width-this.margin.left-this.margin.right,this.innerPaddedHeight=this.innerHeight-this.padding.top-this.padding.bottom,this.innerPaddedWidth=this.innerWidth-this.padding.left-this.padding.right}restructureData(){this.diameter=Math.min(this.innerPaddedWidth,this.innerPaddedHeight),this.holder=function(){var t=H,i=q;function s(s){var h,e,r,a,o,n,c,l=s.length,u=new Array(l),d={};for(e=0;e<l;++e)o=u[e]=new v(h=s[e]),null!=(n=t(h,e,s))&&(n+="")&&(d[c="$"+(o.id=n)]=c in d?G:o);for(e=0;e<l;++e)if(o=u[e],null!=(n=i(s[e],e,s))&&(n+="")){if(!(a=d["$"+n]))throw new Error("missing: "+n);if(a===G)throw new Error("ambiguous: "+n);a.children?a.children.push(o):a.children=[o],o.parent=a}else{if(r)throw new Error("multiple roots");r=o}if(!r)throw new Error("no root");if(r.parent=O,r.eachBefore((function(t){t.depth=t.parent.depth+1,--l})).eachBefore(g),r.parent=null,l>0)throw new Error("cycle");return r}return s.id=function(i){return arguments.length?(t=L(i),s):t},s.parentId=function(t){return arguments.length?(i=L(t),s):i},s}().id((t=>t[this.nodeAccessor])).parentId((t=>t[this.parentAccessor]))(this.data),this.rootCircle=d(this.holder).sum((t=>t.data[this.sizeAccessor]||1)).sort(((t,i)=>i.data.value-t.data.value)),this.nodes=function(){var t=null,i=1,s=1,h=N;function e(e){return e.x=i/2,e.y=s/2,t?e.eachBefore(z(t)).eachAfter(K(h,.5)).eachBefore(M(1)):e.eachBefore(z(I)).eachAfter(K(N,1)).eachAfter(K(h,e.r/Math.min(i,s))).eachBefore(M(Math.min(i,s)/(2*e.r))),e}return e.radius=function(i){return arguments.length?(t=E(i),e):t},e.size=function(t){return arguments.length?(i=+t[0],s=+t[1],e):[i,s]},e.padding=function(t){return arguments.length?(h="function"==typeof t?t:P(+t),e):h},e}().size([this.diameter-this.circlePadding,this.diameter-this.circlePadding]).padding(this.circlePadding)(this.rootCircle).descendants(),this.innerDataDepth=this.dataDepth?Math.min(o(this.nodes,(t=>t.depth)),this.dataDepth):o(this.nodes,(t=>t.depth)),this.nodes=this.nodes.filter((t=>!(t.depth>this.innerDataDepth)))}getLanguageString(){return V(this.localization)}setLocalizationConfig(){j(this.localization)}validateInteractionKeys(){this.innerInteractionKeys=!this.interactionKeys||this.interactionKeys&&0===this.interactionKeys.length?[this.nodeAccessor]:[...this.interactionKeys]}prepareChartForDrawing(){const t=this.zoomToNode?this.generateValidId(this.zoomToNode[this.nodeAccessor]):"",i=this.zoomToNode?this.rootG.select("#circle-in-pack-"+t).data()[0]:this.rootCircle;this.view=this.view?this.view:[i.x,i.y,2*i.r],this.zoomRatio=this.zoomRatio?this.zoomRatio:this.diameter/this.view[2],this.currentDepth=i.depth}renderRootElements(){this.svg=r(this.circlePackingEl).select(".visa-viz-circle-packing-container").append("svg").attr("width",this.width).attr("height",this.height).attr("viewBox","0 0 "+this.width+" "+this.height).attr("data-testid","root-svg"),this.root=this.svg.append("g").attr("id","visa-viz-margin-container-g-"+this.chartID).attr("data-testid","margin-container"),this.rootG=this.root.append("g").attr("id","visa-viz-padding-container-g-"+this.chartID).attr("data-testid","padding-container"),this.circleG=this.rootG.append("g").attr("class","circle-pack-group").attr("data-testid","circle-group"),this.textG=this.rootG.append("g").attr("class","circle-pack-text-group").attr("data-testid","dataLabel-group"),this.subTitleG=r(this.circlePackingEl).select(".circle-packing-sub-title"),this.tooltipG=r(this.circlePackingEl).select(".circle-packing-tooltip")}reSetRoot(){It({selection:this.svg,duration:this.duration,namespace:"root_reset"}).attr("width",this.width).attr("height",this.height).attr("viewBox","0 0 "+this.width+" "+this.height),It({selection:this.root,duration:this.duration,namespace:"root_reset"}).attr("transform",`translate(${this.diameter/2+this.margin.left}, ${this.diameter/2+this.margin.top})`),It({selection:this.rootG,duration:this.duration,namespace:"root_reset"}).attr("transform",`translate(${this.padding.left}, ${this.padding.top})`),void 0!==this.filter&&this.enterUpdateExitCircles(this.circleG,this.filterData(0)),ft(this.chartID,this.width)}setGlobalSelections(){this.circle=this.rootG.selectAll("circle:not(.vcl-accessibility-focus-highlight)")}enterUpdateExitCircles(t,i){const s=i[0].depth,h=t.selectAll(".g-level-"+s).data(i,(t=>t.data.id));this.enterCircle=h.enter().append("g"),this.enterSize+=this.enterCircle.size(),this.exitCircle=h.exit(),this.enterCircles(s),this.exitCircles(this.exitCircle,!0),this.updateParentCircle=h.merge(this.enterCircle),this.updateParentCircle.order(),this.checkRecursion(s)}enterCircles(t){this.enterCircle.attr("class","g-level-"+t).attr("id",(t=>"circle-in-pack-"+this.generateValidId(t.data.id))),this.enterCircle.append("circle").attr("filter",this.setCircleFilter).classed("node node-level-"+t,!0).classed("node--root",((t,i,s)=>!r(s[i].parentNode).datum().parent)).on("mouseover",this.suppressEvents?null:(t,i,s)=>{const h=r(s[i].parentNode).datum();this.onHoverHandler(h,s[i])}).on("mouseout",this.suppressEvents?null:()=>{this.onMouseOutHandler()}).on("click",this.suppressEvents?null:(t,i,s)=>{const h=r(s[i].parentNode).datum();this.zooming||this.clickEvent.emit({data:h.data.data,target:s[i]})}).attr("fill",this.setCircleStyle).attr("opacity",((t,i,s)=>{const h=r(s[i].parentNode).datum();return mt(h.data.data,1,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)})).each(((t,i,s)=>{_(s[i]),Z({node:s[i],geomType:"node",includeKeyNames:this.accessibility.includeDataKeyNames,dataKeys:Ct(this,vt,"circle-packing"),dataKeyNames:this.dataKeyNames,recursive:!0,groupName:"node",uniqueID:this.chartID}),J({node:s[i],uniqueID:this.chartID});const h=r(s[i].parentNode).datum();let e=mt(h,!0,!1,"",this.clickHighlight,this.innerInteractionKeys);e=!(!this.clickHighlight||!this.clickHighlight.length)&&e,ut(s[i],e,this.accessibility.elementsAreInterface)})).attr("data-testid","circle").attr("data-id",((t,i,s)=>{const h=r(s[i].parentNode).datum().data.data;return`circle-${h[this.parentAccessor]}-${h[this.nodeAccessor]}`})).attr("cursor",this.suppressEvents?null:this.cursor).attr("transform",(t=>"translate("+St((t.x-this.view[0])*this.zoomRatio,4)+","+St((t.y-this.view[1])*this.zoomRatio,4)+")")).attr("r",0)}exitCircles(t,i){if(t.size()){this.exitSize+=t.size(),i&&(this.exitSize+=t.selectAll("g").size());const s=lt(this.rootG.node());t.remove(),this.setChartCountAccessibility(),this.setGeometryAriaLabels(),ct({parentGNode:this.rootG.node(),focusDidExist:s,recursive:!0})}}checkRecursion(t){this.updateParentCircle.each(((i,s,h)=>{let e=0;i.depth+1<=this.currentDepth+this.innerDisplayDepth&&(e=t+1),e&&i.children&&i.children.length?this.enterUpdateExitCircles(r(h[s]),i.children):this.exitCircles(r(h[s]).selectAll("g"),!1)}))}setLabelSelections(t){const i=this.textG.selectAll("text").data(t,(t=>(t.data||{}).id));this.enterText=i.enter().append("text"),this.updateText=i.merge(this.enterText),this.exitText=i.exit().remove(),this.enterLabels(),this.drawLabels()}enterLabels(){this.enterText.attr("filter",this.textFilter).attr("class","label circle-packing-dataLabel").attr("cursor",this.suppressEvents?null:this.cursor).attr("data-testid","dataLabel").attr("data-x",(t=>St((t.x-this.view[0])*this.zoomRatio,4))).attr("data-y",(t=>St((t.y-this.view[1])*this.zoomRatio,4))).attr("data-translate-x",this.diameter/2+this.margin.left).attr("data-translate-y",this.diameter/2+this.margin.top).attr("x",(t=>St((t.x-this.view[0])*this.zoomRatio,4))).attr("y",(t=>St((t.y-this.view[1])*this.zoomRatio,4))).attr("text-anchor","middle")}drawLabels(){this.updateText.attr("opacity",(()=>this.dataLabel.visible?1:0)).text((t=>this.dataLabel.labelAccessor?t.data.data[this.dataLabel.labelAccessor]:t.data.data[this.nodeAccessor])),!this.shouldZoom&&this.shouldUpdateLabels&&this.placeLabels()}placeLabels(){const t="auto"!==this.dataLabel.placement&&this.dataLabel.collisionHideOnly,i=this.updateText.classed("moving",((t,i,s)=>{const h=+r(s[i]).attr("data-x"),e=+r(s[i]).attr("data-y"),a=St((t.x-this.view[0])*this.zoomRatio,4),o=St((t.y-this.view[1])*this.zoomRatio,4);return h!==a||e!==o})).attr("data-x",(t=>St((t.x-this.view[0])*this.zoomRatio,4))).attr("data-y",(t=>St((t.y-this.view[1])*this.zoomRatio,4))).attr("data-translate-x",this.diameter/2+this.margin.left).attr("data-translate-y",this.diameter/2+this.margin.top).style("visibility",((t,i,s)=>"auto"===this.dataLabel.placement||this.dataLabel.collisionHideOnly?r(s[i]).style("visibility"):null)).attr("filter",null).transition("place").duration(this.duration),s={all:{validPositions:["middle","top","bottom","left","right","bottom-right","bottom-left","top-left","top-right"],offsets:[1,1,2,4,4,1,1,1,1]},centroid:{validPositions:["middle"],offsets:[1]},top:{validPositions:["top","top-left","top-right"],offsets:[1,1,1]},middle:{validPositions:["middle","left","right"],offsets:[1,4,4]},bottom:{validPositions:["bottom","bottom-left","bottom-right"],offsets:[2,1,1]},right:{validPositions:["right","top-right","bottom-right"],offsets:[4,1,1]},left:{validPositions:["left","top-left","bottom-left"],offsets:[4,1,1]}},h=this.dataLabel&&this.dataLabel.collisionPlacement;this.dataLabel.visible&&("auto"===this.dataLabel.placement||this.dataLabel.collisionHideOnly)?(this.bitmaps=zt({labelSelection:i,avoidMarks:[],validPositions:t?["middle"]:h&&s[h]?s[h].validPositions:s.all.validPositions,offsets:t?[1]:h&&s[h]?s[h].offsets:s.all.offsets,accessors:[this.parentAccessor,this.nodeAccessor],size:[St(this.innerPaddedWidth),St(this.innerPaddedHeight)],hideOnly:this.dataLabel.visible&&t}),t&&i.attr("x",(t=>St((t.x-this.view[0])*this.zoomRatio,4))).attr("y",(t=>St((t.y-this.view[1])*this.zoomRatio,4)))):i.attr("x",(t=>St((t.x-this.view[0])*this.zoomRatio,4))).attr("y",(t=>St((t.y-this.view[1])*this.zoomRatio,4))),i.call(At,(()=>{this.updateText.classed("moving",!1),setTimeout((()=>{this.addStrokeUnder()}),0)}))}addStrokeUnder(){this.updateText.attr("filter",this.textFilter)}setTextStrokes(){this.textFilter=R({root:this.svg.node(),id:this.chartID,color:"#ffffff"}),this.filter=R({root:this.svg.node(),id:this.chartID,color:"#ffffff",strokeSizeOverride:1})}bindInteractivity(){this.circle.on("mouseover",this.suppressEvents?null:(t,i,s)=>{const h=r(s[i].parentNode).datum();this.onHoverHandler(h,s[i])}).on("mouseout",this.suppressEvents?null:()=>{this.onMouseOutHandler()}).on("click",this.suppressEvents?null:(t,i,s)=>{const h=r(s[i].parentNode).datum();this.zooming||this.clickEvent.emit({data:h.data.data,target:s[i]})})}drawAnnotations(){pt({source:this.rootG.node(),data:this.annotations,width:this.width,height:this.height,padding:this.padding,margin:this.margin,bitmaps:this.bitmaps})}setAnnotationAccessibility(){nt(this.getLanguageString(),this.circlePackingEl,this.annotations,void 0)}setSubTitleElements(){Kt({root:this.subTitleG,subTitle:this.subTitle})}setColors(){this.preparedColors=this.colors?wt(this.colors):Wt(this.colorPalette,this.innerDataDepth+1)}setTextures(){const t=this.preparedColors.range?this.preparedColors.range():this.preparedColors;if(this.accessibility.hideTextures||t.length>6)this.colorArr=this.preparedColors;else{const i=U({colors:t,rootSVG:this.svg.node(),id:this.chartID,scheme:"categorical",disableTransitions:!this.duration});this.colorArr=this.preparedColors.range?this.preparedColors.copy().range(i):i}}setStrokes(){this.strokes=[],this.preparedColors.forEach((t=>{this.strokes.push(F(t))}))}updateDisplayDepth(){this.innerDisplayDepth=this.displayDepth?Math.min(o(this.nodes,(t=>t.depth)),this.displayDepth):o(this.nodes,(t=>t.depth)),this.circleG&&this.circleG.selectAll("g").each(((t,i,s)=>{t.depth>this.innerDisplayDepth&&(this.exitSize++,this.exitSize+=r(s[i]).selectAll("g").size(),r(s[i]).remove())}))}updateCursor(){this.circle.attr("cursor",this.suppressEvents?null:this.cursor)}updateInteractionState(){this.circle.attr("fill",this.setCircleStyle).attr("filter",this.setCircleFilter).attr("opacity",((t,i,s)=>{const h=r(s[i].parentNode).datum();return mt(h.data.data,1,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)})).each(((t,i,s)=>{const h=r(s[i].parentNode).datum();let e=mt(h,!0,!1,"",this.clickHighlight,this.innerInteractionKeys);e=!(!this.clickHighlight||!this.clickHighlight.length)&&e,ut(s[i],e,this.accessibility.elementsAreInterface)})),this.zooming||ct({parentGNode:this.rootG.node(),recursive:!0})}drawZoomChildren(t){if(t.children&&t.children.length){const i=this.generateValidId(t.data.id);this.enterUpdateExitCircles(this.rootG.select("#circle-in-pack-"+i),t.children),this.setGlobalSelections(),this.setLabelSelections(t.children)}else t&&(this.setGlobalSelections(),this.setLabelSelections([t]))}getZoomTarget(){const t=this.zoomToNode?this.generateValidId(this.zoomToNode[this.nodeAccessor]):"";return this.zoomToNode?this.rootG.select("#circle-in-pack-"+t).datum():this.rootCircle}zoom(t){this.zooming=!0,this.view=[t.x,t.y,2*t.r],this.zoomRatio=this.diameter/this.view[2],this.circle.classed("moving",((t,i,s)=>{const h=r(s[i].parentNode).datum(),e=+r(s[i]).attr("data-cx"),a=+r(s[i]).attr("data-cy"),o=+r(s[i]).attr("r"),n=St((h.x-this.view[0])*this.zoomRatio,4),c=St((h.y-this.view[1])*this.zoomRatio,4);return o!==h.r*this.zoomRatio||e!==n||a!==c})).attr("data-cx",((t,i,s)=>{const h=r(s[i].parentNode).datum();return St((h.x-this.view[0])*this.zoomRatio,4)})).attr("data-cy",((t,i,s)=>{const h=r(s[i].parentNode).datum();return St((h.y-this.view[1])*this.zoomRatio,4)})).attr("data-r",((t,i,s)=>r(s[i].parentNode).datum().r*this.zoomRatio)).attr("data-translate-x",this.diameter/2+this.margin.left).attr("data-translate-y",this.diameter/2+this.margin.top);const i=this.circle.filter(".moving").attr("filter",null).transition("zoom").duration(this.duration).attr("transform",((t,i,s)=>{const h=r(s[i].parentNode).datum();return"translate("+St((h.x-this.view[0])*this.zoomRatio,4)+","+St((h.y-this.view[1])*this.zoomRatio,4)+")"})).attr("r",((t,i,s)=>r(s[i].parentNode).datum().r*this.zoomRatio)),s=()=>{this.zooming=!1,this.circle.classed("moving",!1),setTimeout((()=>{this.circle.attr("filter",this.setCircleFilter)}),0),ct({parentGNode:this.rootG.node(),recursive:!0}),this.transitionEndEvent.emit({chartID:this.chartID})};this.duration&&i.size()>0?i.attrTween("x",((t,i,s)=>{const h=r(s[i]).classed("vcl-accessibility-focus-source");return()=>(h&&ct({parentGNode:this.rootG.node(),recursive:!0}),0)})).call(At,s):s(),this.placeLabels()}onHoverHandler(t,i){Dt(this.chartID,!0),this.hoverEvent.emit({data:t.data.data,target:i}),this.showTooltip&&this.eventsTooltip({data:t.data.data,evt:a,isToShow:!0})}onMouseOutHandler(){Dt(this.chartID,!1),this.mouseOutEvent.emit(),this.showTooltip&&this.eventsTooltip({isToShow:!1})}setTooltipInitialStyle(){Tt(this.tooltipG)}eventsTooltip({data:t,evt:i,isToShow:s}){dt({root:this.tooltipG,data:t,event:i,isToShow:s,tooltipLabel:this.tooltipLabel,dataLabel:this.dataLabel,dataKeyNames:this.dataKeyNames,ordinalAccessor:this.nodeAccessor,groupAccessor:this.parentAccessor,valueAccessor:this.sizeAccessor,chartType:"circle-packing"})}setTagLevels(){this.topLevel=Pt(this.highestHeadingLevel),this.bottomLevel=Pt(this.highestHeadingLevel,3)}setChartDescriptionWrapper(){B({language:this.getLanguageString(),rootEle:this.circlePackingEl,title:this.accessibility.title||this.mainTitle,chartTag:"circle-packing",uniqueID:this.chartID,highestHeadingLevel:this.highestHeadingLevel,recursive:!0,redraw:this.shouldRedrawWrapper,disableKeyNav:this.suppressEvents&&!1===this.accessibility.elementsAreInterface&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled,hideDataTable:this.accessibility.hideDataTableButton}),this.shouldRedrawWrapper=!1}setParentSVGAccessibility(){Q({chartTag:"circle-packing",language:this.getLanguageString(),node:this.svg.node(),title:this.accessibility.title||this.mainTitle,description:this.subTitle,uniqueID:this.chartID,geomType:"node",includeKeyNames:this.accessibility.includeDataKeyNames,dataKeys:Ct(this,vt,"circle-packing"),dataKeyNames:this.dataKeyNames,groupAccessor:this.parentAccessor,groupName:"node",recursive:!0,disableKeyNav:this.suppressEvents&&!1===this.accessibility.elementsAreInterface&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled})}setGeometryAccessibilityAttributes(){this.rootG.selectAll(".node").each(((t,i,s)=>{_(s[i])}))}setGeometryAriaLabels(){const t=Ct(this,vt,"circle-packing");this.rootG.selectAll(".node").each(((i,s,h)=>{Z({chartTag:"circle-packing",langauge:this.getLanguageString(),node:h[s],geomType:"node",includeKeyNames:this.accessibility.includeDataKeyNames,dataKeys:t,dataKeyNames:this.dataKeyNames,recursive:!0,groupName:"node",uniqueID:this.chartID,disableKeyNav:this.suppressEvents&&!1===this.accessibility.elementsAreInterface&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled}),J({node:h[s],uniqueID:this.chartID})}))}setChartAccessibilityTitle(){Y(this.getLanguageString(),this.circlePackingEl,this.accessibility.title||this.mainTitle)}setChartAccessibilitySubtitle(){tt(this.getLanguageString(),this.circlePackingEl,this.subTitle)}setChartAccessibilityLongDescription(){it(this.getLanguageString(),this.circlePackingEl,this.accessibility.longDescription)}setChartAccessibilityExecutiveSummary(){st(this.getLanguageString(),this.circlePackingEl,this.accessibility.executiveSummary)}setChartAccessibilityPurpose(){ht(this.getLanguageString(),this.circlePackingEl,this.accessibility.purpose)}setChartAccessibilityContext(){et(this.getLanguageString(),this.circlePackingEl,this.accessibility.contextExplanation)}setChartAccessibilityStatisticalNotes(){rt(this.getLanguageString(),this.circlePackingEl,this.accessibility.statisticalNotes)}setChartCountAccessibility(){at({rootEle:this.circlePackingEl,parentGNode:this.circleG.node(),chartTag:"circle-packing",geomType:"node",groupName:"node",recursive:!0})}setChartAccessibilityStructureNotes(){ot(this.getLanguageString(),this.circlePackingEl,this.accessibility.structureNotes)}onChangeHandler(){this.accessibility&&"function"==typeof this.accessibility.onChangeFunc&&this.accessibility.onChangeFunc({updated:this.updated,added:this.enterSize,removed:this.exitSize}),this.updated=!1,this.enterSize=0,this.exitSize=0}filterData(t){return this.nodes.filter((i=>i.depth===t))}render(){return this.drawStartEvent.emit({chartID:this.chartID}),this.init(),this.shouldSetLocalizationConfig&&(this.setLocalizationConfig(),this.shouldSetLocalizationConfig=!1),this.shouldSetTagLevels&&(this.setTagLevels(),this.shouldSetTagLevels=!1),this.shouldValidateInteractionKeys&&(this.validateInteractionKeys(),this.shouldValidateInteractionKeys=!1),this.shouldUpdateTableData&&(this.setTableData(),this.shouldUpdateTableData=!1),this.shouldValidate&&(this.shouldValidateAccessibilityProps(),this.shouldValidateLocalizationProps(),this.shouldValidate=!1),this.shouldUpdateLayout&&(this.setLayoutData(),this.shouldUpdateLayout=!1),this.shouldUpdateData&&(this.restructureData(),this.shouldUpdateData=!1),s("div",{class:"o-layout","data-testid":"outer-layout"},s("div",{class:"o-layout--chart","data-testid":"layout-chart"},s(this.topLevel,{"data-testid":"main-title"},this.mainTitle),s(this.bottomLevel,{class:"visa-ui-text--instructions circle-packing-sub-title vcl-sub-title","data-testid":"sub-title"}),s("keyboard-instructions",{uniqueID:this.chartID,geomType:"node",groupName:"node collection",language:this.getLanguageString(),chartTag:"circle-packing",width:this.width-(this.margin&&this.margin.right||0),isInteractive:this.accessibility.elementsAreInterface,hasCousinNavigation:!0,disabled:this.suppressEvents&&!1===this.accessibility.elementsAreInterface&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled}),s("div",{class:"visa-viz-circle-packing-container","data-testid":"chart-container"}),s("div",{class:"circle-packing-tooltip vcl-tooltip","data-testid":"tooltip-container",style:{display:this.showTooltip?"block":"none"}}),s("data-table",{uniqueID:this.chartID,language:this.getLanguageString(),unitTest:!0,isCompact:!0,tableColumns:this.tableColumns,dataKeyNames:this.dataKeyNames,data:this.tableData,padding:this.padding,margin:this.margin,hideDataTable:this.accessibility.hideDataTableButton})))}init(){const t=Object.keys(l);let i=0;const s={showTooltip:{exception:!1},circlePadding:{exception:0},mainTitle:{exception:""},subTitle:{exception:""},hoverOpacity:{exception:0}};for(i=0;i<t.length;i++)this[t[i]]||s[t[i]]&&this[t[i]]===s[t[i]].exception||l[t[i]]===this[t[i]]||(this[t[i]]=l[t[i]])}get circlePackingEl(){return h(this)}static get watchers(){return{data:["dataWatcher"],mainTitle:["titleWatcher"],subTitle:["subtitleWatcher"],highestHeadingLevel:["headingWatcher"],parentAccessor:["clusterWatcher"],nodeAccessor:["nodeWatcher"],sizeAccessor:["sizeWatcher"],height:["heightWatcher"],width:["heightWatcher"],padding:["heightWatcher"],margin:["heightWatcher"],dataDepth:["dataDepthWatcher"],displayDepth:["displayDepthWatcher"],circlePadding:["circlePaddingWatcher"],colors:["colorsWatcher"],colorPalette:["colorsWatcher"],showTooltip:["showTooltipWatcher"],tooltipLabel:["tooltipLabelWatcher"],hoverOpacity:["hoverOpacityWatcher"],clickStyle:["interactionStyleWatcher"],hoverStyle:["interactionStyleWatcher"],cursor:["cursorWatcher"],clickHighlight:["clickWatcher"],hoverHighlight:["hoverWatcher"],zoomToNode:["zoomWatcher"],interactionKeys:["interactionWatcher"],dataKeyNames:["dataKeyNamesWatcher"],dataLabel:["labelWatcher"],accessibility:["accessibilityWatcher"],localization:["localizationWatcher"],annotations:["annotationsWatcher"],uniqueID:["idWatcher"],suppressEvents:["suppressWatcher"]}}};window.VisaChartsLibOSSLicenses=kt(),Mt.style='.o-layout{width:100%;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.o-layout--chart{width:100%}.is--vertical .o-layout--chart{width:90%}circle-packing .vcl-sub-title-keyword{-webkit-padding-before:1px;padding:3px 6px 1px 6px}circle-packing .screen-reader-info{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}circle-packing .annotations{pointer-events:none}circle-packing .annotations .handle{pointer-events:all}circle-packing .label{font:12px "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;text-anchor:middle}circle-packing .label,circle-packing .node--root{pointer-events:none}';export{Mt as circle_packing}