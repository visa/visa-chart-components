/**
 * Copyright (c) 2023 Visa, Inc.
 *
 * This source code is licensed under the MIT license
 * https://github.com/visa/visa-chart-components/blob/master/LICENSE
 *
 **/
import{r as t,c as i,h as s,g as h}from"./p-eeee2e3c.js";import{m as e}from"./p-cbe185fc.js";import{m as a}from"./p-b0dcbe24.js";import{b as o}from"./p-b9c5f66c.js";import{n as r}from"./p-be615bb3.js";import{q as c}from"./p-3e62422c.js";import{v as n,s as l,e as d}from"./p-2c07c4b3.js";import{v as p}from"./p-5aee2b76.js";import{c as u}from"./p-209ccfff.js";import"./p-1e7506b0.js";import"./p-19a4f06b.js";const{propDefaultValues:m}=n;class g{}g.mainTitle="Heat Map Title",g.subTitle=m.subTitle.text,g.height=250,g.width=500,g.margin={top:2.5,bottom:2.5,right:5,left:5},g.padding={top:20,bottom:30,right:60,left:80},g.localization=m.localization,g.xAccessor="date",g.yAccessor="category",g.valueAccessor="value",g.shape="rect",g.hideAxisPath=m.showBaselineFalse,g.accessibility=m.accessibility,g.animationConfig=m.animationConfig,g.highestHeadingLevel=m.highestHeadingLevel,g.xAxis=m.xAxis,g.yAxis=m.yAxis,g.wrapLabel=m.wrapLabel,g.strokeWidth=m.strokeWidth2,g.colorPalette=m.colorPaletteSequential,g.colorSteps=m.colorSteps5,g.hoverStyle=m.hoverStyle,g.clickStyle=m.clickStyle,g.cursor=m.cursor,g.hoverOpacity=m.hoverOpacity,g.dataLabel=m.dataLabel,g.legend=m.legend,g.tooltipLabel=m.tooltipLabel,g.showTooltip=m.showTooltip,g.suppressEvents=m.suppressEvents,g.referenceLines=m.referenceLines,g.annotations=m.annotations,g.clickHighlight=m.clickHighlight;const{getGlobalInstances:y,configLocalization:v,getActiveLanguageString:b,calculateLuminance:x,prepareStrokeColorsFromScheme:f,verifyTextHasSpace:A,checkAttributeTransitions:W,createTextStrokeFilter:w,drawHoverStrokes:T,removeHoverStrokes:S,buildStrokes:k,convertColorsToTextures:D,findTagLevel:L,prepareRenderChange:C,initializeDescriptionRoot:I,initializeElementAccess:E,setElementFocusHandler:O,setElementAccessID:z,setAccessibilityController:N,hideNonessentialGroups:j,setAccessTitle:K,setAccessSubtitle:H,setAccessLongDescription:P,setAccessExecutiveSummary:G,setAccessPurpose:q,setAccessContext:V,setAccessStatistics:M,setAccessChartCounts:$,setAccessXAxis:F,setAccessYAxis:R,setAccessStructure:X,setAccessAnnotation:Y,retainAccessFocus:_,checkAccessFocus:B,setElementInteractionAccessState:U,setAccessibilityDescriptionWidth:J,autoTextColor:Q,annotate:Z,chartAccessors:tt,checkInteraction:it,checkClicked:st,checkHovered:ht,convertVisaColor:et,drawAxis:at,drawLegend:ot,drawTooltip:rt,formatStats:ct,formatDate:nt,getColors:lt,getLicenses:dt,getPadding:pt,getScopedData:ut,initTooltipStyle:mt,overrideTitleTooltip:gt,placeDataLabels:yt,scopeDataKeys:vt,transitionEndAll:bt,validateAccessibilityProps:xt,validateLocalizationProps:ft,setSubTitle:At}=n,Wt=class{constructor(s){t(this,s),this.clickEvent=i(this,"clickEvent",7),this.hoverEvent=i(this,"hoverEvent",7),this.mouseOutEvent=i(this,"mouseOutEvent",7),this.initialLoadEvent=i(this,"initialLoadEvent",7),this.initialLoadEndEvent=i(this,"initialLoadEndEvent",7),this.drawStartEvent=i(this,"drawStartEvent",7),this.drawEndEvent=i(this,"drawEndEvent",7),this.transitionEndEvent=i(this,"transitionEndEvent",7),this.shouldValidateAccessibility=!0,this.shouldValidateLocalization=!0,this.nest=[],this.datakeys=[],this.updated=!0,this.shouldValidate=!1,this.shouldUpdateData=!1,this.shouldSetDimensions=!1,this.shouldUpdateTableData=!1,this.shouldUpdateScales=!1,this.shouldResetRoot=!1,this.shouldSetColors=!1,this.shouldSetSubTitle=!1,this.shouldValidateInteractionKeys=!1,this.shouldFormatClickHighlight=!1,this.shouldFormatHoverHighlight=!1,this.shouldUpdateAnnotations=!1,this.shouldUpdateXAxis=!1,this.shouldUpdateYAxis=!1,this.shouldSetGlobalSelections=!1,this.shouldSetTestingAttributes=!1,this.shouldEnterUpdateExit=!1,this.shouldUpdateGeometries=!1,this.shouldSetSelectionClass=!1,this.shouldDrawInteractionState=!1,this.shouldUpdateLegend=!1,this.shouldUpdateCursor=!1,this.shouldBindInteractivity=!1,this.shouldUpdateLabels=!1,this.shouldSetLabelOpacity=!1,this.shouldSwapXAxis=!1,this.shouldSwapYAxis=!1,this.shouldUpdateDescriptionWrapper=!1,this.shouldSetChartAccessibilityTitle=!1,this.shouldSetChartAccessibilitySubtitle=!1,this.shouldSetChartAccessibilityLongDescription=!1,this.shouldSetChartAccessibilityExecutiveSummary=!1,this.shouldSetChartAccessibilityStatisticalNotes=!1,this.shouldSetChartAccessibilityStructureNotes=!1,this.shouldSetParentSVGAccessibility=!1,this.shouldSetGeometryAccessibilityAttributes=!1,this.shouldSetGeometryAriaLabels=!1,this.shouldSetGroupAccessibilityLabel=!1,this.shouldSetChartAccessibilityPurpose=!1,this.shouldSetChartAccessibilityContext=!1,this.shouldRedrawWrapper=!1,this.shouldSetTagLevels=!1,this.shouldSetChartAccessibilityCount=!1,this.shouldSetYAxisAccessibility=!1,this.shouldSetXAxisAccessibility=!1,this.shouldSetAnnotationAccessibility=!1,this.shouldSetTextures=!1,this.shouldSetStrokes=!1,this.shouldSetLocalizationConfig=!1,this.strokes={},this.topLevel="h2",this.bottomLevel="p",this.textTreatmentHandler=(t,i,s)=>{const h=!this.accessibility.hideTextures&&this.accessibility.showExperimentalTextures?this.fillColors(t.valueAccessor):this.rawHeat(t.valueAccessor),e=Q(h),a=l(s[i]);return a.attr("filter",a.classed("textIsMoving")?null:w({root:this.svg.node(),id:this.chartID,color:h})),e},this.localization=g.localization,this.mainTitle=g.mainTitle,this.subTitle=g.subTitle,this.height=g.height,this.width=g.width,this.highestHeadingLevel=g.highestHeadingLevel,this.margin=g.margin,this.padding=g.padding,this.data=void 0,this.uniqueID=void 0,this.xAccessor=g.xAccessor,this.yAccessor=g.yAccessor,this.valueAccessor=g.valueAccessor,this.xKeyOrder=void 0,this.yKeyOrder=void 0,this.xAxis=g.xAxis,this.yAxis=g.yAxis,this.wrapLabel=g.wrapLabel,this.hideAxisPath=g.hideAxisPath,this.colorPalette=g.colorPalette,this.colors=void 0,this.colorSteps=g.colorSteps,this.hoverStyle=g.hoverStyle,this.clickStyle=g.clickStyle,this.cursor=g.cursor,this.shape=g.shape,this.hoverOpacity=g.hoverOpacity,this.animationConfig=g.animationConfig,this.strokeWidth=g.strokeWidth,this.dataLabel=g.dataLabel,this.dataKeyNames=void 0,this.showTooltip=g.showTooltip,this.tooltipLabel=g.tooltipLabel,this.accessibility=g.accessibility,this.legend=g.legend,this.annotations=g.annotations,this.maxValueOverride=void 0,this.minValueOverride=void 0,this.hoverHighlight=void 0,this.clickHighlight=g.clickHighlight,this.interactionKeys=void 0,this.suppressEvents=g.suppressEvents,this.unitTest=!1}dataWatcher(t,i){this.updated=!0,this.shouldUpdateData=!0,this.shouldSetColors=!0,this.shouldSetGlobalSelections=!0,this.shouldSetTestingAttributes=!0,this.shouldUpdateScales=!0,this.shouldEnterUpdateExit=!0,this.shouldUpdateTableData=!0,this.shouldValidate=!0,this.shouldUpdateGeometries=!0,this.shouldUpdateXAxis=!0,this.shouldUpdateYAxis=!0,this.shouldUpdateLabels=!0,this.shouldUpdateLegend=!0,this.shouldDrawInteractionState=!0,this.shouldUpdateAnnotations=!0,this.shouldSetGeometryAccessibilityAttributes=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldSetXAxisAccessibility=!0,this.shouldSetYAxisAccessibility=!0,this.shouldSetTextures=!0,this.shouldSetStrokes=!0,this.shouldSetLabelOpacity=!0}idWatcher(t,i){console.error("Change detected in prop uniqueID from value "+i+" to value "+t+". This prop cannot be changed after component has loaded.")}headingWatcher(t,i){this.shouldRedrawWrapper=!0,this.shouldSetTagLevels=!0,this.shouldSetChartAccessibilityCount=!0,this.shouldSetYAxisAccessibility=!0,this.shouldSetXAxisAccessibility=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetAnnotationAccessibility=!0,this.shouldSetSubTitle=!0,this.shouldSetChartAccessibilityTitle=!0,this.shouldSetChartAccessibilitySubtitle=!0,this.shouldSetChartAccessibilityLongDescription=!0,this.shouldSetChartAccessibilityContext=!0,this.shouldSetChartAccessibilityExecutiveSummary=!0,this.shouldSetChartAccessibilityPurpose=!0,this.shouldSetChartAccessibilityStatisticalNotes=!0,this.shouldSetChartAccessibilityStructureNotes=!0}titleWatcher(t,i){this.shouldValidate=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetChartAccessibilityTitle=!0,this.shouldSetParentSVGAccessibility=!0}subtitleWatcher(t,i){this.shouldSetSubTitle=!0,this.shouldSetChartAccessibilitySubtitle=!0,this.shouldSetParentSVGAccessibility=!0}layoutWatcher(t,i){this.shouldSetDimensions=!0,this.shouldUpdateScales=!0,this.shouldSetTextures=!0,this.shouldResetRoot=!0,this.shouldUpdateGeometries=!0,this.shouldUpdateXAxis=!0,this.shouldUpdateYAxis=!0,this.shouldUpdateLabels=!0,this.shouldUpdateLegend=!0,this.shouldUpdateAnnotations=!0,this.shouldSetLabelOpacity=!0}xAccessorWatcher(t,i){this.shouldUpdateData=!0,this.shouldSetColors=!0,this.shouldUpdateScales=!0,this.shouldSetGlobalSelections=!0,this.shouldFormatClickHighlight=!0,this.shouldFormatHoverHighlight=!0,this.shouldDrawInteractionState=!0,this.shouldEnterUpdateExit=!0,this.shouldUpdateTableData=!0,this.shouldUpdateGeometries=!0,this.shouldUpdateXAxis=!0,this.shouldUpdateLabels=!0,this.shouldUpdateLegend=!0,this.shouldUpdateAnnotations=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldSetXAxisAccessibility=!0,this.shouldSetTextures=!0,this.shouldSetStrokes=!0,this.shouldSetLabelOpacity=!0}yAccessorWatcher(t,i){this.shouldUpdateData=!0,this.shouldSetColors=!0,this.shouldUpdateScales=!0,this.shouldSetGlobalSelections=!0,this.shouldFormatClickHighlight=!0,this.shouldFormatHoverHighlight=!0,this.shouldDrawInteractionState=!0,this.shouldEnterUpdateExit=!0,this.shouldUpdateTableData=!0,this.shouldUpdateGeometries=!0,this.shouldUpdateYAxis=!0,this.shouldUpdateLabels=!0,this.shouldUpdateLegend=!0,this.shouldUpdateAnnotations=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldSetYAxisAccessibility=!0,this.shouldSetTextures=!0,this.shouldSetStrokes=!0,this.shouldSetLabelOpacity=!0}groupAccessorWatcher(t,i){this.shouldUpdateData=!0,this.shouldUpdateTableData=!0,this.shouldSetColors=!0,this.shouldUpdateScales=!0,this.shouldSetGlobalSelections=!0,this.shouldUpdateGeometries=!0,this.shouldDrawInteractionState=!0,this.shouldUpdateLegend=!0,this.shouldSetLabelOpacity=!0,this.shouldUpdateLabels=!0,this.shouldSetGeometryAriaLabels=!0,this.interactionKeys&&this.interactionKeys.length||(this.shouldValidateInteractionKeys=!0,this.shouldSetSelectionClass=!0),this.shouldSetTextures=!0,this.shouldSetStrokes=!0}xKeyOrderWatcher(t,i){this.shouldUpdateData=!0,this.shouldUpdateScales=!0,this.shouldSetGlobalSelections=!0,this.shouldSetTestingAttributes=!0,this.shouldDrawInteractionState=!0,this.shouldUpdateTableData=!0,this.shouldUpdateGeometries=!0,this.shouldUpdateXAxis=!0,this.shouldUpdateLabels=!0,this.shouldUpdateLegend=!0,this.shouldUpdateAnnotations=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldSetGeometryAccessibilityAttributes=!0,this.shouldSetXAxisAccessibility=!0,this.shouldSetTextures=!0,this.shouldSetStrokes=!0}yKeyOrderWatcher(t,i){this.shouldUpdateData=!0,this.shouldUpdateScales=!0,this.shouldSetGlobalSelections=!0,this.shouldSetTestingAttributes=!0,this.shouldDrawInteractionState=!0,this.shouldUpdateTableData=!0,this.shouldUpdateGeometries=!0,this.shouldUpdateYAxis=!0,this.shouldUpdateLabels=!0,this.shouldUpdateLegend=!0,this.shouldUpdateAnnotations=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldSetGeometryAccessibilityAttributes=!0,this.shouldSetYAxisAccessibility=!0,this.shouldSetTextures=!0,this.shouldSetStrokes=!0}xAxisWatcher(t,i){const s=!(!t||!t.placement)&&t.placement,h=!(!i||!i.placement)&&i.placement;(!(!t||!t.format)&&t.format)!==(!(!i||!i.format)&&i.format)&&(this.shouldUpdateData=!0,this.shouldSetColors=!0,this.shouldUpdateScales=!0,this.shouldSetTextures=!0,this.shouldSetGlobalSelections=!0,this.shouldFormatClickHighlight=!0,this.shouldFormatHoverHighlight=!0,this.shouldDrawInteractionState=!0,this.shouldEnterUpdateExit=!0,this.shouldUpdateTableData=!0,this.shouldUpdateGeometries=!0,this.shouldUpdateLabels=!0,this.shouldUpdateLegend=!0,this.shouldUpdateAnnotations=!0),s!==h&&(this.shouldSwapXAxis=!0),this.shouldUpdateXAxis=!0,this.shouldSetXAxisAccessibility=!0}yAxisWatcher(t,i){const s=!(!t||!t.placement)&&t.placement,h=!(!i||!i.placement)&&i.placement;(!(!t||!t.format)&&t.format)!==(!(!i||!i.format)&&i.format)&&(this.shouldUpdateData=!0,this.shouldSetColors=!0,this.shouldUpdateScales=!0,this.shouldSetTextures=!0,this.shouldSetGlobalSelections=!0,this.shouldFormatClickHighlight=!0,this.shouldFormatHoverHighlight=!0,this.shouldDrawInteractionState=!0,this.shouldEnterUpdateExit=!0,this.shouldUpdateTableData=!0,this.shouldUpdateGeometries=!0,this.shouldUpdateLabels=!0,this.shouldUpdateLegend=!0,this.shouldUpdateAnnotations=!0),s!==h&&(this.shouldSwapYAxis=!0),this.shouldUpdateYAxis=!0,this.shouldSetYAxisAccessibility=!0}wrapLabelWatcher(t,i){this.shouldUpdateXAxis=!0,this.shouldUpdateYAxis=!0}hideAxisPathWatcher(t,i){this.shouldUpdateXAxis=!0,this.shouldUpdateYAxis=!0}colorsWatcher(t,i){this.shouldSetColors=!0,this.shouldUpdateScales=!0,this.shouldUpdateGeometries=!0,this.shouldUpdateLegend=!0,this.shouldDrawInteractionState=!0,this.shouldSetTextures=!0,this.shouldSetStrokes=!0}hoverStyleWatcher(t,i){this.shouldDrawInteractionState=!0,this.shouldSetLabelOpacity=!0,this.shouldSetStrokes=!0}clickStyleWatcher(t,i){this.shouldDrawInteractionState=!0,this.shouldSetLabelOpacity=!0,this.shouldSetStrokes=!0}shapeWatcher(t,i){this.shouldUpdateGeometries=!0}cursorWatcher(t,i){this.shouldUpdateCursor=!0}strokeWidthWatcher(t,i){this.shouldUpdateGeometries=!0,this.shouldUpdateScales=!0,this.shouldSetTextures=!0,this.shouldUpdateGeometries=!0,this.shouldSetStrokes=!0}hoverOpacityWatcher(t,i){this.shouldSetLabelOpacity=!0,this.shouldDrawInteractionState=!0}labelWatcher(t,i){this.shouldUpdateLabels=!0,this.shouldUpdateTableData=!0,(t&&t.visible)!==(i&&i.visible)&&(this.shouldSetLabelOpacity=!0)}showTooltipWatcher(t,i){}tooltipLabelWatcher(t,i){this.shouldUpdateTableData=!0,this.shouldSetParentSVGAccessibility=!0,this.shouldSetGeometryAriaLabels=!0}legendWatcher(t,i){this.shouldUpdateLegend=!0}suppressWatcher(t,i){this.shouldBindInteractivity=!0,this.shouldUpdateCursor=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldSetParentSVGAccessibility=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldRedrawWrapper=!0,this.shouldValidate=!0,this.shouldSetSubTitle=!0,this.shouldSetChartAccessibilityTitle=!0,this.shouldSetChartAccessibilitySubtitle=!0,this.shouldSetChartAccessibilityLongDescription=!0,this.shouldSetChartAccessibilityContext=!0,this.shouldSetChartAccessibilityExecutiveSummary=!0,this.shouldSetChartAccessibilityPurpose=!0,this.shouldSetChartAccessibilityStatisticalNotes=!0,this.shouldSetChartAccessibilityStructureNotes=!0}annotationsWatcher(t,i){this.shouldValidate=!0,this.shouldUpdateAnnotations=!0,this.shouldSetAnnotationAccessibility=!0}accessibilityWatcher(t,i){this.shouldValidate=!0,(!(!t||!t.title)&&t.title)!==(!(!i||!i.title)&&i.title)&&(this.shouldUpdateDescriptionWrapper=!0,this.shouldSetChartAccessibilityTitle=!0,this.shouldSetParentSVGAccessibility=!0),(!(!t||!t.executiveSummary)&&t.executiveSummary)!==(!(!i||!i.executiveSummary)&&i.executiveSummary)&&(this.shouldSetChartAccessibilityExecutiveSummary=!0),(!(!t||!t.purpose)&&t.purpose)!==(!(!i||!i.purpose)&&i.purpose)&&(this.shouldSetChartAccessibilityPurpose=!0),(!(!t||!t.longDescription)&&t.longDescription)!==(!(!i||!i.longDescription)&&i.longDescription)&&(this.shouldSetChartAccessibilityLongDescription=!0),(!(!t||!t.contextExplanation)&&t.contextExplanation)!==(!(!i||!i.contextExplanation)&&i.contextExplanation)&&(this.shouldSetChartAccessibilityContext=!0),(!(!t||!t.statisticalNotes)&&t.statisticalNotes)!==(!(!i||!i.statisticalNotes)&&i.statisticalNotes)&&(this.shouldSetChartAccessibilityStatisticalNotes=!0),(!(!t||!t.structureNotes)&&t.structureNotes)!==(!(!i||!i.structureNotes)&&i.structureNotes)&&(this.shouldSetChartAccessibilityStructureNotes=!0);const s=t&&t.includeDataKeyNames,h=i&&i.includeDataKeyNames;s===h&&(!(!t||!t.elementDescriptionAccessor)&&t.elementDescriptionAccessor)===(!(!i||!i.elementDescriptionAccessor)&&i.elementDescriptionAccessor)||(s!==h&&(this.shouldSetGroupAccessibilityLabel=!0),this.shouldSetGeometryAriaLabels=!0,this.shouldSetParentSVGAccessibility=!0),(!(!t||!t.hideTextures)&&t.hideTextures)===(!(!i||!i.hideTextures)&&i.hideTextures)&&(!(!t||!t.showExperimentalTextures)&&t.showExperimentalTextures)===(!(!i||!i.showExperimentalTextures)&&i.showExperimentalTextures)||(this.shouldSetTextures=!0,this.shouldUpdateLegend=!0,this.shouldSetStrokes=!0,this.shouldDrawInteractionState=!0),(!(!t||!t.showSmallLabels)&&t.showSmallLabels)!==(!(!i||!i.showSmallLabels)&&i.showSmallLabels)&&(this.shouldSetLabelOpacity=!0),(!(!t||!t.hideStrokes)&&t.hideStrokes)!==(!(!i||!i.hideStrokes)&&i.hideStrokes)&&(this.shouldUpdateLegend=!0,this.shouldSetStrokes=!0,this.shouldDrawInteractionState=!0);const e=!(!t||!t.elementsAreInterface)&&t.elementsAreInterface,a=!(!i||!i.elementsAreInterface)&&i.elementsAreInterface;(!!(t&&t.keyboardNavConfig&&t.keyboardNavConfig.disabled)&&t.keyboardNavConfig.disabled)===(!!(i&&i.keyboardNavConfig&&i.keyboardNavConfig.disabled)&&i.keyboardNavConfig.disabled)&&e===a||(this.shouldSetGeometryAriaLabels=!0,this.shouldSetParentSVGAccessibility=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldRedrawWrapper=!0,this.shouldSetChartAccessibilityTitle=!0,this.shouldSetChartAccessibilitySubtitle=!0,this.shouldSetChartAccessibilityLongDescription=!0,this.shouldSetChartAccessibilityContext=!0,this.shouldSetChartAccessibilityExecutiveSummary=!0,this.shouldSetChartAccessibilityPurpose=!0,this.shouldSetChartAccessibilityStatisticalNotes=!0,this.shouldSetChartAccessibilityStructureNotes=!0),e!==a&&(this.shouldSetSelectionClass=!0)}localizationWatcher(t,i){this.shouldValidate=!0,(!(!t||!t.language)&&t.language)!==(!(!i||!i.language)&&i.language)&&(this.shouldSetLocalizationConfig=!0,this.shouldUpdateTableData=!0,this.shouldRedrawWrapper=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetChartAccessibilityCount=!0,this.shouldSetYAxisAccessibility=!0,this.shouldSetXAxisAccessibility=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldSetParentSVGAccessibility=!0),(!(!t||!t.numeralLocale)&&t.numeralLocale)!==(!(!i||!i.numeralLocale)&&i.numeralLocale)&&(this.shouldSetLocalizationConfig=!0,this.shouldUpdateTableData=!0,this.shouldRedrawWrapper=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetChartAccessibilityCount=!0,this.shouldSetYAxisAccessibility=!0,this.shouldSetXAxisAccessibility=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldSetParentSVGAccessibility=!0)}valueOverrideWatcher(t,i){this.shouldUpdateScales=!0,this.shouldUpdateGeometries=!0,this.shouldUpdateLabels=!0,this.shouldUpdateLegend=!0,this.shouldUpdateAnnotations=!0,this.shouldSetTextures=!0}clickWatcher(t,i){this.shouldFormatClickHighlight=!0,this.shouldDrawInteractionState=!0,this.shouldSetLabelOpacity=!0,this.shouldSetSelectionClass=!0}hoverWatcher(t,i){this.shouldFormatHoverHighlight=!0,this.shouldDrawInteractionState=!0,this.shouldSetLabelOpacity=!0}interactionWatcher(t,i){this.shouldValidateInteractionKeys=!0,this.shouldDrawInteractionState=!0,this.shouldSetLabelOpacity=!0,this.shouldSetSelectionClass=!0,this.shouldUpdateTableData=!0,this.shouldSetGeometryAriaLabels=!0}dataKeyNamesWatcher(t,i){this.shouldUpdateXAxis=!0,this.shouldSetXAxisAccessibility=!0,this.shouldUpdateYAxis=!0,this.shouldSetYAxisAccessibility=!0,this.shouldSetParentSVGAccessibility=!0,this.shouldSetGroupAccessibilityLabel=!0,this.shouldSetGeometryAriaLabels=!0}unitTestWatcher(t,i){this.shouldSetTestingAttributes=!0}componentWillLoad(){const t=this.uniqueID||"heat-map-"+p();return this.initialLoadEvent.emit({chartID:t}),new Promise((i=>{this.duration=0,this.defaults=!0,this.chartID=t,this.heatMapEl.id=this.chartID,this.setLocalizationConfig(),this.setTagLevels(),this.prepareData(),this.setDimensions(),this.setColors(),this.prepareScales(),this.validateInteractionKeys(),this.setTableData(),this.shouldValidateAccessibilityProps(),this.shouldValidateLocalizationProps(),this.formatClickHighlight(),this.formatHoverHighlight(),i("component will load")}))}componentWillUpdate(){return new Promise((t=>{t("component will update")}))}componentDidLoad(){return new Promise((t=>{this.renderRootElements(),this.setTooltipInitialStyle(),this.setChartDescriptionWrapper(),this.setChartAccessibilityTitle(),this.setChartAccessibilitySubtitle(),this.setChartAccessibilityLongDescription(),this.setChartAccessibilityExecutiveSummary(),this.setChartAccessibilityPurpose(),this.setChartAccessibilityContext(),this.setChartAccessibilityStatisticalNotes(),this.setChartAccessibilityStructureNotes(),this.setParentSVGAccessibility(),this.reSetRoot(),this.setTextures(),this.setStrokes(),this.setSubTitleElements(),this.setGlobalSelections(),this.setTestingAttributes(),this.enterGeometries(),this.updateGeometries(),this.exitGeometries(),this.enterDataLabels(),this.updateDataLabels(),this.exitDataLabels(),this.drawGeometries(),this.setChartCountAccessibility(),this.setGeometryAccessibilityAttributes(),this.setGeometryAriaLabels(),this.drawDataLabels(),this.drawLegendElements(),this.setSelectedClass(),this.updateInteractionState(),this.bindInteractivity(),this.drawAnnotations(),this.setAnnotationAccessibility(),this.drawXAxis(),this.setXAxisAccessibility(),this.drawYAxis(),this.setYAxisAccessibility(),j(this.root.node(),this.map.node()),this.setGroupAccessibilityID(),this.onChangeHandler(),this.defaults=!1,t("component did load")})).then((()=>this.initialLoadEndEvent.emit({chartID:this.chartID})))}componentDidUpdate(){return new Promise((t=>{this.duration=this.animationConfig&&this.animationConfig.disabled?0:750,this.shouldUpdateDescriptionWrapper&&(this.setChartDescriptionWrapper(),this.shouldUpdateDescriptionWrapper=!1),this.shouldSetChartAccessibilityCount&&(this.setChartCountAccessibility(),this.shouldSetChartAccessibilityCount=!1),this.shouldSetChartAccessibilityTitle&&(this.setChartAccessibilityTitle(),this.shouldSetChartAccessibilityTitle=!1),this.shouldSetChartAccessibilitySubtitle&&(this.setChartAccessibilitySubtitle(),this.shouldSetChartAccessibilitySubtitle=!1),this.shouldSetChartAccessibilityLongDescription&&(this.setChartAccessibilityLongDescription(),this.shouldSetChartAccessibilityLongDescription=!1),this.shouldSetChartAccessibilityExecutiveSummary&&(this.setChartAccessibilityExecutiveSummary(),this.shouldSetChartAccessibilityExecutiveSummary=!1),this.shouldSetChartAccessibilityPurpose&&(this.setChartAccessibilityPurpose(),this.shouldSetChartAccessibilityPurpose=!1),this.shouldSetChartAccessibilityContext&&(this.setChartAccessibilityContext(),this.shouldSetChartAccessibilityContext=!1),this.shouldSetChartAccessibilityStatisticalNotes&&(this.setChartAccessibilityStatisticalNotes(),this.shouldSetChartAccessibilityStatisticalNotes=!1),this.shouldSetChartAccessibilityStructureNotes&&(this.setChartAccessibilityStructureNotes(),this.shouldSetChartAccessibilityStructureNotes=!1),this.shouldSetParentSVGAccessibility&&(this.setParentSVGAccessibility(),this.shouldSetParentSVGAccessibility=!1),this.shouldResetRoot&&(this.reSetRoot(),this.shouldResetRoot=!1),this.shouldSetTextures&&(this.setTextures(),this.shouldSetTextures=!1),this.shouldSetStrokes&&(this.setStrokes(),this.shouldSetStrokes=!1),this.shouldSetGlobalSelections&&(this.setGlobalSelections(),this.shouldSetGlobalSelections=!1),this.shouldSetTestingAttributes&&(this.setTestingAttributes(),this.shouldSetTestingAttributes=!1),this.shouldSetSubTitle&&(this.setSubTitleElements(),this.shouldSetSubTitle=!1),this.shouldEnterUpdateExit&&(this.enterGeometries(),this.updateGeometries(),this.exitGeometries(),this.enterDataLabels(),this.updateDataLabels(),this.exitDataLabels(),this.shouldEnterUpdateExit=!1),this.shouldUpdateGeometries&&(this.drawGeometries(),this.shouldUpdateGeometries=!1),this.shouldSetGeometryAccessibilityAttributes&&(this.setGeometryAccessibilityAttributes(),this.shouldSetGeometryAccessibilityAttributes=!1),this.shouldSetGeometryAriaLabels&&(this.setGeometryAriaLabels(),this.shouldSetGeometryAriaLabels=!1),this.shouldSetGroupAccessibilityLabel&&(this.setGroupAccessibilityID(),this.shouldSetGroupAccessibilityLabel=!1),this.shouldUpdateLegend&&(this.drawLegendElements(),this.shouldUpdateLegend=!1),this.shouldUpdateLabels&&(this.drawDataLabels(),this.shouldUpdateLabels=!1),this.shouldDrawInteractionState&&(this.updateInteractionState(),this.shouldDrawInteractionState=!1),this.shouldSetLabelOpacity&&(this.setLabelOpacity(),this.shouldSetLabelOpacity=!1),this.shouldSetSelectionClass&&(this.setSelectedClass(),this.shouldSetSelectionClass=!1),this.shouldUpdateCursor&&(this.updateCursor(),this.shouldUpdateCursor=!1),this.shouldBindInteractivity&&(this.bindInteractivity(),this.shouldBindInteractivity=!1),this.shouldUpdateAnnotations&&(this.drawAnnotations(),this.shouldUpdateAnnotations=!1),this.shouldSetAnnotationAccessibility&&(this.setAnnotationAccessibility(),this.shouldSetAnnotationAccessibility=!1),this.shouldSwapXAxis&&(this.drawXAxis(!0),this.shouldSwapXAxis=!1),this.shouldSwapYAxis&&(this.drawYAxis(!0),this.shouldSwapYAxis=!1),this.shouldUpdateXAxis&&(this.drawXAxis(),this.shouldUpdateXAxis=!1),this.shouldSetXAxisAccessibility&&(this.setXAxisAccessibility(),this.shouldSetXAxisAccessibility=!1),this.shouldUpdateYAxis&&(this.drawYAxis(),this.shouldUpdateYAxis=!1),this.shouldSetYAxisAccessibility&&(this.setYAxisAccessibility(),this.shouldSetYAxisAccessibility=!1),this.onChangeHandler(),t("component did update")})).then((()=>this.drawEndEvent.emit({chartID:this.chartID})))}shouldValidateLocalizationProps(){const t=y(),i=t.i18Next.getResourceBundle(t.i18Next.language),s=t.numeral.localeData();this.shouldValidateLocalization&&!this.localization.skipValidation&&(this.shouldValidateLocalization=!1,ft(this.chartID,Object.assign(Object.assign({},this.localization),{language:i,numeralLocale:s})))}shouldValidateAccessibilityProps(){this.shouldValidateAccessibility&&!this.accessibility.disableValidation&&(this.shouldValidateAccessibility=!1,xt(this.chartID,Object.assign({},this.accessibility),{annotations:this.annotations,data:this.data,uniqueID:this.uniqueID,context:{mainTitle:this.mainTitle,onClickEvent:this.suppressEvents?void 0:this.clickEvent.emit}}))}formatClickHighlight(){this.clickHighlight&&this.clickHighlight.map((t=>{t.xAccessor&&t.yAccessor||(t.xAccessor=t[this.xAccessor]instanceof Date?nt({date:t[this.xAccessor],format:this.xAxis.format,offsetTimezone:!0}):t[this.xAccessor],t.yAccessor=t[this.yAccessor]instanceof Date?nt({date:t[this.yAccessor],format:this.yAxis.format,offsetTimezone:!0}):t[this.yAccessor])}))}formatHoverHighlight(){this.hoverHighlight&&(this.hoverHighlight.xAccessor&&this.hoverHighlight.yAccessor||(this.hoverHighlight.xAccessor=this.hoverHighlight[this.xAccessor]instanceof Date?nt({date:this.hoverHighlight[this.xAccessor],format:this.xAxis.format,offsetTimezone:!0}):this.hoverHighlight[this.xAccessor],this.hoverHighlight.yAccessor=this.hoverHighlight[this.yAccessor]instanceof Date?nt({date:this.hoverHighlight[this.yAccessor],format:this.yAxis.format,offsetTimezone:!0}):this.hoverHighlight[this.yAccessor]))}getLanguageString(){return b(this.localization)}setLocalizationConfig(){v(this.localization)}setDimensions(){this.padding="string"==typeof this.padding?pt(this.padding):this.padding,this.innerHeight=this.height-this.margin.top-this.margin.bottom,this.innerWidth=this.width-this.margin.left-this.margin.right,this.innerPaddedHeight=this.innerHeight-this.padding.top-this.padding.bottom,this.innerPaddedWidth=this.innerWidth-this.padding.left-this.padding.right}validateInteractionKeys(){if(this.interactionKeys&&this.interactionKeys.length){if(this.interactionKeys.includes(this.xAccessor)||this.interactionKeys.includes(this.yAccessor)){const t=[];this.interactionKeys.map((i=>{t.push(i===this.xAccessor?"xAccessor":i===this.yAccessor?"yAccessor":i)})),this.innerInteractionKeys=t}}else this.innerInteractionKeys=["xAccessor","yAccessor"]}prepareScales(){const t=(this.minValueOverride||0===this.minValueOverride)&&this.minValueOverride<a(this.preppedData,(t=>t.valueAccessor))?this.minValueOverride:a(this.preppedData,(t=>t.valueAccessor)),i=(this.maxValueOverride||0===this.maxValueOverride)&&this.maxValueOverride>e(this.preppedData,(t=>t.valueAccessor))?this.maxValueOverride:e(this.preppedData,(t=>t.valueAccessor));this.x=o().domain(this.xKeyOrder?this.xKeyOrder:this.preppedData.map((t=>t.xAccessor))).range([0,this.innerPaddedWidth]),this.x.padding(this.strokeWidth?this.strokeWidth/this.x.bandwidth():0),this.y=o().domain(this.yKeyOrder?this.yKeyOrder:this.preppedData.map((t=>t.yAccessor))).range([0,this.innerPaddedHeight]),this.y.padding(this.strokeWidth?this.strokeWidth/this.y.bandwidth():0),this.heat=c().domain([t,i]);const s=[],h=[];let r=0;const n=Math.ceil(this.preparedColors.length/2),l=this.colorPalette&&this.colorPalette.includes("diverging"),d=this.colorPalette&&this.colorPalette.includes("dark");this.preparedColors.forEach((t=>{const i=f(t,r,this.preparedColors,l?"diverging":"sequential");if(l){const t=x(i.fillColor),e=x(i.textureColor),a=t>e?i.textureColor:i.fillColor,o=t<e?i.textureColor:i.fillColor;this.preparedColors.length%2&&r===(this.preparedColors.length-1)/2?(h.push(d?a:o),s.push(d?o:a)):(s.push(d?a:o),h.push(d?o:a))}else r+1<n?(h.push(this.preparedColors[0]),s.push(this.preparedColors[this.preparedColors.length-1])):(s.push(this.preparedColors[0]),h.push(this.preparedColors[this.preparedColors.length-1]));r++})),this.fillColors=c().domain([t,i]).range(h),this.strokeColors=c().domain([t,i]).range(s),this.rawHeat=c().domain([t,i]).range(this.preparedColors),this.updateCheck=!0}setSubTitleElements(){At({root:this.subTitleG,subTitle:this.subTitle})}setColors(){this.preparedColors=this.colors?et(this.colors):lt(this.colorPalette,this.colorSteps)}setTextures(){const t=this.colorPalette&&this.colorPalette.includes("diverging")?"diverging":"sequential";if(this.accessibility.hideTextures||this.colorSteps>("diverging"===t?11:9)||!this.accessibility.showExperimentalTextures)this.colorArr=this.preparedColors;else{const i=D({colors:this.preparedColors,rootSVG:this.svg.node(),id:this.chartID,scheme:t,disableTransitions:!this.duration});this.colorArr=i}this.heat.range(this.colorArr)}setStrokes(){const t=Object.assign(Object.assign({},this.clickStyle),{color:void 0}),i=Object.assign(Object.assign({},this.hoverStyle),{color:void 0});this.strokes=k({root:this.svg.node(),id:this.chartID,colors:!this.accessibility.hideTextures&&this.accessibility.showExperimentalTextures?this.fillColors.range():this.preparedColors,clickStyle:t,hoverStyle:i,strokeOverride:!this.accessibility.hideTextures&&this.accessibility.showExperimentalTextures?this.strokeColors.range():void 0})}setTableData(){const t=vt(this,tt,"heat-map");this.tableData=ut(this.data,t),this.tableColumns=Object.keys(t)}prepareData(){if(this.updateCheck){this.interpolating=this.preppedData;const t=this.x.domain(),i=this.x.range(),s=this.y.domain(),h=this.y.range();this.interpolating.x=o().domain(t).range(i),this.interpolating.y=o().domain(s).range(h)}this.preppedData=this.data.map((t=>{const i=Object.assign({},t);return i.valueAccessor=parseFloat(t[this.valueAccessor]),i.xAccessor=t[this.xAccessor]instanceof Date?nt({date:t[this.xAccessor],format:this.xAxis.format,offsetTimezone:!0}):t[this.xAccessor],i.yAccessor=t[this.yAccessor]instanceof Date?nt({date:t[this.yAccessor],format:this.yAxis.format,offsetTimezone:!0}):t[this.yAccessor],i})),this.nest=r().key((t=>t[this.yAccessor])).entries(this.preppedData),this.datakeys=this.nest.map((t=>t.key))}reSetRoot(){C({selection:this.svg,duration:this.duration,namespace:"root_reset",easing:u}).attr("width",this.width).attr("height",this.height).attr("viewBox","0 0 "+this.width+" "+this.height),C({selection:this.root,duration:this.duration,namespace:"root_reset",easing:u}).attr("transform",`translate(${this.margin.left}, ${this.margin.top})`),C({selection:this.rootG,duration:this.duration,namespace:"root_reset",easing:u}).attr("transform",`translate(${this.padding.left}, ${this.padding.top})`),J(this.chartID,this.width)}drawXAxis(t){const i=this.xAxis.label||""===this.xAxis.label?this.xAxis.label:this.dataKeyNames&&this.dataKeyNames[this.xAccessor]?this.dataKeyNames[this.xAccessor]:this.xAxis.label;at({root:this.rootG,height:this.innerPaddedHeight,width:this.innerPaddedWidth,axisScale:this.x,top:"top"===this.xAxis.placement,wrapLabel:this.wrapLabel?this.x.bandwidth():"",format:this.xAxis.format,tickInterval:this.xAxis.tickInterval,label:i,padding:this.padding,hide:t||!this.xAxis.visible,duration:this.duration,hidePath:this.hideAxisPath})}drawYAxis(t){at({root:this.rootG,height:this.innerPaddedHeight,width:this.innerPaddedWidth,axisScale:this.y,left:"right"!==this.yAxis.placement,right:"right"===this.yAxis.placement,format:this.yAxis.format,wrapLabel:this.wrapLabel?this.padding.left||100:"",tickInterval:this.yAxis.tickInterval,label:this.yAxis.label&&""!==this.yAxis.label?this.yAxis.label:this.dataKeyNames&&this.dataKeyNames[this.yAccessor]?this.dataKeyNames[this.yAccessor]:this.yAxis.label,padding:this.padding,hide:t||!this.yAxis.visible,duration:this.duration,hidePath:this.hideAxisPath})}setXAxisAccessibility(){F({rootEle:this.heatMapEl,hasXAxis:!!this.xAxis&&this.xAxis.visible,xAxis:this.x||!1,xAxisLabel:(this.xAxis.label||""===this.xAxis.label?this.xAxis.label:this.dataKeyNames&&this.dataKeyNames[this.xAccessor]?this.dataKeyNames[this.xAccessor]:this.xAxis.label)||""})}setYAxisAccessibility(){R({rootEle:this.heatMapEl,hasYAxis:!!this.yAxis&&this.yAxis.visible,yAxis:this.y||!1,yAxisLabel:(this.yAxis.label&&""!==this.yAxis.label?this.yAxis.label:this.dataKeyNames&&this.dataKeyNames[this.yAccessor]?this.dataKeyNames[this.yAccessor]:this.yAxis.label)||""})}renderRootElements(){this.svg=l(this.heatMapEl).select(".visa-viz-d3-heat-map-container").append("svg").attr("width",this.width).attr("height",this.height).attr("viewBox","0 0 "+this.width+" "+this.height),this.root=this.svg.append("g").attr("id","visa-viz-margin-container-g-"+this.chartID),this.rootG=this.root.append("g").attr("id","visa-viz-padding-container-g-"+this.chartID),this.map=this.rootG.append("g").attr("class","map-group"),this.labelG=this.rootG.append("g").attr("class","heat-map-dataLabel-group"),this.legendG=l(this.heatMapEl).select(".heat-map-legend").append("svg"),this.subTitleG=l(this.heatMapEl).select(".heat-sub-title"),this.tooltipG=l(this.heatMapEl).select(".heat-map-tooltip")}setGlobalSelections(){this.xAxisElement=this.rootG.selectAll(".bottom");const t=this.map.selectAll(".row").data(this.nest,(t=>t.key));this.enterRowWrappers=t.enter().append("g"),this.exitRowWrappers=t.exit(),this.updateRowWrappers=t.merge(this.enterRowWrappers);const i=this.updateRowWrappers.selectAll(".grid").data((t=>t.values),(t=>t.xAccessor+t.yAccessor));this.enter=i.enter().append("rect"),this.exit=i.exit(),this.update=i.merge(this.enter),this.exitSize=this.exit.size(),this.enterSize=this.enter.size(),this.exitSize+=this.exitRowWrappers.selectAll(".grid").size();const s=this.labelG.selectAll("g").data(this.nest,(t=>t.key));this.enteringLabelGroups=s.enter().append("g"),this.exitingLabelGroups=s.exit(),this.updatingLabelGroups=s.merge(this.enteringLabelGroups);const h=this.updatingLabelGroups.selectAll("text").data((t=>t.values),(t=>t.xAccessor+t.yAccessor));this.enterLabels=h.enter().append("text"),this.exitLabels=h.exit(),this.updateLabels=h.merge(this.enterLabels)}setTestingAttributes(){this.unitTest?(l(this.heatMapEl).select(".visa-viz-d3-heat-map-container").attr("data-testid","chart-container"),l(this.heatMapEl).select(".heat-main-title").attr("data-testid","main-title"),l(this.heatMapEl).select(".heat-sub-title").attr("data-testid","sub-title"),this.svg.attr("data-testid","root-svg"),this.root.attr("data-testid","margin-container"),this.rootG.attr("data-testid","padding-container"),this.legendG.attr("data-testid","legend-container"),this.tooltipG.attr("data-testid","tooltip-container"),this.map.attr("data-testid","map-group"),this.labelG.attr("data-testid","dataLabel-group"),this.svg.select("defs").attr("data-testid","pattern-defs"),this.updateRowWrappers.attr("data-testid","map-row").attr("data-id",(t=>`row-${t.key}`)),this.updateLabels.attr("data-testid","dataLabel").attr("data-id",(t=>`label-${t[this.xAccessor]}-${t[this.yAccessor]}`)),this.update.attr("data-testid","marker").attr("data-id",(t=>`marker-${t[this.xAccessor]}-${t[this.yAccessor]}`))):(l(this.heatMapEl).select(".visa-viz-d3-heat-map-container").attr("data-testid",null),l(this.heatMapEl).select(".heat-main-title").attr("data-testid",null),l(this.heatMapEl).select(".heat-sub-title").attr("data-testid",null),this.svg.attr("data-testid",null),this.root.attr("data-testid",null),this.rootG.attr("data-testid",null),this.legendG.attr("data-testid",null),this.tooltipG.attr("data-testid",null),this.map.attr("data-testid",null),this.labelG.attr("data-testid",null),this.svg.select("defs").attr("data-testid",null),this.updateRowWrappers.attr("data-testid",null).attr("data-id",null),this.updateLabels.attr("data-testid",null).attr("data-id",null),this.update.attr("data-testid",null).attr("data-id",null))}enterGeometries(){this.enter.interrupt(),this.enterRowWrappers.attr("class","row").classed("entering",!0).each(((t,i,s)=>{E(s[i])})),this.enter.attr("class","grid").attr("cursor",this.suppressEvents?null:this.cursor).each(((t,i,s)=>{E(s[i])})).on("click",this.suppressEvents?null:(t,i,s)=>{this.onClickHandler(t,s[i])}).on("mouseover",this.suppressEvents?null:(t,i,s)=>{this.onHoverHandler(t,s[i])}).on("mouseout",this.suppressEvents?null:()=>this.onMouseOutHandler()).attr("opacity",0).attr("y",(t=>{if(this.interpolating&&void 0===this.interpolating.y(t.yAccessor)){let i=this.y(t.yAccessor);return i+=this.y.bandwidth()*(i/this.y(this.y.domain()[0])),i}return this.interpolating?this.interpolating.y(t.yAccessor):this.y(t.yAccessor)})).attr("height",(t=>this.interpolating&&void 0===this.interpolating.y(t.yAccessor)?0:this.interpolating?this.interpolating.y.bandwidth():this.y.bandwidth())).attr("x",(t=>{if(this.interpolating&&void 0===this.interpolating.x(t.xAccessor)){let i=this.x(t.xAccessor);return i+=this.x.bandwidth()*(i/this.x(this.x.domain()[this.x.domain().length-1])),i}return this.interpolating?this.interpolating.x(t.xAccessor):this.x(t.xAccessor)})).attr("width",(t=>this.interpolating&&void 0===this.interpolating.x(t.xAccessor)?0:this.interpolating?this.interpolating.x.bandwidth():this.x.bandwidth())).attr("rx","circle"===this.shape?this.x.bandwidth():0).attr("ry","circle"===this.shape?this.y.bandwidth():0),this.update.order(),this.enterRowWrappers.order()}updateGeometries(){this.update.interrupt(),this.update.transition("opacity").duration(((t,i,s)=>l(s[i]).classed("entering")?(l(s[i]).classed("entering",!1),this.duration):0)).ease(u).attr("opacity",(t=>it(t,1,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)))}exitGeometries(){this.exit.interrupt(),this.exit.transition("exit").duration(this.duration).ease(u).attr("opacity",0).attr("y",((t,i,s)=>{if(void 0===this.y(t.yAccessor)){const t=l(s[i]);let h=+t.attr("y");return h+=+t.attr("height")*(h/this.y(this.y.domain()[0])),h}return this.y(t.yAccessor)})).attr("height",(t=>void 0===this.y(t.yAccessor)?0:this.y.bandwidth())).attr("x",((t,i,s)=>{if(void 0===this.x(t.xAccessor)){const t=l(s[i]);let h=+t.attr("x");return h+=+t.attr("width")*(h/this.x(this.x.domain()[this.x.domain().length-1])),h}return this.x(t.xAccessor)})).attr("width",(t=>void 0===this.x(t.xAccessor)?0:this.x.bandwidth())),this.exitRowWrappers.selectAll(".grid").transition("exit").duration(this.duration).ease(u).attr("opacity",0).attr("y",((t,i,s)=>{const h=l(s[i]);let e=+h.attr("y");return e+=+h.attr("height")*(e/this.y(this.y.domain()[0])),e})).attr("height",0).attr("x",((t,i,s)=>{if(void 0===this.x(t.xAccessor)){const t=l(s[i]);let h=+t.attr("x");return h+=+t.attr("width")*(h/this.x(this.x.domain()[this.x.domain().length-1])),h}return this.x(t.xAccessor)})).attr("width",(t=>void 0===this.x(t.xAccessor)?0:this.x.bandwidth())),this.update.transition("accessibilityAfterExit").duration(this.duration).ease(u).call(bt,(()=>{const t=B(this.rootG.node());this.exit.remove(),this.exitRowWrappers.remove(),this.setChartCountAccessibility(),this.setGroupAccessibilityID(),this.setGeometryAriaLabels(),_({parentGNode:this.rootG.node(),focusDidExist:t})}))}drawGeometries(){this.updateRowWrappers.transition("update").duration(this.duration).ease(u).call(bt,(()=>{this.updateRowWrappers.classed("entering",!1)}));const t=this.update.classed("geometryIsMoving",((t,i,s)=>W(l(s[i]),[{attr:"y",numeric:!0,newValue:this.y(t.yAccessor)},{attr:"height",numeric:!0,newValue:this.y.bandwidth()},{attr:"x",numeric:!0,newValue:this.x(t.xAccessor)},{attr:"width",numeric:!0,newValue:this.x.bandwidth()},{attr:"rx",numeric:!0,newValue:"circle"===this.shape?this.x.bandwidth():0},{attr:"ry",numeric:!0,newValue:"circle"===this.shape?this.y.bandwidth():0}]))).transition("update").duration(this.duration).ease(u).attr("y",(t=>this.y(t.yAccessor))).attr("height",this.y.bandwidth()).attr("x",(t=>this.x(t.xAccessor))).attr("width",this.x.bandwidth()).attr("rx","circle"===this.shape?this.x.bandwidth():0).attr("ry","circle"===this.shape?this.y.bandwidth():0);!this.accessibility.hideTextures&&this.accessibility.showExperimentalTextures||t.attr("fill",(t=>this.heat(t[this.valueAccessor]))),t.call(bt,(()=>{this.update.classed("geometryIsMoving",!1),this.updateInteractionState(),_({parentGNode:this.rootG.node()}),this.transitionEndEvent.emit({chartID:this.chartID})}))}updateInteractionState(){S(this.svg.node()),this.update.attr("fill",(t=>this.heat(t[this.valueAccessor]))).attr("opacity",(t=>it(t,1,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys))).attr("filter",((t,i,s)=>{if(!this.accessibility.hideStrokes&&!l(s[i]).classed("geometryIsMoving")){const h=this.clickHighlight&&this.clickHighlight.length>0&&st(t,this.clickHighlight,this.innerInteractionKeys),e=this.hoverHighlight&&ht(t,this.hoverHighlight,this.innerInteractionKeys),a=!this.accessibility.hideTextures&&this.accessibility.showExperimentalTextures?this.fillColors(t[this.valueAccessor]):this.rawHeat(t[this.valueAccessor]),o=!this.accessibility.hideTextures&&this.accessibility.showExperimentalTextures?this.strokeColors(t[this.valueAccessor]):void 0,r=h?"click":e&&!l(s[i]).classed("geometryIsMoving")?"hover":"rest";return"hover"===r&&T({inputElement:s[i],id:this.chartID,key:t[this.xAccessor]+t[this.yAccessor],strokeWidth:this.hoverStyle.strokeWidth,fill:a,strokeOverride:o}),this.strokes[r+a]}return null})),_({parentGNode:this.rootG.node()}),this.updateLabels.attr("fill",this.textTreatmentHandler)}setLabelOpacity(){this.processLabelOpacity(this.updateLabels)}processLabelOpacity(t,i){const s=this.dataLabel.visible?1:0,h={width:this.x.bandwidth(),height:this.y.bandwidth()},e=t=>{let i=this.dataLabel.labelAccessor?t[this.dataLabel.labelAccessor]:t.valueAccessor;return i=i instanceof Date?nt({date:i,format:this.dataLabel.format,offsetTimezone:!0}):ct(i,this.dataLabel.format),this.accessibility.showSmallLabels||A({text:i,dimensions:h,fontSize:14})?it(t,s,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)<1?0:1:0};i?t.attr("opacity",e):t.each(((t,i,s)=>{l(s[i]).classed("entering")||l(s[i]).attr("opacity",(()=>e(t)))}))}setSelectedClass(){this.update.classed("highlight",((t,i,s)=>{let h=it(t,!0,!1,"",this.clickHighlight,this.innerInteractionKeys);return h=!(!this.clickHighlight||!this.clickHighlight.length)&&h,U(s[i],h,this.accessibility.elementsAreInterface),h}))}updateCursor(){this.update.attr("cursor",this.suppressEvents?null:this.cursor),this.updateLabels.attr("cursor",this.suppressEvents?null:this.cursor)}bindInteractivity(){this.update.on("click",this.suppressEvents?null:(t,i,s)=>{this.onClickHandler(t,s[i])}).on("mouseover",this.suppressEvents?null:(t,i,s)=>{this.onHoverHandler(t,s[i])}).on("mouseout",this.suppressEvents?null:()=>this.onMouseOutHandler()),this.updateLabels.on("click",this.suppressEvents?null:(t,i,s)=>this.onClickHandler(t,s[i])).on("mouseover",this.suppressEvents?null:(t,i,s)=>this.onHoverHandler(t,s[i])).on("mouseout",this.suppressEvents?null:()=>this.onMouseOutHandler())}enterDataLabels(){this.enteringLabelGroups.attr("class","heat-map-label-wrapper"),this.enterLabels.attr("class","heat-map-dataLabel entering").attr("opacity",0).attr("fill",this.textTreatmentHandler).attr("cursor",this.suppressEvents?null:this.cursor).on("click",this.suppressEvents?null:(t,i,s)=>this.onClickHandler(t,s[i])).on("mouseover",this.suppressEvents?null:(t,i,s)=>this.onHoverHandler(t,s[i])).on("mouseout",this.suppressEvents?null:()=>this.onMouseOutHandler()),yt({root:this.enterLabels,xScale:this.x,yScale:this.y,ordinalAccessor:"xAccessor",valueAccessor:"yAccessor",chartType:"heat-map"})}updateDataLabels(){const t=this.updateLabels.transition("opacity").ease(u).duration(((t,i,s)=>l(s[i]).classed("entering")?this.duration/2:0)).delay(((t,i,s)=>l(s[i]).classed("entering")?this.duration/2:0));this.processLabelOpacity(t,!0),t.call(bt,(()=>{this.updateLabels.classed("entering",!1)}))}exitDataLabels(){this.exitLabels.transition("exit").ease(u).duration(this.duration/2).attr("opacity",0).remove(),this.exitingLabelGroups.selectAll("text").transition("exit").ease(u).duration(this.duration/2).attr("opacity",0).call(bt,(()=>{this.exitingLabelGroups.remove()}))}drawDataLabels(){this.updateLabels.attr("fill",this.textTreatmentHandler).text((t=>{const i=this.dataLabel.labelAccessor?t[this.dataLabel.labelAccessor]:t.valueAccessor;return i instanceof Date?nt({date:i,format:this.dataLabel.format,offsetTimezone:!0}):ct(i,this.dataLabel.format)}));const t=this.updateLabels.transition("update").ease(u).duration(this.duration);yt({root:t,xScale:this.x,yScale:this.y,ordinalAccessor:"xAccessor",valueAccessor:"yAccessor",chartType:"heat-map"})}drawLegendElements(){ot({root:this.legendG,uniqueID:this.chartID,width:this.innerPaddedWidth,height:this.margin.bottom+60,colorArr:this.legend&&"gradient"!==this.legend.type?this.colorArr:this.preparedColors,baseColorArr:this.colorPalette&&this.colorPalette.includes("diverging")?this.strokeColors.range():[this.preparedColors[this.preparedColors.length-1]],hideStrokes:this.accessibility.hideStrokes,scale:this.heat,steps:this.colorSteps,margin:this.margin,padding:this.padding,duration:this.duration,type:this.legend.type,fontSize:12,label:this.legend.labels,format:this.legend.format,hide:!this.legend.visible})}drawAnnotations(){Z({source:this.rootG.node(),data:this.annotations,xScale:this.x,xAccessor:this.xAccessor,yScale:this.y,yAccessor:this.yAccessor})}setAnnotationAccessibility(){Y(this.getLanguageString(),this.heatMapEl,this.annotations)}setTagLevels(){this.topLevel=L(this.highestHeadingLevel),this.bottomLevel=L(this.highestHeadingLevel,3)}setChartDescriptionWrapper(){I({language:this.getLanguageString(),rootEle:this.heatMapEl,title:this.accessibility.title||this.mainTitle,chartTag:"heat-map",uniqueID:this.chartID,highestHeadingLevel:this.highestHeadingLevel,redraw:this.shouldRedrawWrapper,disableKeyNav:this.suppressEvents&&!1===this.accessibility.elementsAreInterface&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled,hideDataTable:this.accessibility.hideDataTableButton}),this.shouldRedrawWrapper=!1}setParentSVGAccessibility(){N({chartTag:"heat-map",language:this.getLanguageString(),node:this.svg.node(),title:this.accessibility.title||this.mainTitle,description:this.subTitle,uniqueID:this.chartID,geomType:"cell",includeKeyNames:this.accessibility.includeDataKeyNames,dataKeys:vt(this,tt,"heat-map"),dataKeyNames:this.dataKeyNames,groupAccessor:this.yAccessor,groupName:"row",disableKeyNav:this.suppressEvents&&!1===this.accessibility.elementsAreInterface&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled})}setGeometryAccessibilityAttributes(){this.update.each(((t,i,s)=>{E(s[i])}))}setGeometryAriaLabels(){const t=vt(this,tt,"heat-map");this.update.each(((i,s,h)=>{O({chartTag:"heat-map",language:this.getLanguageString(),node:h[s],geomType:"cell",includeKeyNames:this.accessibility.includeDataKeyNames,dataKeys:t,dataKeyNames:this.dataKeyNames,groupName:"row",uniqueID:this.chartID,disableKeyNav:this.suppressEvents&&!1===this.accessibility.elementsAreInterface&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled}),z({node:h[s],uniqueID:this.chartID})}))}setGroupAccessibilityID(){this.updateRowWrappers.each(((t,i,s)=>{z({node:s[i],uniqueID:this.chartID})}))}setChartAccessibilityTitle(){K(this.getLanguageString(),this.heatMapEl,this.accessibility.title||this.mainTitle)}setChartAccessibilitySubtitle(){H(this.getLanguageString(),this.heatMapEl,this.subTitle)}setChartAccessibilityLongDescription(){P(this.getLanguageString(),this.heatMapEl,this.accessibility.longDescription)}setChartAccessibilityExecutiveSummary(){G(this.getLanguageString(),this.heatMapEl,this.accessibility.executiveSummary)}setChartAccessibilityPurpose(){q(this.getLanguageString(),this.heatMapEl,this.accessibility.purpose)}setChartAccessibilityContext(){V(this.getLanguageString(),this.heatMapEl,this.accessibility.contextExplanation)}setChartAccessibilityStatisticalNotes(){M(this.getLanguageString(),this.heatMapEl,this.accessibility.statisticalNotes)}setChartCountAccessibility(){$({rootEle:this.heatMapEl,parentGNode:this.map.node(),chartTag:"heat-map",geomType:"cell",groupName:"row"})}setChartAccessibilityStructureNotes(){X(this.getLanguageString(),this.heatMapEl,this.accessibility.structureNotes)}onChangeHandler(){this.accessibility&&"function"==typeof this.accessibility.onChangeFunc&&this.accessibility.onChangeFunc({updated:this.updated,added:this.enterSize,removed:this.exitSize}),this.updated=!1,this.enterSize=0,this.exitSize=0}onClickHandler(t,i){this.clickEvent.emit({data:t,target:i})}onHoverHandler(t,i){gt(this.chartID,!0),this.hoverEvent.emit({data:t,target:i}),this.showTooltip&&this.eventsTooltip({data:t,evt:d,isToShow:!0})}onMouseOutHandler(){gt(this.chartID,!1),this.mouseOutEvent.emit(),this.showTooltip&&this.eventsTooltip({isToShow:!1})}setTooltipInitialStyle(){mt(this.tooltipG)}eventsTooltip({data:t,evt:i,isToShow:s}){rt({root:this.tooltipG,data:t,event:i,isToShow:s,tooltipLabel:this.tooltipLabel,xAxis:this.xAxis,yAxis:this.yAxis,dataLabel:this.dataLabel,dataKeyNames:this.dataKeyNames,valueAccessor:this.valueAccessor,xAccessor:this.xAccessor,yAccessor:this.yAccessor,chartType:"heat-map"})}render(){return this.drawStartEvent.emit({chartID:this.chartID}),this.init(),this.shouldSetLocalizationConfig&&(this.setLocalizationConfig(),this.shouldSetLocalizationConfig=!1),this.shouldSetTagLevels&&(this.setTagLevels(),this.shouldSetTagLevels=!1),this.shouldUpdateData&&(this.prepareData(),this.shouldUpdateData=!1),this.shouldSetDimensions&&(this.setDimensions(),this.shouldSetDimensions=!1),this.shouldSetColors&&(this.setColors(),this.shouldSetColors=!1),this.shouldUpdateScales&&(this.prepareScales(),this.shouldUpdateScales=!1),this.shouldFormatClickHighlight&&(this.formatClickHighlight(),this.shouldFormatClickHighlight=!1),this.shouldFormatHoverHighlight&&(this.formatHoverHighlight(),this.shouldFormatHoverHighlight=!1),this.shouldValidateInteractionKeys&&(this.validateInteractionKeys(),this.shouldValidateInteractionKeys=!1),this.shouldUpdateTableData&&(this.setTableData(),this.shouldUpdateTableData=!1),this.shouldValidate&&(this.shouldValidateAccessibilityProps(),this.shouldValidateLocalizationProps(),this.shouldValidate=!1),s("div",{class:"o-layout"},s("div",{class:"o-layout--chart"},s(this.topLevel,{class:"heat-main-title vcl-main-title"},this.mainTitle),s(this.bottomLevel,{class:"visa-ui-text--instructions heat-sub-title vcl-sub-title"}),s("div",{class:"heat-map-legend vcl-legend",style:{display:this.legend.visible?"block":"none"}}),s("keyboard-instructions",{uniqueID:this.chartID,geomType:"cell",groupName:"row",language:this.getLanguageString(),chartTag:"heat-map",width:this.width-(this.margin&&this.margin.right||0),isInteractive:this.accessibility.elementsAreInterface,hasCousinNavigation:!0,disabled:this.suppressEvents&&!1===this.accessibility.elementsAreInterface&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled}),s("div",{class:"visa-viz-d3-heat-map-container"}),s("div",{class:"heat-map-tooltip vcl-tooltip",style:{display:this.showTooltip?"block":"none"}}),s("data-table",{uniqueID:this.chartID,isCompact:!0,language:this.getLanguageString(),tableColumns:this.tableColumns,data:this.tableData,dataKeyNames:this.dataKeyNames,padding:this.padding,margin:this.margin,hideDataTable:this.accessibility.hideDataTableButton,unitTest:this.unitTest})))}init(){const t=Object.keys(g);let i=0;const s={strokeWidth:{exception:0},showTooltip:{exception:!1},mainTitle:{exception:""},subTitle:{exception:""},wrapLabel:{exception:!1},hoverOpacity:{exception:0}};for(i=0;i<t.length;i++)this[t[i]]=this[t[i]]||s[t[i]]&&this[t[i]]===s[t[i]].exception?this[t[i]]:g[t[i]]}get heatMapEl(){return h(this)}static get watchers(){return{data:["dataWatcher"],uniqueID:["idWatcher"],highestHeadingLevel:["headingWatcher"],mainTitle:["titleWatcher"],subTitle:["subtitleWatcher"],height:["layoutWatcher"],width:["layoutWatcher"],padding:["layoutWatcher"],margin:["layoutWatcher"],xAccessor:["xAccessorWatcher"],yAccessor:["yAccessorWatcher"],valueAccessor:["groupAccessorWatcher"],xKeyOrder:["xKeyOrderWatcher"],yKeyOrder:["yKeyOrderWatcher"],xAxis:["xAxisWatcher"],yAxis:["yAxisWatcher"],wrapLabel:["wrapLabelWatcher"],hideAxisPath:["hideAxisPathWatcher"],colorPalette:["colorsWatcher"],colors:["colorsWatcher"],colorSteps:["colorsWatcher"],hoverStyle:["hoverStyleWatcher"],clickStyle:["clickStyleWatcher"],shape:["shapeWatcher"],cursor:["cursorWatcher"],strokeWidth:["strokeWidthWatcher"],hoverOpacity:["hoverOpacityWatcher"],dataLabel:["labelWatcher"],showTooltip:["showTooltipWatcher"],tooltipLabel:["tooltipLabelWatcher"],legend:["legendWatcher"],suppressEvents:["suppressWatcher"],annotations:["annotationsWatcher"],accessibility:["accessibilityWatcher"],localization:["localizationWatcher"],maxValueOverride:["valueOverrideWatcher"],minValueOverride:["valueOverrideWatcher"],clickHighlight:["clickWatcher"],hoverHighlight:["hoverWatcher"],interactionKeys:["interactionWatcher"],dataKeyNames:["dataKeyNamesWatcher"],unitTest:["unitTestWatcher"]}}};window.VisaChartsLibOSSLicenses=dt(),Wt.style=".o-layout{width:100%;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.o-layout--chart{width:100%}.is--vertical .o-layout--chart{width:90%}heat-map{cursor:default}heat-map .vcl-sub-title-keyword{-webkit-padding-before:1px;padding:3px 6px 1px 6px}heat-map .annotations{pointer-events:none}heat-map .annotations .handle{pointer-events:all}heat-map .screen-reader-info{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}heat-map .data-table-link{color:#767676;text-decoration:none;font-size:12px;margin-left:5%}heat-map .hidden{display:none}heat-map .axis{font-size:12px}heat-map .axis text{fill:#767676}heat-map .axis-label{text-anchor:middle;font:1rem sans-serif}heat-map .axis path{stroke:#767676}heat-map .axis .hidden{visibility:hidden}heat-map .heat-map-legend{font-size:1em;display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:start;justify-content:flex-start}heat-map .heat-map-legend .legend{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:start;justify-content:flex-start}";export{Wt as heat_map}