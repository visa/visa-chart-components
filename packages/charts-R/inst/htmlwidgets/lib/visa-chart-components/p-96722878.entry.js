/**
 * Copyright (c) 2024 Visa, Inc.
 *
 * This source code is licensed under the MIT license
 * https://github.com/visa/visa-chart-components/blob/master/LICENSE
 *
 **/
import{r as t,c as i,h as s,g as h}from"./p-eeee2e3c.js";import{m as e}from"./p-cbe185fc.js";import{m as a}from"./p-b0dcbe24.js";import{v as o,s as l,e as n}from"./p-a494a9b5.js";import{v as r}from"./p-9cc83250.js";import{c}from"./p-209ccfff.js";import{w as d,s as u,c as p}from"./p-fef5c4ba.js";import{b as v,a as g}from"./p-8e11a6c4.js";import{x as m,y}from"./p-cbc590f6.js";function b(t){return t.source}function f(t){return t.target}function k(t){let i=b,s=f,h=m,e=y,a=null,o=null,l=d(n);function n(){let n;const r=u.call(arguments),c=i.apply(this,r),d=s.apply(this,r);if(null==a&&(o=t(n=l())),o.lineStart(),r[0]=c,o.point(+h.apply(this,r),+e.apply(this,r)),r[0]=d,o.point(+h.apply(this,r),+e.apply(this,r)),o.lineEnd(),n)return o=null,n+""||null}return n.source=function(t){return arguments.length?(i=t,n):i},n.target=function(t){return arguments.length?(s=t,n):s},n.x=function(t){return arguments.length?(h="function"==typeof t?t:p(+t),n):h},n.y=function(t){return arguments.length?(e="function"==typeof t?t:p(+t),n):e},n.context=function(i){return arguments.length?(null==i?a=o=null:o=t(a=i),n):a},n}const{propDefaultValues:A}=o;class W{}W.highestHeadingLevel=A.highestHeadingLevel,W.mainTitle="Alluvial Diagram Title",W.subTitle=A.subTitle.text,W.height=300,W.width=650,W.layout=A.layoutHorizontal,W.margin={top:3,bottom:3,right:6.5,left:6.5},W.padding={top:20,bottom:50,right:50,left:50},W.localization=A.localization,W.sourceAccessor="source",W.targetAccessor="target",W.valueAccessor="value",W.groupAccessor="",W.nodeIDAccessor="id",W.nodeConfig={fill:!1,width:12,padding:20,alignment:"left",compare:!1},W.linkConfig={visible:!0,fillMode:"none",opacity:.3},W.accessibility=A.accessibility,W.animationConfig=A.animationConfig,W.colorPalette=A.colorPaletteCategorical,W.dataLabel=A.dataLabel,W.annotations=A.annotations,W.hoverStyle=A.hoverStyle,W.clickStyle=A.clickStyle,W.hoverOpacity=A.hoverOpacity,W.cursor=A.cursor,W.tooltipLabel=A.tooltipLabel,W.showTooltip=A.showTooltip,W.suppressEvents=A.suppressEvents,W.clickHighlight=A.clickHighlight;const{getGlobalInstances:w,configLocalization:x,getActiveLanguageString:L,initializeDescriptionRoot:T,setAccessibilityController:C,initializeElementAccess:D,setElementFocusHandler:E,setElementAccessID:S,setAccessChartCounts:N,hideNonessentialGroups:I,setAccessTitle:j,setAccessSubtitle:P,setAccessLongDescription:O,setAccessExecutiveSummary:z,setAccessPurpose:G,setAccessContext:K,setAccessStatistics:H,setAccessStructure:M,setAccessAnnotation:_,retainAccessFocus:q,checkAccessFocus:$,setElementInteractionAccessState:V,setAccessibilityDescriptionWidth:F,roundTo:R,resolveLabelCollision:U,transitionEndAll:B,annotate:J,checkClicked:Q,checkInteraction:X,convertVisaColor:Y,createTextStrokeFilter:Z,drawTooltip:tt,findTagLevel:it,formatDataLabel:st,formatStats:ht,getColors:et,getContrastingStroke:at,getPadding:ot,checkHovered:lt,initTooltipStyle:nt,overrideTitleTooltip:rt,scopeDataKeys:ct,chartAccessors:dt,sankey:ut,sankeyCenter:pt,sankeyJustify:vt,sankeyLeft:gt,sankeyLinkHorizontal:mt,sankeyLinkVertical:yt,sankeyRight:bt,prepareRenderChange:ft,visaColors:kt,validateAccessibilityProps:At,validateLocalizationProps:Wt,setSubTitle:wt}=o,xt=class{constructor(s){t(this,s),this.clickEvent=i(this,"clickEvent",7),this.hoverEvent=i(this,"hoverEvent",7),this.mouseOutEvent=i(this,"mouseOutEvent",7),this.initialLoadEvent=i(this,"initialLoadEvent",7),this.initialLoadEndEvent=i(this,"initialLoadEndEvent",7),this.drawStartEvent=i(this,"drawStartEvent",7),this.drawEndEvent=i(this,"drawEndEvent",7),this.transitionEndEvent=i(this,"transitionEndEvent",7),this.shouldValidateAccessibility=!0,this.shouldValidateLocalization=!0,this.innerInteractionKeys=[],this.topLevel="h2",this.bottomLevel="p",this.sourceLinksString="sourceLinks",this.targetLinksString="targetLinks",this.valueString="value",this.updated=!0,this.shouldSetDimensions=!1,this.shouldUpdateData=!1,this.shouldSetColors=!1,this.shouldSetSubTitle=!1,this.shouldSetTagLevels=!1,this.shouldRedrawWrapper=!1,this.shouldUpdateTableData=!1,this.shouldUpdateDescriptionWrapper=!1,this.shouldSetChartAccessibilityCount=!1,this.shouldSetChartAccessibilityTitle=!1,this.shouldSetChartAccessibilitySubtitle=!1,this.shouldSetChartAccessibilityLongDescription=!1,this.shouldSetChartAccessibilityExecutiveSummary=!1,this.shouldSetChartAccessibilityPurpose=!1,this.shouldSetChartAccessibilityContext=!1,this.shouldSetChartAccessibilityStatisticalNotes=!1,this.shouldSetChartAccessibilityStructureNotes=!1,this.shouldSetParentSVGAccessibility=!1,this.shouldSetGeometryAccessibilityAttributes=!1,this.shouldSetGeometryAriaLabels=!1,this.shouldSetGroupAccessibilityLabel=!1,this.shouldSetSelectionClass=!1,this.shouldSetAnnotationAccessibility=!1,this.shouldSetGlobalSelections=!1,this.shouldSetTestingAttributes=!1,this.shouldDrawInteractionState=!1,this.shouldEnterUpdateExit=!1,this.shouldUpdateNodeGeometries=!1,this.shouldUpdateNodeStyle=!1,this.shouldUpdateLinkGeometries=!1,this.shouldUpdateLinkStyle=!1,this.shouldDrawNodeLabels=!1,this.shouldSetNodeDimensions=!1,this.shouldCallSankeyGenerator=!1,this.shouldUpdateAnnotations=!1,this.shouldValidateIdAccessor=!1,this.shouldValidateLabelText=!1,this.shouldValidateLinkFillMode=!1,this.shouldValidateNodeAlignment=!1,this.shouldValidateInteractionKeys=!1,this.shouldValidateLinkGroups=!1,this.shouldUpdateCursor=!1,this.shouldBindInteractivity=!1,this.shouldResetRoot=!1,this.shouldSetNodeLabelOpacity=!1,this.shouldSetLocalizationConfig=!1,this.mainTitle=W.mainTitle,this.subTitle=W.subTitle,this.height=W.height,this.width=W.width,this.highestHeadingLevel=W.highestHeadingLevel,this.margin=W.margin,this.padding=W.padding,this.layout=W.layout,this.linkData=void 0,this.nodeData=void 0,this.uniqueID=void 0,this.localization=W.localization,this.sourceAccessor=W.sourceAccessor,this.targetAccessor=W.targetAccessor,this.valueAccessor=W.valueAccessor,this.groupAccessor=W.groupAccessor,this.nodeIDAccessor=W.nodeIDAccessor,this.nodeConfig=W.nodeConfig,this.linkConfig=W.linkConfig,this.colorPalette=W.colorPalette,this.colors=void 0,this.hoverStyle=W.hoverStyle,this.clickStyle=W.clickStyle,this.cursor=W.cursor,this.hoverOpacity=W.hoverOpacity,this.animationConfig=W.animationConfig,this.dataLabel=W.dataLabel,this.dataKeyNames=void 0,this.showTooltip=W.showTooltip,this.tooltipLabel=W.tooltipLabel,this.accessibility=W.accessibility,this.annotations=W.annotations,this.suppressEvents=W.suppressEvents,this.hoverHighlight=void 0,this.clickHighlight=W.clickHighlight,this.interactionKeys=void 0,this.unitTest=!1}dataWatcher(t,i){this.updated=!0,this.shouldUpdateData=!0,this.shouldSetColors=!0,this.shouldValidateIdAccessor=!0,this.shouldSetNodeDimensions=!0,this.shouldCallSankeyGenerator=!0,this.shouldUpdateTableData=!0,this.shouldValidateLinkGroups=!0,this.shouldValidateAccessibility=!0,this.shouldSetGlobalSelections=!0,this.shouldSetTestingAttributes=!0,this.shouldEnterUpdateExit=!0,this.shouldUpdateNodeGeometries=!0,this.shouldUpdateNodeStyle=!0,this.shouldUpdateLinkGeometries=!0,this.shouldDrawNodeLabels=!0,this.shouldUpdateLinkStyle=!0,this.shouldDrawInteractionState=!0,this.shouldSetGeometryAccessibilityAttributes=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldBindInteractivity=!0,this.shouldUpdateCursor=!0,this.shouldUpdateAnnotations=!0}idWatcher(t,i){console.error("Change detected in prop uniqueID from value "+i+" to value "+t+". This prop cannot be changed after component has loaded.")}headingWatcher(t,i){this.shouldRedrawWrapper=!0,this.shouldSetTagLevels=!0,this.shouldSetChartAccessibilityCount=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetAnnotationAccessibility=!0,this.shouldSetSubTitle=!0,this.shouldSetChartAccessibilityTitle=!0,this.shouldSetChartAccessibilitySubtitle=!0,this.shouldSetChartAccessibilityLongDescription=!0,this.shouldSetChartAccessibilityContext=!0,this.shouldSetChartAccessibilityExecutiveSummary=!0,this.shouldSetChartAccessibilityPurpose=!0,this.shouldSetChartAccessibilityStatisticalNotes=!0,this.shouldSetChartAccessibilityStructureNotes=!0}mainTitleWatcher(t,i){this.shouldValidateAccessibility=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetChartAccessibilityTitle=!0,this.shouldSetParentSVGAccessibility=!0}subTitleWatcher(t,i){this.shouldSetSubTitle=!0,this.shouldSetChartAccessibilityTitle=!0,this.shouldSetChartAccessibilitySubtitle=!0,this.shouldSetParentSVGAccessibility=!0}dimensionWatcher(t,i){this.shouldSetDimensions=!0,this.shouldSetNodeDimensions=!0,this.shouldResetRoot=!0,this.shouldCallSankeyGenerator=!0,this.shouldSetGlobalSelections=!0,this.shouldUpdateNodeGeometries=!0,this.shouldUpdateNodeStyle=!0,this.shouldUpdateLinkGeometries=!0,this.shouldUpdateLinkStyle=!0,this.shouldDrawNodeLabels=!0,this.shouldUpdateAnnotations=!0}layoutWatcher(t,i){this.shouldSetDimensions=!0,this.shouldSetNodeDimensions=!0,this.shouldResetRoot=!0,this.shouldCallSankeyGenerator=!0,this.shouldSetGlobalSelections=!0,this.shouldUpdateNodeGeometries=!0,this.shouldUpdateNodeStyle=!0,this.shouldUpdateLinkGeometries=!0,this.shouldUpdateLinkStyle=!0,this.shouldDrawNodeLabels=!0,this.shouldUpdateAnnotations=!0,console.warn("Change detected in prop layout from value "+i+" to value "+t+". Transitions have yet to be designed in VCC for this prop.")}sourceAccessorWatcher(t,i){console.error("Change detected in prop sourceAccessor from value "+i+" to value "+t+". This prop cannot be changed after component has loaded.")}targetAccessorWatcher(t,i){console.error("Change detected in prop targetAccessor from value "+i+" to value "+t+". This prop cannot be changed after component has loaded.")}valueAccessorWatcher(t,i){this.shouldUpdateData=!0,this.shouldSetNodeDimensions=!0,this.shouldCallSankeyGenerator=!0,this.shouldUpdateTableData=!0,this.shouldSetGlobalSelections=!0,this.shouldEnterUpdateExit=!0,this.shouldUpdateNodeGeometries=!0,this.shouldUpdateNodeStyle=!0,this.shouldUpdateLinkGeometries=!0,this.shouldUpdateLinkStyle=!0,this.shouldDrawInteractionState=!0,this.shouldSetNodeLabelOpacity=!0,this.shouldDrawNodeLabels=!0,this.shouldSetGeometryAriaLabels=!0}groupAccessorWatcher(t,i){this.shouldUpdateData=!0,this.shouldValidateLinkFillMode=!0,this.shouldValidateLinkGroups=!0,this.shouldSetNodeDimensions=!0,this.shouldCallSankeyGenerator=!0,this.shouldUpdateTableData=!0,this.shouldSetGlobalSelections=!0,this.shouldEnterUpdateExit=!0,this.shouldUpdateNodeGeometries=!0,this.shouldUpdateNodeStyle=!0,this.shouldUpdateLinkGeometries=!0,this.shouldUpdateLinkStyle=!0,this.shouldDrawInteractionState=!0,this.shouldSetNodeLabelOpacity=!0,this.shouldDrawNodeLabels=!0,this.shouldSetGeometryAriaLabels=!0}nodeIDAccessorWatcher(t,i){console.error("Change detected in prop nodeIDAccessor from value "+i+" to value "+t+". This prop cannot be changed after component has loaded.")}nodeConfigWatcher(t,i){const s=t&&t.alignment,h=i&&i.alignment,e=t&&t.compare,a=i&&i.compare,o=t&&t.fill,l=i&&i.fill,n=t&&t.width,r=i&&i.width,c=t&&t.padding,d=i&&i.padding;s!==h&&(this.shouldValidateNodeAlignment=!0),s===h&&e===a&&n===r&&c===d||(this.shouldSetNodeDimensions=!0,this.shouldCallSankeyGenerator=!0,this.shouldSetGlobalSelections=!0,this.shouldDrawInteractionState=!0,this.shouldSetGeometryAccessibilityAttributes=!0,this.shouldUpdateNodeGeometries=!0,this.shouldUpdateLinkGeometries=!0,this.shouldDrawNodeLabels=!0,this.shouldUpdateAnnotations=!0),o!==l&&(this.shouldUpdateNodeStyle=!0,this.shouldUpdateLinkStyle=!0)}linkConfigWatcher(t,i){const s=t&&t.visible,h=i&&i.visible;(t&&t.fillMode)!==(i&&i.fillMode)&&(this.shouldValidateLinkFillMode=!0,this.shouldSetGlobalSelections=!0,this.shouldEnterUpdateExit=!0,this.shouldUpdateLinkGeometries=!0),s!==h&&(this.shouldSetNodeDimensions=!0,this.shouldCallSankeyGenerator=!0,this.shouldSetGlobalSelections=!0,this.shouldSetNodeLabelOpacity=!0,this.shouldUpdateNodeGeometries=!0,this.shouldUpdateLinkGeometries=!0,this.shouldDrawNodeLabels=!0,this.shouldUpdateAnnotations=!0),this.shouldUpdateLinkStyle=!0,this.shouldDrawInteractionState=!0,this.shouldSetTestingAttributes=!0}colorWatcher(t,i){this.shouldSetColors=!0,this.shouldUpdateNodeStyle=!0,this.shouldUpdateLinkStyle=!0,this.shouldDrawInteractionState=!0}interactionStyleWatcher(t,i){this.shouldSetColors=!0,this.shouldDrawInteractionState=!0,this.shouldSetNodeLabelOpacity=!0}cursorWatcher(t,i){this.shouldUpdateCursor=!0}hoverOpacityWatcher(t,i){this.shouldDrawInteractionState=!0,this.shouldSetNodeLabelOpacity=!0}dataLabelWatcher(t,i){const s=t&&t.visible,h=i&&i.visible;(!(!t||!t.labelAccessor)&&t.labelAccessor)!==(!(!i||!i.labelAccessor)&&i.labelAccessor)&&(this.shouldValidateLabelText=!0),this.shouldDrawNodeLabels=!0,this.shouldUpdateTableData=!0,s!==h&&(this.shouldSetNodeLabelOpacity=!0)}tooltipLabelWatcher(t,i){this.shouldUpdateTableData=!0,this.shouldSetParentSVGAccessibility=!0,this.shouldSetGeometryAriaLabels=!0}showTooltipWatcher(t,i){this.shouldDrawInteractionState=!0}accessibilityWatcher(t,i){this.shouldValidateAccessibility=!0,(!(!t||!t.title)&&t.title)!==(!(!i||!i.title)&&i.title)&&(this.shouldUpdateDescriptionWrapper=!0,this.shouldSetChartAccessibilityTitle=!0,this.shouldSetParentSVGAccessibility=!0),(!(!t||!t.executiveSummary)&&t.executiveSummary)!==(!(!i||!i.executiveSummary)&&i.executiveSummary)&&(this.shouldSetChartAccessibilityExecutiveSummary=!0),(!(!t||!t.purpose)&&t.purpose)!==(!(!i||!i.purpose)&&i.purpose)&&(this.shouldSetChartAccessibilityPurpose=!0),(!(!t||!t.longDescription)&&t.longDescription)!==(!(!i||!i.longDescription)&&i.longDescription)&&(this.shouldSetChartAccessibilityLongDescription=!0),(!(!t||!t.contextExplanation)&&t.contextExplanation)!==(!(!i||!i.contextExplanation)&&i.contextExplanation)&&(this.shouldSetChartAccessibilityContext=!0),(!(!t||!t.statisticalNotes)&&t.statisticalNotes)!==(!(!i||!i.statisticalNotes)&&i.statisticalNotes)&&(this.shouldSetChartAccessibilityStatisticalNotes=!0),(!(!t||!t.structureNotes)&&t.structureNotes)!==(!(!i||!i.structureNotes)&&i.structureNotes)&&(this.shouldSetChartAccessibilityStructureNotes=!0);const s=t&&t.includeDataKeyNames,h=i&&i.includeDataKeyNames;s===h&&(!(!t||!t.elementDescriptionAccessor)&&t.elementDescriptionAccessor)===(!(!i||!i.elementDescriptionAccessor)&&i.elementDescriptionAccessor)||(s!==h&&(this.shouldSetGroupAccessibilityLabel=!0),this.shouldSetGeometryAriaLabels=!0,this.shouldSetParentSVGAccessibility=!0);const e=!(!t||!t.elementsAreInterface)&&t.elementsAreInterface,a=!(!i||!i.elementsAreInterface)&&i.elementsAreInterface;(!!(t&&t.keyboardNavConfig&&t.keyboardNavConfig.disabled)&&t.keyboardNavConfig.disabled)===(!!(i&&i.keyboardNavConfig&&i.keyboardNavConfig.disabled)&&i.keyboardNavConfig.disabled)&&e===a||(this.shouldSetGeometryAriaLabels=!0,this.shouldSetParentSVGAccessibility=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldRedrawWrapper=!0,this.shouldSetChartAccessibilityTitle=!0,this.shouldSetChartAccessibilitySubtitle=!0,this.shouldSetChartAccessibilityLongDescription=!0,this.shouldSetChartAccessibilityContext=!0,this.shouldSetChartAccessibilityExecutiveSummary=!0,this.shouldSetChartAccessibilityPurpose=!0,this.shouldSetChartAccessibilityStatisticalNotes=!0,this.shouldSetChartAccessibilityStructureNotes=!0),e!==a&&(this.shouldSetSelectionClass=!0)}localizationWatcher(t,i){this.shouldValidateLocalization=!0,(!(!t||!t.language)&&t.language)!==(!(!i||!i.language)&&i.language)&&(this.shouldSetLocalizationConfig=!0,this.shouldUpdateTableData=!0,this.shouldRedrawWrapper=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetChartAccessibilityCount=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldSetParentSVGAccessibility=!0),(!(!t||!t.numeralLocale)&&t.numeralLocale)!==(!(!i||!i.numeralLocale)&&i.numeralLocale)&&(this.shouldSetLocalizationConfig=!0,this.shouldUpdateTableData=!0,this.shouldRedrawWrapper=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetChartAccessibilityCount=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldSetParentSVGAccessibility=!0)}annotationsWatcher(t,i){this.shouldValidateAccessibility=!0,this.shouldSetAnnotationAccessibility=!0,this.shouldUpdateAnnotations=!0}clickWatcher(t,i){this.shouldDrawInteractionState=!0,this.shouldSetNodeLabelOpacity=!0,this.shouldSetSelectionClass=!0}hoverWatcher(t,i){this.shouldDrawInteractionState=!0,this.shouldSetNodeLabelOpacity=!0}interactionWatcher(t,i){this.shouldSetNodeDimensions=!0,this.shouldCallSankeyGenerator=!0,this.shouldValidateInteractionKeys=!0,this.shouldDrawInteractionState=!0,this.shouldSetNodeLabelOpacity=!0,this.shouldSetSelectionClass=!0,this.shouldUpdateTableData=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldBindInteractivity=!0,this.shouldUpdateCursor=!0}dataKeyNamesWatcher(t,i){this.shouldSetParentSVGAccessibility=!0,this.shouldSetGroupAccessibilityLabel=!0,this.shouldSetGeometryAriaLabels=!0}suppressWatcher(t,i){this.shouldBindInteractivity=!0,this.shouldUpdateCursor=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldSetParentSVGAccessibility=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldValidateAccessibility=!0,this.shouldRedrawWrapper=!0,this.shouldSetSubTitle=!0,this.shouldSetChartAccessibilityTitle=!0,this.shouldSetChartAccessibilitySubtitle=!0,this.shouldSetChartAccessibilityLongDescription=!0,this.shouldSetChartAccessibilityContext=!0,this.shouldSetChartAccessibilityExecutiveSummary=!0,this.shouldSetChartAccessibilityPurpose=!0,this.shouldSetChartAccessibilityStatisticalNotes=!0,this.shouldSetChartAccessibilityStructureNotes=!0}unitTestWatcher(t,i){this.shouldSetTestingAttributes=!0}componentWillLoad(){const t=this.uniqueID||"alluvial-diagram-"+r();return this.initialLoadEvent.emit({chartID:t}),new Promise((i=>{this.duration=0,this.defaults=!0,this.chartID=t,this.alluvialDiagramEl.id=this.chartID,this.setLocalizationConfig(),this.setTagLevels(),this.prepareData(),this.setDimensions(),this.validateIdAccessor(),this.validateLabelText(),this.validateLinkFillMode(),this.validateNodeAlignment(),this.validateInteractionKeys(),this.validateLinkGroups(),this.shouldValidateAccessibilityProps(),this.shouldValidateLocalizationProps(),this.setColors(),this.setNodeDimensions(),this.callSankeyGenerator(),this.setTableData(),i("component will load")}))}componentWillUpdate(){return new Promise((t=>{t("component will update")}))}componentDidLoad(){return new Promise((t=>{this.shouldValidateAccessibilityProps(),this.shouldValidateLocalizationProps(),this.renderRootElements(),this.setTooltipInitialStyle(),this.setChartDescriptionWrapper(),this.setChartAccessibilityTitle(),this.setChartAccessibilitySubtitle(),this.setChartAccessibilityLongDescription(),this.setChartAccessibilityExecutiveSummary(),this.setChartAccessibilityPurpose(),this.setChartAccessibilityContext(),this.setChartAccessibilityStatisticalNotes(),this.setChartAccessibilityStructureNotes(),this.setParentSVGAccessibility(),this.reSetRoot(),this.setSubTitleElements(),this.setGlobalSelections(),this.setTestingAttributes(),this.enterLinkGeometries(),this.updateLinkGeometries(),this.exitLinkGeometries(),this.enterNodeGeometries(),this.updateNodeGeometries(),this.exitNodeGeometries(),this.enterNodeLabels(),this.updateNodeLabels(),this.exitNodeLabels(),this.updateLinkStyle(),this.drawNodeGeometries(),this.drawLinkGeometries(),this.setGeometryAccessibilityAttributes(),this.setGeometryAriaLabels(),this.setGroupAccessibilityID(),this.setChartCountAccessibility(),this.setSelectedClass(),this.updateCursor(),this.drawNodeLabels(),this.bindInteractivity(),this.drawAnnotations(),this.setAnnotationAccessibility(),this.onChangeHandler(),this.duration=750,this.defaults=!1,I(this.root.node(),null),t("component did load")})).then((()=>this.initialLoadEndEvent.emit({chartID:this.chartID})))}componentDidUpdate(){return new Promise((t=>{this.duration=this.animationConfig&&this.animationConfig.disabled?0:750,this.shouldUpdateDescriptionWrapper&&(this.setChartDescriptionWrapper(),this.shouldUpdateDescriptionWrapper=!1),this.shouldSetChartAccessibilityCount&&(this.setChartCountAccessibility(),this.shouldSetChartAccessibilityCount=!1),this.shouldSetChartAccessibilityTitle&&(this.setChartAccessibilityTitle(),this.shouldSetChartAccessibilityTitle=!1),this.shouldSetChartAccessibilitySubtitle&&(this.setChartAccessibilitySubtitle(),this.shouldSetChartAccessibilitySubtitle=!1),this.shouldSetChartAccessibilityLongDescription&&(this.setChartAccessibilityLongDescription(),this.shouldSetChartAccessibilityLongDescription=!1),this.shouldSetChartAccessibilityExecutiveSummary&&(this.setChartAccessibilityExecutiveSummary(),this.shouldSetChartAccessibilityExecutiveSummary=!1),this.shouldSetChartAccessibilityPurpose&&(this.setChartAccessibilityPurpose(),this.shouldSetChartAccessibilityPurpose=!1),this.shouldSetChartAccessibilityContext&&(this.setChartAccessibilityContext(),this.shouldSetChartAccessibilityContext=!1),this.shouldSetChartAccessibilityStatisticalNotes&&(this.setChartAccessibilityStatisticalNotes(),this.shouldSetChartAccessibilityStatisticalNotes=!1),this.shouldSetChartAccessibilityStructureNotes&&(this.setChartAccessibilityStructureNotes(),this.shouldSetChartAccessibilityStructureNotes=!1),this.shouldSetParentSVGAccessibility&&(this.setParentSVGAccessibility(),this.shouldSetParentSVGAccessibility=!1),this.shouldResetRoot&&(this.reSetRoot(),this.shouldResetRoot=!1),this.shouldSetGlobalSelections&&(this.setGlobalSelections(),this.shouldSetGlobalSelections=!1),this.shouldSetTestingAttributes&&(this.setTestingAttributes(),this.shouldSetTestingAttributes=!1),this.shouldSetSubTitle&&(this.setSubTitleElements(),this.shouldSetSubTitle=!1),this.shouldEnterUpdateExit&&(this.enterLinkGeometries(),this.updateLinkGeometries(),this.exitLinkGeometries(),this.enterNodeGeometries(),this.updateNodeGeometries(),this.exitNodeGeometries(),this.enterNodeLabels(),this.updateNodeLabels(),this.exitNodeLabels(),this.shouldEnterUpdateExit=!1),this.shouldUpdateNodeGeometries&&(this.drawNodeGeometries(),this.shouldUpdateNodeGeometries=!1),this.shouldUpdateNodeStyle&&(this.updateNodeStyle(),this.shouldUpdateNodeStyle=!1),this.shouldUpdateLinkGeometries&&(this.drawLinkGeometries(),this.shouldUpdateLinkGeometries=!1),this.shouldUpdateLinkStyle&&(this.updateLinkStyle(),this.shouldUpdateLinkStyle=!1),this.shouldSetGeometryAccessibilityAttributes&&(this.setGeometryAccessibilityAttributes(),this.shouldSetGeometryAccessibilityAttributes=!1),this.shouldSetGeometryAriaLabels&&(this.setGeometryAriaLabels(),this.shouldSetGeometryAriaLabels=!1),this.shouldSetGroupAccessibilityLabel&&(this.setGroupAccessibilityID(),this.shouldSetGroupAccessibilityLabel=!1),this.shouldDrawNodeLabels&&(this.drawNodeLabels(),this.shouldDrawNodeLabels=!1),this.shouldDrawInteractionState&&(this.updateInteractionState(),this.shouldDrawInteractionState=!1),this.shouldSetNodeLabelOpacity&&(this.setNodeLabelOpacity(),this.shouldSetNodeLabelOpacity=!1),this.shouldSetSelectionClass&&(this.setSelectedClass(),this.shouldSetSelectionClass=!1),this.shouldUpdateCursor&&(this.updateCursor(),this.shouldUpdateCursor=!1),this.shouldBindInteractivity&&(this.bindInteractivity(),this.shouldBindInteractivity=!1),this.shouldUpdateAnnotations&&(this.drawAnnotations(),this.shouldUpdateAnnotations=!1),this.shouldSetAnnotationAccessibility&&(this.setAnnotationAccessibility(),this.shouldSetAnnotationAccessibility=!1),this.onChangeHandler(),t("component did update")})).then((()=>this.drawEndEvent.emit({chartID:this.chartID})))}setDimensions(){this.padding="string"==typeof this.padding?ot(this.padding):this.padding,"vertical"===this.layout?(this.innerWidth=this.height-this.margin.top-this.margin.bottom,this.innerHeight=this.width-this.margin.left-this.margin.right,this.innerPaddedHeight=this.innerHeight-this.padding.left-this.padding.right,this.innerPaddedWidth=this.innerWidth-this.padding.top-this.padding.bottom):(this.innerWidth=this.width-this.margin.left-this.margin.right,this.innerHeight=this.height-this.margin.top-this.margin.bottom,this.innerPaddedHeight=this.innerHeight-this.padding.top-this.padding.bottom,this.innerPaddedWidth=this.innerWidth-this.padding.left-this.padding.right)}prepareData(){this.nodeList=[],this.linkList=[],this.linkData.forEach(((t,i)=>{const s={source:t[this.sourceAccessor],target:t[this.targetAccessor],value:t[this.valueAccessor],data:t};this.groupAccessor&&(s[this.groupAccessor]=t[this.groupAccessor]),this.linkList[i]=s})),this.nodeData&&this.nodeData.length>1?this.nodeList=this.nodeData:this.createNodeList()}createNodeList(){this.nodeList=[],this.linkData.map((t=>{this.nodeList.some((i=>i.id===t[this.sourceAccessor]))||this.nodeList.push({id:t[this.sourceAccessor]}),this.nodeList.some((i=>i.id===t[this.targetAccessor]))||this.nodeList.push({id:t[this.targetAccessor]})}))}validateLabelText(){this.innerLabelAccessor=this.dataLabel.labelAccessor?this.dataLabel.labelAccessor:this.valueString}validateIdAccessor(){this.innerIDAccessor=this.nodeData&&this.nodeData.length>1&&this.nodeList[0][this.nodeIDAccessor]?this.nodeIDAccessor:"id"}validateLinkFillMode(){this.innerLinkFillMode=this.groupAccessor&&"group"===this.linkConfig.fillMode?"group":"source"===this.linkConfig.fillMode?"source":"target"===this.linkConfig.fillMode?"target":"link"===this.linkConfig.fillMode?"link":"none"}validateNodeAlignment(){this.innerNodeAlignment="vertical"===this.layout?"bottom"===this.nodeConfig.alignment?bt:"middle"===this.nodeConfig.alignment?pt:"justify"===this.nodeConfig.alignment?vt:gt:"right"===this.nodeConfig.alignment?bt:"center"===this.nodeConfig.alignment?pt:"justify"===this.nodeConfig.alignment?vt:gt}validateInteractionKeys(){this.innerInteractionKeys=[],this.innerInteractionKeys=this.interactionKeys&&this.interactionKeys.length?this.interactionKeys:[this.sourceAccessor,this.targetAccessor]}validateLinkGroups(){this.groupKeys=[],this.groupAccessor&&(this.groupKeys=this.linkData.map((t=>t[this.groupAccessor])).filter(((t,i,s)=>s.indexOf(t)===i)))}shouldValidateLocalizationProps(){const t=w(),i=t.i18Next.getResourceBundle(t.i18Next.language),s=t.numeral.localeData();this.shouldValidateLocalization&&!this.localization.skipValidation&&(this.shouldValidateLocalization=!1,Wt(this.chartID,Object.assign(Object.assign({},this.localization),{language:i,numeralLocale:s})))}shouldValidateAccessibilityProps(){this.shouldValidateAccessibility&&!this.accessibility.disableValidation&&(this.shouldValidateAccessibility=!1,At(this.chartID,Object.assign({},this.accessibility),{annotations:this.annotations,data:this.linkData,uniqueID:this.uniqueID,context:{mainTitle:this.mainTitle,onClickEvent:this.suppressEvents?void 0:this.clickEvent.emit}}))}getLanguageString(){return L(this.localization)}setLocalizationConfig(){x(this.localization)}setTableData(){const t=ct(this,{singleAccessors:["nodeIDAccessor","valueAccessor"],nestedAccessors:[{objectName:"dataLabel",objectAccessors:["labelAccessor"],formatAccessors:["format"]}]},"alluvial-diagram");this.tableData=this.getScopedTableData(this.preppedData.nodes,t),this.tableColumns=Object.keys(t);const i=dt;delete i.nestedAccessors[2];const s=ct(this,i,"alluvial-diagram-secondary-table");this.secondaryTableData=this.getScopedTableData(this.preppedData.links,s),this.secondaryTableColumns=Object.keys(s)}getScopedTableData(t,i){const s=[];return t.forEach((t=>{const h={};Object.keys(i).forEach((s=>{h[s]="data"in t&&t.data[s]?i[s]&&t.data[s]?ht(t.data[s],i[s]):t.data[s]:s===this.valueAccessor?i[s]?ht(t[this.valueString],i[s]):t[this.valueString]:i[s]&&t[s]?ht(t[s],i[s]):t[s]})),s.push(h)})),s}setNodeDimensions(){this.alluvialProperties=ut(this.nodeConfig.compare,this.linkConfig.visible,this.layout).nodeId((t=>t[this.innerIDAccessor])).nodeWidth(this.nodeConfig.width).nodePadding(this.nodeConfig.padding).nodeAlign(this.innerNodeAlignment).nodeSort(null).size([this.innerPaddedWidth,this.innerPaddedHeight])}callSankeyGenerator(){this.preppedData=((t,i)=>this.alluvialProperties({nodes:this.nodeList.map((t=>Object.assign({},t))),links:i.map((t=>Object.assign({},t)))}))(0,this.linkList),this.nodeCount=e(this.preppedData.nodes,(t=>t.layer))}renderRootElements(){this.svg=l(this.alluvialDiagramEl).select(".visa-viz-d3-alluvial-container").append("svg").attr("width",this.width).attr("height",this.height),this.root=this.svg.append("g").attr("id","visa-viz-margin-container-g-"+this.chartID),this.rootG=this.root.append("g").attr("id","visa-viz-padding-container-g-"+this.chartID),this.nodeG=this.rootG.append("g").attr("class","alluvial-node-group"),this.linkG=this.rootG.append("g").attr("class","alluvial-link-group"),this.labelG=this.rootG.append("g").attr("class","alluvial-dataLabel-group"),this.subTitleG=l(this.alluvialDiagramEl).select(".alluvial-sub-title"),this.tooltipG=l(this.alluvialDiagramEl).select(".alluvial-tooltip")}updateCursor(){this.updateLinks.attr("cursor",this.suppressEvents?null:this.cursor),this.updatingLabels.attr("cursor",!this.suppressEvents&&this.dataLabel.visible?this.cursor:null)}reSetRoot(){ft({selection:this.svg,duration:this.duration,namespace:"root_reset",easing:c}).attr("width",this.width).attr("height",this.height).attr("viewBox","0 0 "+this.width+" "+this.height),ft({selection:this.root,duration:this.duration,namespace:"root_reset",easing:c}).attr("transform",`translate(${this.margin.left}, ${this.margin.top})`),ft({selection:this.rootG,duration:this.duration,namespace:"root_reset",easing:c}).attr("transform",`translate(${this.padding.left}, ${this.padding.top})`),F(this.chartID,this.width)}setGlobalSelections(){this.currentNodeLayers&&(this.previousNodeLayers=this.currentNodeLayers);const t=this.nodeG.selectAll(".node-wrapper").data(this.preppedData.nodes,(t=>t[this.innerIDAccessor]));if(this.enterNodes=t.enter().append("g").attr("class","node-wrapper").attr("data-offset-group","true"),this.enterNodes.append("rect").attr("class","alluvial-node"),this.exitNodes=t.exit(),this.updateNodes=t.merge(this.enterNodes),this.updateNodes.selectAll(".alluvial-node").data((t=>[t])),this.currentNodeLayers=this.preppedData.nodes,this.previousNodeLayers){const t=this.currentNodeLayers.filter((t=>this.previousNodeLayers.map((t=>t[this.innerIDAccessor])).includes(t.id)));this.previousMaxNodeLayer=e(t,(t=>t.layer)),this.previousMinNodeLayer=a(t,(t=>t.layer));const i=this.previousNodeLayers.filter((t=>this.currentNodeLayers.map((t=>t[this.innerIDAccessor])).includes(t.id)));this.currentMaxNodeLayer=e(i,(t=>t.layer)),this.currentMinNodeLayer=a(i,(t=>t.layer))}if("source"===this.innerLinkFillMode||"target"===this.innerLinkFillMode){this.updateNodes.each(((t,i,s)=>{D(s[i])}));const t=this.preppedData.nodes,i=this.linkG.selectAll(".alluvial-link-wrapper").data(t,(t=>t[this.innerIDAccessor]));this.enterLinkGroups=i.enter().append("g"),this.exitLinkGroups=i.exit().remove(),this.updateLinkGroups=i.merge(this.enterLinkGroups);const s=this.updateLinkGroups.selectAll(".alluvial-link").data((t=>t.sourceLinks),(t=>t.data[this.sourceAccessor]+t.data[this.targetAccessor]));this.enterLinks=s.enter().append("path"),this.exitLinks=s.exit(),this.updateLinks=s.merge(this.enterLinks).attr("data-offset-element",this.innerLinkFillMode)}else{this.updateNodes.attr("tabindex",null);const t=this.linkG.selectAll(".alluvial-link").data(this.preppedData.links,(t=>t.data[this.sourceAccessor]+t.data[this.targetAccessor]));this.enterLinks=t.enter().append("path"),this.exitLinks=t.exit(),this.updateLinks=t.merge(this.enterLinks).attr("data-offset-element",null)}this.exitSize=this.exitLinks.size(),this.enterSize=this.enterLinks.size();const i=this.labelG.selectAll("text").data(this.preppedData.nodes,(t=>t[this.innerIDAccessor]));this.enteringLabels=i.enter().append("text"),this.exitingLabels=i.exit(),this.updatingLabels=i.merge(this.enteringLabels)}setTestingAttributes(){this.unitTest?(l(this.alluvialDiagramEl).select(".visa-viz-d3-alluvial-container").attr("data-testid","chart-container"),l(this.alluvialDiagramEl).select(".alluvial-main-title").attr("data-testid","main-title"),l(this.alluvialDiagramEl).select(".alluvial-sub-title").attr("data-testid","sub-title"),this.svg.attr("data-testid","root-svg"),this.root.attr("data-testid","margin-container"),this.rootG.attr("data-testid","padding-container"),this.tooltipG.attr("data-testid","tooltip-container"),this.updateNodes.attr("data-testid","node").attr("data-id",(t=>`node-${t[this.innerIDAccessor]}`)),"source"!==this.innerLinkFillMode&&"target"!==this.innerLinkFillMode||this.updateLinkGroups.attr("data-testid","alluvial-link-group").attr("data-id",(t=>`link-group-${t[this.innerIDAccessor]}`)),this.updateLinks.attr("data-testid","link").attr("data-id",(t=>`link-${t.source[this.innerIDAccessor]}-${t.target[this.innerIDAccessor]}`)),this.updatingLabels.attr("data-testid","dataLabel").attr("data-id",(t=>`dataLabel-${t[this.innerIDAccessor]}`)),this.svg.select("defs").attr("data-testid","pattern-defs")):(l(this.alluvialDiagramEl).select(".visa-viz-d3-alluvial-container").attr("data-testid",null),l(this.alluvialDiagramEl).select(".alluvial-main-title").attr("data-testid",null),l(this.alluvialDiagramEl).select(".alluvial-sub-title").attr("data-testid",null),this.svg.attr("data-testid",null),this.root.attr("data-testid",null),this.rootG.attr("data-testid",null),this.tooltipG.attr("data-testid",null),this.updateNodes.attr("data-testid",null).attr("data-id",null),"source"!==this.innerLinkFillMode&&"target"!==this.innerLinkFillMode||this.updateLinkGroups.attr("data-testid",null).attr("data-id",null),this.updateLinks.attr("data-testid",null).attr("data-id",null),this.updatingLabels.attr("data-testid",null).attr("data-id",null),this.svg.select("defs").attr("data-testid",null))}newColumnInterpolationPosition(){return k(v).source((t=>t.target.layer<=this.previousMinNodeLayer?[t.source.x0,t.y0]:t.source.layer>=this.previousMaxNodeLayer?[t.target.x1,t.y0]:[t.source.x1,t.y0])).target((t=>t.target.layer<=this.previousMinNodeLayer?[t.source.x0,t.y0]:t.source.layer>=this.previousMaxNodeLayer?[t.target.x1,t.y0]:[t.target.x0,t.y1]))}newColumnInterpolationPositionVertical(){return k(g).source((t=>t.target.layer<=this.previousMinNodeLayer?[t.x0,t.source.y0]:t.source.layer>=this.previousMaxNodeLayer?[t.x0,t.target.y1]:[t.x0,t.source.y1])).target((t=>t.target.layer<=this.previousMinNodeLayer?[t.x0,t.source.y0]:t.source.layer>=this.previousMaxNodeLayer?[t.x0,t.target.y1]:[t.x1,t.target.y0]))}enterLinkGeometries(){this.enterLinks.interrupt();const t=this.linkConfig.visible?this.linkConfig.opacity:0;"source"!==this.innerLinkFillMode&&"target"!==this.innerLinkFillMode||this.enterLinkGroups.attr("class","alluvial-link-wrapper"),this.enterLinks.attr("class","alluvial-link").classed("entering",!0).attr("d","vertical"===this.layout?this.newColumnInterpolationPositionVertical():this.newColumnInterpolationPosition()),this.enterLinks.attr("cursor",this.suppressEvents?null:this.cursor).on("click",this.suppressEvents?null:(t,i,s)=>this.onClickHandler(t,s[i])).on("mouseover",this.suppressEvents?null:(t,i,s)=>this.onHoverHandler(t,s[i])).on("mouseout",this.suppressEvents?null:()=>this.onMouseOutHandler()).attr("stroke-dasharray",((t,i,s)=>(t.linelength=s[i].getTotalLength()-2,t.target.layer<=this.previousMinNodeLayer||t.source.layer>=this.previousMaxNodeLayer?"":t.linelength+" "+t.linelength))).attr("stroke-dashoffset",(t=>t.target.layer<=this.previousMinNodeLayer||t.source.layer>=this.previousMaxNodeLayer?0:t.linelength)).attr("stroke-width",(t=>t.target.layer<=this.previousMinNodeLayer||t.source.layer>=this.previousMaxNodeLayer?Math.max(1,t.width):.1)).attr("stroke-opacity",t).transition("enter").duration(this.duration).ease(c).attr("d","vertical"===this.layout?yt():mt()).attr("stroke-width",(t=>t.target.layer<=this.previousMinNodeLayer||t.source.layer>=this.previousMaxNodeLayer?Math.max(1,t.width):1)).attr("stroke-dashoffset",0)}updateLinkGeometries(){this.updateLinks.interrupt();const t=this.linkConfig.visible?this.linkConfig.opacity:0;this.updateLinks.transition("opacity").ease(c).duration(this.duration).attr("stroke-opacity",(i=>X(i.data,t,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)))}exitLinkGeometries(){this.exitLinks.interrupt();const t=this.linkConfig.visible?this.linkConfig.opacity:0;this.exitLinks.attr("stroke-dasharray",((t,i,s)=>(t.linelength=s[i].getTotalLength(),t.target.layer<=this.previousMinNodeLayer||t.source.layer>=this.previousMaxNodeLayer?"":t.linelength+" "+t.linelength))).transition("exit").ease(c).duration(this.duration).attr("d","vertical"===this.layout?this.newColumnInterpolationPositionVertical():this.newColumnInterpolationPosition()).attr("stroke-opacity",t).attr("stroke-dashoffset",(t=>t.linelength)).attr("stroke-width",(t=>t.target.layer<=this.currentMinNodeLayer||t.source.layer>=this.currentMaxNodeLayer?Math.max(1,t.width):.1)).remove()}drawLinkGeometries(){this.removeTemporaryClickedLinks(this.svg.node()),"source"!==this.innerLinkFillMode&&"target"!==this.innerLinkFillMode||this.updateLinkGroups.classed("link-group offset-target",!0),this.updateLinks.transition("update").duration(this.duration).ease(c).attr("d","vertical"===this.layout?yt():mt()).attr("stroke-width",(t=>Math.max(1,t.width))).call(B,(()=>{this.removeTemporaryClickedLinks(this.svg.node()),this.updateLinks.classed("entering",!1).attr("d","vertical"===this.layout?yt():mt()).attr("stroke-dasharray",""),this.updateInteractionState(),this.updateLinks.each(((t,i,s)=>{this.clickHighlight&&this.clickHighlight.length>0&&Q(t.data,this.clickHighlight,this.innerInteractionKeys)&&this.drawDuplicateClickedLink(s[i],t)}))})),this.updateLinks.transition("accessibilityAfterExit").duration(this.duration).ease(c).call(B,(()=>{const t=$(this.rootG.node());this.exitLinks.remove(),this.setChartCountAccessibility(),this.setGroupAccessibilityID(),this.setGeometryAriaLabels(),q({parentGNode:this.rootG.node(),focusDidExist:t}),this.transitionEndEvent.emit({chartID:this.chartID})}))}drawDuplicateClickedLink(t,i){const s="vcl-accessibility-focus",h=t.parentNode,e=t.cloneNode();if(l(e).classed("alluvial-link",!1).classed(s+"-highlight "+s+"-hover",!0).classed("duplicated-clicked-link",!0).classed("entering",!1).data([i.data]).attr("focusable",!1).attr("aria-label",null).attr("aria-hidden",!0).attr("role",null).style("pointer-events","none").attr("tabindex",null),"source"===this.innerLinkFillMode||"target"===this.innerLinkFillMode){const t=l(h.parentNode).selectAll(".link-group")._groups[0];t[t.length-1].appendChild(e)}else h.appendChild(e)}removeTemporaryClickedLinks(t){l(t).selectAll(".duplicated-clicked-link").remove()}updateLinkStyle(){this.updateLinks.attr("stroke",(t=>this.clickHighlight.length>0&&Q(t.data,this.clickHighlight,this.innerInteractionKeys)&&this.clickStyle.color?kt[this.clickStyle.color]||this.clickStyle.color:this.hoverHighlight&&lt(t.data,this.hoverHighlight,this.innerInteractionKeys)&&this.hoverStyle.color?kt[this.hoverStyle.color]||this.hoverStyle.color:"group"===this.innerLinkFillMode?this.colorArr[this.groupKeys.indexOf(t[this.groupAccessor])]:"none"===this.innerLinkFillMode?this.colorArr[0]||"#E4E4E4":"link"===this.innerLinkFillMode?this.colorArr[t.index]:"source"===this.innerLinkFillMode?this.colorArr[t.source.index]:this.colorArr[t.target.index])).attr("fill","none")}enterNodeGeometries(){this.enterNodes.interrupt(),this.defaults||this.enterNodes.classed("entering",!0),this.enterNodes.select(".alluvial-node").attr("fill",((t,i)=>this.nodeConfig.fill?this.colorArr[i]||this.colorArr[0]:"#E4E4E4")).attr("stroke",((t,i)=>at(this.nodeConfig.fill?this.colorArr[i]||this.colorArr[0]:"#E4E4E4"))).attr("stroke-width","1px").attr("x",(t=>t.x0)).attr("y",(t=>t.y0)).attr("height",(t=>t.y1-t.y0)).attr("opacity",0).attr("width",(t=>t.x1-t.x0))}updateNodeGeometries(){this.updateNodes.interrupt(),this.updateNodes.select(".alluvial-node").transition("node_opacity").duration(((t,i,s)=>l(s[i].parentNode).classed("entering")?this.duration/3:0)).delay(((t,i,s)=>l(s[i].parentNode).classed("entering")?this.duration/1.2:0)).ease(c).attr("opacity",1)}exitNodeGeometries(){this.exitNodes.interrupt(),this.exitNodes.select(".alluvial-node").transition("exit").ease(c).duration(this.duration/3).attr("opacity",0).attr("width",0).select((function(){return this.parentNode})).remove()}drawNodeGeometries(){this.updateNodes.select(".alluvial-node").transition("update_nodes").duration(((t,i,s)=>l(s[i].parentNode).classed("entering")?this.duration/3:this.duration)).delay(((t,i,s)=>l(s[i].parentNode).classed("entering")?this.duration/1.2:0)).ease(c).attr("x",(t=>t.x0)).attr("y",(t=>t.y0)).attr("height",(t=>t.y1-t.y0)).attr("width",(t=>t.x1-t.x0)).attr("opacity",1).call(B,(()=>{this.updateNodes.classed("entering",!1)}))}updateNodeStyle(){this.updateNodes.select(".alluvial-node").attr("fill",((t,i)=>this.nodeConfig.fill?this.colorArr[i]||this.colorArr[0]:"#E4E4E4")),this.updateNodes.select(".alluvial-node").attr("stroke",((t,i)=>at(this.nodeConfig.fill?this.colorArr[i]||this.colorArr[0]:"#E4E4E4"))),this.updateNodes.select(".alluvial-node").attr("stroke-width","1px")}placeNodeLabels({root:t,layout:i,dataLabel:s,innerPaddedWidth:h}){let e,a,o,l,n;if("vertical"===i)switch(s.placement){case"outside":e=t=>t.x0+(t.x1-t.x0)/2,a=t=>t.y0<h/2?t.y0:t.y1,o="0.0em",l=t=>t.y0<h/2?"-0.5em":"1.3em",n="middle";break;case"on-node":e=t=>t.x0+(t.x1-t.x0)/2,a=t=>t.y0+(t.y1-t.y0)/2,o="0.0em",l="0.4em",n="middle";break;default:e=t=>t.x0+(t.x1-t.x0)/2,a=t=>t.y0<h/2?t.y1:t.y0,o="0.0em",l=t=>t.y0<h/2?"1.3em":"-0.5em",n="middle"}else switch(s.placement){case"outside":e=t=>t.x0<h/2?t.x0:t.x1,a=t=>t.y0+(t.y1-t.y0)/2,o=t=>t.x0<h/2?"-0.5em":"0.5em",l="0.4em",n=t=>t.x0<h/2?"end":"start";break;case"on-node":e=t=>t.x0+(t.x1-t.x0)/2,a=t=>t.y0+(t.y1-t.y0)/2,o="0.0em",l="0.4em",n="middle";break;default:e=t=>t.x0<h/2?t.x1:t.x0,a=t=>t.y0+(t.y1-t.y0)/2,o=t=>t.x0<h/2?"0.5em":"-0.5em",l="0.4em",n=t=>t.x0<h/2?"start":"end"}t.attr("x",e).attr("y",a).attr("dx",o).attr("dy",l).attr("data-dx",o).attr("data-dy",l).attr("text-anchor",n)}enterNodeLabels(){this.enteringLabels.interrupt();const t=this.dataLabel.visible?1:0,i=this.dataLabel.visible?Number.EPSILON:0;this.widthAllNodesNoLinks=this.nodeCount*this.nodeConfig.width+this.nodeCount*this.nodeConfig.width,this.noLinksLeftPadding=(this.innerPaddedWidth-this.widthAllNodesNoLinks)/2,this.enteringLabels.attr("class","alluvial-diagram-dataLabel entering").attr("cursor",!this.suppressEvents&&this.dataLabel.visible?this.cursor:null).attr("opacity",(s=>{if(this.linkConfig.visible){let h=!0;return s[this.sourceLinksString].length&&(h=s[this.sourceLinksString].some((i=>X(i.data,t,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)>=1))),s[this.targetLinksString].length&&(h=s[this.targetLinksString].some((i=>X(i.data,t,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)>=1))),h?i:0}return 0===s.layer||s.layer===this.nodeCount?i:0})),this.placeNodeLabels({root:this.enteringLabels,layout:this.layout,dataLabel:this.dataLabel,innerPaddedWidth:this.innerPaddedWidth})}updateNodeLabels(){this.updatingLabels.interrupt("label_opacity");const t=this.dataLabel.visible?1:0;this.updatingLabels.transition("label_opacity").ease(c).duration(((t,i,s)=>l(s[i]).classed("entering")?this.duration/3:0)).delay(((t,i,s)=>l(s[i]).classed("entering")?this.duration/1.2:0)).attr("opacity",(i=>{if(this.linkConfig.visible){let s=!0;return i[this.sourceLinksString].length&&(s=i[this.sourceLinksString].some((i=>X(i.data,t,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)>=1))),i[this.targetLinksString].length&&(s=i[this.targetLinksString].some((i=>X(i.data,t,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)>=1))),s?1:0}return 0===i.layer||i.layer===this.nodeCount?t:0}))}exitNodeLabels(){this.exitingLabels.interrupt(),this.exitingLabels.transition("exit_labels").duration(this.duration/3).ease(c).attr("opacity",0).remove()}addStrokeUnder(){const t=Z({root:this.svg.node(),id:this.chartID,color:"#ffffff"});this.updatingLabels.attr("filter",t)}drawNodeLabels(){const t="auto"!==this.dataLabel.placement&&this.dataLabel.collisionHideOnly,i=t?0:4;this.widthAllNodesNoLinks=this.nodeCount*this.nodeConfig.width*2,this.noLinksLeftPadding=(this.innerPaddedWidth-this.widthAllNodesNoLinks)/2;const s=this.updatingLabels.text((t=>this.dataLabel.format?st(t,this.innerLabelAccessor,this.dataLabel.format):t[this.innerLabelAccessor])).attr("data-x",(t=>"vertical"===this.layout?t.x0+(t.x1-t.x0)/2:"outside"===this.dataLabel.placement?t.x0<this.innerPaddedWidth/2?t.x0-i:t.x1+i:t.x0<this.innerPaddedWidth/2?t.x1+i:t.x0-i)).attr("data-y",(t=>"vertical"===this.layout?"outside"===this.dataLabel.placement?t.y0<this.innerPaddedWidth/2?t.y0-i:t.y1+i:t.y0<this.innerPaddedWidth/2?t.y1+i:t.y0-i:t.y0+(t.y1-t.y0)/2)).attr("data-translate-x",this.padding.left+this.margin.left).attr("data-translate-y",this.padding.top+this.margin.top).attr("data-use-dx",t).attr("data-use-dy",t).transition("update_labels").duration(((t,i,s)=>l(s[i]).classed("entering")?this.duration/3:this.duration)).delay(((t,i,s)=>l(s[i]).classed("entering")?this.duration/1.2:0)).ease(c);if(this.dataLabel.visible&&("auto"===this.dataLabel.placement||this.dataLabel.collisionHideOnly)){const h=this.dataLabel&&this.dataLabel.collisionPlacement,e=this.updateNodes.select(".alluvial-node").attr("data-x",(t=>t.x0)).attr("data-y",(t=>t.y0)).attr("data-translate-x",this.padding.left+this.margin.left).attr("data-translate-y",this.padding.top+this.margin.top).attr("data-height",(t=>t.y1-t.y0)).attr("data-width",(t=>t.x1-t.x0)).each(((s,e,a)=>{if(!t){const t=a[e],o=t.parentNode,n="alluvial-node-collision-clone",r=t.cloneNode();l(r).classed("alluvial-node",!1).classed(n,!0).classed("entering",!1).data([s]).attr("focusable",!1).attr("aria-label",null).attr("aria-hidden",!0).attr("role",null).style("pointer-events","none").style("visibility","hidden").attr("tabindex",null).attr("data-x","vertical"===this.layout||"all"===h?s.x0:"outside"===h?s.x0<this.innerPaddedWidth/2?s.x0-i:s.x1+i:s.x0<this.innerPaddedWidth/2?s.x1+i:s.x0-i).attr("data-y","vertical"===this.layout?"all"===h?s.y0:"outside"===h?s.y0<this.innerPaddedWidth/2?s.y0-i:s.y1+i:s.y0<this.innerPaddedWidth/2?s.y1+i:s.y0-i:s.y0).attr("data-width","vertical"===this.layout||"all"===h?s.x1-s.x0:1).attr("data-height","vertical"===this.layout?"all"===h?s.y1-s.y0:1:s.y1-s.y0),o.appendChild(r)}})),a=this.updateNodes.select(".alluvial-node-collision-clone");this.bitmaps=U({labelSelection:s,avoidMarks:t?[e]:[e,a],validPositions:t?["middle"]:"vertical"===this.layout?["top","bottom"]:["left","right"],offsets:t?[1]:[4,4],accessors:[this.innerIDAccessor],size:[R(this.width,0),R(this.height,0)],hideOnly:this.dataLabel.visible&&t}),a.remove(),t&&this.placeNodeLabels({root:s,layout:this.layout,dataLabel:this.dataLabel,innerPaddedWidth:this.innerPaddedWidth})}else this.placeNodeLabels({root:s,layout:this.layout,dataLabel:this.dataLabel,innerPaddedWidth:this.innerPaddedWidth});s.call(B,(()=>{this.updatingLabels.classed("entering",!1),this.addStrokeUnder()}))}setNodeLabelOpacity(){this.updatingLabels.interrupt("label_opacity");const t="auto"!==this.dataLabel.placement&&this.dataLabel.collisionHideOnly,i=t?0:4,s=this.dataLabel.visible&&("auto"===this.dataLabel.placement||this.dataLabel.collisionHideOnly),h=this.dataLabel.visible?1:0;if(this.updatingLabels.attr("opacity",((t,i,e)=>{const a=+l(e[i]).attr("opacity"),o=l(e[i]).style("visibility");let n;if(this.linkConfig.visible){let i=!0;t[this.sourceLinksString].length&&(i=t[this.sourceLinksString].some((t=>X(t.data,h,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)>=1))),t[this.targetLinksString].length&&(i=t[this.targetLinksString].some((t=>X(t.data,h,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)>=1))),n=i?h:0}else n=0===t.layer||t.layer===this.nodeCount?h:0;return(1===n&&"hidden"===o||a!==n)&&s&&(1===n?l(e[i]).classed("collision-added",!0).style("visibility",null):l(e[i]).classed("collision-removed",!0)),n})),s){const s=this.updatingLabels.filter(((t,i,s)=>l(s[i]).classed("collision-added"))),h=this.updatingLabels.filter(((t,i,s)=>l(s[i]).classed("collision-removed"))).attr("data-use-dx",t).attr("data-use-dy",t);if(h.size()>0&&(this.bitmaps=U({bitmaps:this.bitmaps,labelSelection:h,avoidMarks:[],validPositions:["middle"],offsets:[1],accessors:["key"],size:[R(this.width,0),R(this.height,0)],hideOnly:!1,removeOnly:!0}),h.classed("collision-removed",!1)),s.size()>0){const h=this.dataLabel&&this.dataLabel.collisionPlacement,e=this.updateNodes.select(".alluvial-node").attr("data-x",(t=>t.x0)).attr("data-y",(t=>t.y0)).attr("data-translate-x",this.padding.left+this.margin.left).attr("data-translate-y",this.padding.top+this.margin.top).attr("data-height",(t=>t.y1-t.y0)).attr("data-width",(t=>t.x1-t.x0)).each(((s,e,a)=>{if(!t){const t=a[e],o=t.parentNode,n="alluvial-node-collision-clone",r=t.cloneNode();l(r).classed("alluvial-node",!1).classed(n,!0).classed("entering",!1).data([s]).attr("focusable",!1).attr("aria-label",null).attr("aria-hidden",!0).attr("role",null).style("pointer-events","none").style("visibility","hidden").attr("tabindex",null).attr("data-x","vertical"===this.layout||"all"===h?s.x0:"outside"===h?s.x0<this.innerPaddedWidth/2?s.x0-i:s.x1+i:s.x0<this.innerPaddedWidth/2?s.x1+i:s.x0-i).attr("data-y","vertical"===this.layout?"all"===h?s.y0:"outside"===h?s.y0<this.innerPaddedWidth/2?s.y0-i:s.y1+i:s.y0<this.innerPaddedWidth/2?s.y1+i:s.y0-i:s.y0).attr("data-width","vertical"===this.layout||"all"===h?s.x1-s.x0:1).attr("data-height","vertical"===this.layout?"all"===h?s.y1-s.y0:1:s.y1-s.y0),o.appendChild(r)}})),a=this.updateNodes.select(".alluvial-node-collision-clone");this.bitmaps=U({labelSelection:s,bitmaps:this.bitmaps,avoidMarks:t?[e]:[e,a],validPositions:t?["middle"]:"vertical"===this.layout?["top","bottom"]:["left","right"],offsets:t?[1]:[4,4],accessors:[this.innerIDAccessor],size:[R(this.width,0),R(this.height,0)],hideOnly:this.dataLabel.visible&&t,suppressMarkDraw:!0}),a.remove(),t&&this.placeNodeLabels({root:s,layout:this.layout,dataLabel:this.dataLabel,innerPaddedWidth:this.innerPaddedWidth}),s.classed("collision-added",!1)}}}updateInteractionState(){this.removeTemporaryClickedLinks(this.svg.node()),this.updateLinks.interrupt("opacity");const t=this.linkConfig.visible?this.linkConfig.opacity:0;this.updateLinks.attr("stroke-opacity",(i=>X(i.data,t,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys))).attr("stroke",(t=>this.clickHighlight.length>0&&Q(t.data,this.clickHighlight,this.innerInteractionKeys)&&this.clickStyle.color?kt[this.clickStyle.color]||this.clickStyle.color:this.hoverHighlight&&lt(t.data,this.hoverHighlight,this.innerInteractionKeys)&&this.hoverStyle.color?kt[this.hoverStyle.color]||this.hoverStyle.color:"group"===this.innerLinkFillMode?this.colorArr[this.groupKeys.indexOf(t[this.groupAccessor])]:"none"===this.innerLinkFillMode?this.colorArr[0]||"#E4E4E4":"link"===this.innerLinkFillMode?this.colorArr[t.index]:"source"===this.innerLinkFillMode?this.colorArr[t.source.index]:this.colorArr[t.target.index])),this.updateLinks.each(((t,i,s)=>{this.clickHighlight&&this.clickHighlight.length>0&&Q(t.data,this.clickHighlight,this.innerInteractionKeys)&&this.drawDuplicateClickedLink(s[i],t)}))}bindInteractivity(){this.updateLinks.on("click",this.suppressEvents?null:(t,i,s)=>this.onClickHandler(t,s[i])).on("mouseover",this.suppressEvents?null:(t,i,s)=>this.onHoverHandler(t,s[i])).on("mouseout",this.suppressEvents?null:()=>this.onMouseOutHandler())}drawAnnotations(){const t=this.preppedData,i=[];this.annotations.forEach((s=>{const h=Object.assign({},s);let e=s.data;if(t&&e)if("node"===h.positionType&&h.data.hasOwnProperty(this.innerIDAccessor)){const i=t.nodes.findIndex((t=>t[this.innerIDAccessor]===h.data[this.innerIDAccessor]));e=t.nodes[i]}else if("source"===h.positionType||"target"===h.positionType&&h.data.hasOwnProperty(this.sourceAccessor)&&h.data.hasOwnProperty(this.targetAccessor)){const i=t.links.findIndex((t=>t.data[this.sourceAccessor]===h.data[this.sourceAccessor]&&t.data[this.targetAccessor]===h.data[this.targetAccessor]));e=t.links[i]}h.positionType&&e&&("target"===h.positionType&&e.target?(h.x=e.target.x0,h.y=e.y1):"source"===h.positionType&&e.source?(h.x=e.source.x1,h.y=e.y0):"node"===h.positionType&&(h.x=e.x1,h.y=(e.y1+e.y0)/2)),delete h.data,i.push(h)})),J({source:this.rootG.node(),data:i,ignoreScales:!0,width:this.width,height:this.height,padding:this.padding,margin:this.margin,bitmaps:this.bitmaps})}setSubTitleElements(){wt({root:this.subTitleG,subTitle:this.subTitle})}setColors(){this.colorArr=this.colors?Y(this.colors):et(this.colorPalette,this.nodeList.length)}setTagLevels(){this.topLevel=it(this.highestHeadingLevel),this.bottomLevel=it(this.highestHeadingLevel,3)}setChartDescriptionWrapper(){T({language:this.getLanguageString(),rootEle:this.alluvialDiagramEl,title:this.accessibility.title||this.mainTitle,chartTag:"alluvial-diagram",uniqueID:this.chartID,highestHeadingLevel:this.highestHeadingLevel,redraw:this.shouldRedrawWrapper,disableKeyNav:this.suppressEvents&&!1===this.accessibility.elementsAreInterface&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled,hideDataTable:this.accessibility.hideDataTableButton}),this.shouldRedrawWrapper=!1}setParentSVGAccessibility(){const t=ct(this,dt,"alluvial-diagram");C({language:this.getLanguageString(),node:this.svg.node(),chartTag:"alluvial-diagram",title:this.accessibility.title||this.mainTitle,description:this.subTitle,uniqueID:this.chartID,geomType:"link",includeKeyNames:this.accessibility.includeDataKeyNames,dataKeys:t,dataKeyNames:this.dataKeyNames,groupAccessor:this.innerIDAccessor,groupKeys:["value"],groupName:"node",disableKeyNav:this.suppressEvents&&!1===this.accessibility.elementsAreInterface&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled})}setGeometryAccessibilityAttributes(){this.updateLinks.each(((t,i,s)=>{D(s[i])}))}setGeometryAriaLabels(){const t=ct(this,dt,"alluvial-diagram");this.updateLinks.each(((i,s,h)=>{E({node:h[s],geomType:"link",includeKeyNames:this.accessibility.includeDataKeyNames,dataKeys:t,dataKeyNames:this.dataKeyNames,groupName:"node",uniqueID:this.chartID,disableKeyNav:this.suppressEvents&&!1===this.accessibility.elementsAreInterface&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled}),S({node:h[s],uniqueID:this.chartID})}))}setGroupAccessibilityID(){this.updateNodes.each(((t,i,s)=>{S({node:s[i],uniqueID:this.chartID})}))}setChartCountAccessibility(){N({rootEle:this.alluvialDiagramEl,parentGNode:this.linkG.node(),chartTag:"alluvial-diagram",geomType:"link",groupName:"node"})}setSelectedClass(){this.updateLinks.classed("highlight",(t=>{const i=X(t.data,!0,!1,"",this.clickHighlight,this.innerInteractionKeys);return!(!this.clickHighlight||!this.clickHighlight.length)&&i})).each(((t,i,s)=>{let h=X(t.data,!0,!1,"",this.clickHighlight,this.innerInteractionKeys);h=!(!this.clickHighlight||!this.clickHighlight.length)&&h,V(s[i],h,this.accessibility.elementsAreInterface)}))}setChartAccessibilityTitle(){j(this.getLanguageString(),this.alluvialDiagramEl,this.accessibility.title||this.mainTitle)}setChartAccessibilitySubtitle(){P(this.getLanguageString(),this.alluvialDiagramEl,this.subTitle)}setChartAccessibilityLongDescription(){O(this.getLanguageString(),this.alluvialDiagramEl,this.accessibility.longDescription)}setChartAccessibilityExecutiveSummary(){z(this.getLanguageString(),this.alluvialDiagramEl,this.accessibility.executiveSummary)}setChartAccessibilityPurpose(){G(this.getLanguageString(),this.alluvialDiagramEl,this.accessibility.purpose)}setChartAccessibilityContext(){K(this.getLanguageString(),this.alluvialDiagramEl,this.accessibility.contextExplanation)}setChartAccessibilityStatisticalNotes(){H(this.getLanguageString(),this.alluvialDiagramEl,this.accessibility.statisticalNotes)}setChartAccessibilityStructureNotes(){M(this.getLanguageString(),this.alluvialDiagramEl,this.accessibility.structureNotes)}setAnnotationAccessibility(){_(this.getLanguageString(),this.alluvialDiagramEl,this.annotations,void 0)}onChangeHandler(){this.accessibility&&"function"==typeof this.accessibility.onChangeFunc&&this.accessibility.onChangeFunc({updated:this.updated,added:this.enterSize,removed:this.exitSize}),this.updated=!1,this.enterSize=0,this.exitSize=0}onClickHandler(t,i){this.clickEvent.emit({data:t.data,target:i})}onHoverHandler(t,i){rt(this.chartID,!0),this.hoverEvent.emit({data:t.data,target:i}),this.showTooltip&&this.eventsTooltip({data:t.data,evt:n,isToShow:!0})}onMouseOutHandler(){rt(this.chartID,!1),this.mouseOutEvent.emit(),this.showTooltip&&this.eventsTooltip({isToShow:!1})}setTooltipInitialStyle(){nt(this.tooltipG)}eventsTooltip({data:t,evt:i,isToShow:s}){tt({root:this.tooltipG,data:t,event:i,isToShow:s,tooltipLabel:this.tooltipLabel,dataKeyNames:this.dataKeyNames,groupAccessor:this.groupAccessor,xAccessor:this.sourceAccessor,yAccessor:this.targetAccessor,valueAccessor:this.valueAccessor,ordinalAccessor:this.innerIDAccessor,chartType:"alluvial-diagram"})}render(){return this.drawStartEvent.emit({chartID:this.chartID}),this.init(),this.shouldSetLocalizationConfig&&(this.setLocalizationConfig(),this.shouldSetLocalizationConfig=!1),this.shouldSetTagLevels&&(this.setTagLevels(),this.shouldSetTagLevels=!1),this.shouldUpdateData&&(this.prepareData(),this.shouldUpdateData=!1),this.shouldSetDimensions&&(this.setDimensions(),this.shouldSetDimensions=!1),this.shouldValidateLabelText&&(this.validateLabelText(),this.shouldValidateLabelText=!1),this.shouldValidateLinkFillMode&&(this.validateLinkFillMode(),this.shouldValidateLinkFillMode=!1),this.shouldValidateNodeAlignment&&(this.validateNodeAlignment(),this.shouldValidateNodeAlignment=!1),this.shouldValidateInteractionKeys&&(this.validateInteractionKeys(),this.shouldValidateInteractionKeys=!1),this.shouldValidateLinkGroups&&(this.validateLinkGroups(),this.shouldValidateLinkGroups=!0),this.shouldValidateLocalization&&(this.shouldValidateLocalizationProps(),this.shouldValidateLocalization=!1),this.shouldValidateAccessibility&&(this.shouldValidateAccessibilityProps(),this.shouldValidateAccessibility=!1),this.shouldSetColors&&(this.setColors(),this.shouldSetColors=!1),this.shouldValidateIdAccessor&&(this.validateIdAccessor(),this.shouldValidateIdAccessor=!1),this.shouldSetNodeDimensions&&(this.setNodeDimensions(),this.shouldSetNodeDimensions=!1),this.shouldCallSankeyGenerator&&(this.callSankeyGenerator(),this.shouldCallSankeyGenerator=!1),this.shouldUpdateTableData&&(this.setTableData(),this.shouldUpdateTableData=!1),s("div",null,s("div",{class:"o-layout"},s("div",{class:"o-layout--chart"},s(this.topLevel,{class:"alluvial-main-title vcl-main-title"},this.mainTitle),s(this.bottomLevel,{class:"visa-ui-text--instructions alluvial-sub-title vcl-sub-title"}),s("keyboard-instructions",{uniqueID:this.chartID,geomType:"node",groupName:"node collection",language:this.getLanguageString(),chartTag:"alluvial-diagram",width:this.width-(this.margin&&this.margin.right||0),isInteractive:this.accessibility.elementsAreInterface,hasCousinNavigation:"source"===this.innerLinkFillMode||"target"===this.innerLinkFillMode,disabled:this.suppressEvents&&!1===this.accessibility.elementsAreInterface&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled}),s("div",{class:"visa-viz-d3-alluvial-container"}),s("div",{class:"alluvial-tooltip vcl-tooltip",style:{display:this.showTooltip?"block":"none"}}),s("data-table",{uniqueID:this.chartID,isCompact:!0,language:this.getLanguageString(),tableColumns:this.tableColumns,dataKeyNames:this.dataKeyNames,data:this.tableData,secondaryData:this.secondaryTableData,secondaryTableColumns:this.secondaryTableColumns,padding:this.padding,margin:this.margin,hideDataTable:this.accessibility.hideDataTableButton,unitTest:this.unitTest}))))}init(){const t=Object.keys(W);let i=0;const s={hoverOpacity:{exception:0},showTooltip:{exception:!1},mainTitle:{exception:""},subTitle:{exception:""},linkConfig:Object.assign({exception:!1})};for(i=0;i<t.length;i++)this[t[i]]=this[t[i]]||s[t[i]]&&this[t[i]]===s[t[i]].exception?this[t[i]]:W[t[i]]}get alluvialDiagramEl(){return h(this)}static get watchers(){return{nodeData:["dataWatcher"],linkData:["dataWatcher"],uniqueID:["idWatcher"],highestHeadingLevel:["headingWatcher"],mainTitle:["mainTitleWatcher"],subTitle:["subTitleWatcher"],height:["dimensionWatcher"],width:["dimensionWatcher"],padding:["dimensionWatcher"],margin:["dimensionWatcher"],layout:["layoutWatcher"],sourceAccessor:["sourceAccessorWatcher"],targetAccessor:["targetAccessorWatcher"],valueAccessor:["valueAccessorWatcher"],groupAccessor:["groupAccessorWatcher"],nodeIDAccessor:["nodeIDAccessorWatcher"],nodeConfig:["nodeConfigWatcher"],linkConfig:["linkConfigWatcher"],colors:["colorWatcher"],colorPalette:["colorWatcher"],clickStyle:["interactionStyleWatcher"],hoverStyle:["interactionStyleWatcher"],cursor:["cursorWatcher"],hoverOpacity:["hoverOpacityWatcher"],dataLabel:["dataLabelWatcher"],tooltipLabel:["tooltipLabelWatcher"],showTooltip:["showTooltipWatcher"],accessibility:["accessibilityWatcher"],localization:["localizationWatcher"],annotations:["annotationsWatcher"],clickHighlight:["clickWatcher"],hoverHighlight:["hoverWatcher"],interactionKeys:["interactionWatcher"],dataKeyNames:["dataKeyNamesWatcher"],suppressEvents:["suppressWatcher"],unitTest:["unitTestWatcher"]}}};xt.style=".o-layout{width:100%;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.o-layout--chart{width:100%}.is--vertical .o-layout--chart{width:90%}alluvial-diagram{cursor:default}alluvial-diagram .vcl-sub-title-keyword{-webkit-padding-before:1px;padding:3px 6px 1px 6px}alluvial-diagram .annotations{pointer-events:none}alluvial-diagram .annotations .handle{pointer-events:all}alluvial-diagram .screen-reader-info{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}alluvial-diagram .data-table-link{color:#767676;text-decoration:none;font-size:12px;margin-left:5%}alluvial-diagram .hidden{display:none}alluvial-diagram .node rect{cursor:move}alluvial-diagram .node text{pointer-events:none;text-shadow:0 1px 0 #fff}alluvial-diagram .link{fill:none;stroke:#000;stroke-opacity:0.2}alluvial-diagram .link:hover{stroke-opacity:0.5}";export{xt as alluvial_diagram}