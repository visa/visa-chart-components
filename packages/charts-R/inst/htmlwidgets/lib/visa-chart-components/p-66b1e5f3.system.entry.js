/**
 * Copyright (c) 2023 Visa, Inc.
 *
 * This source code is licensed under the MIT license
 * https://github.com/visa/visa-chart-components/blob/master/LICENSE
 *
 **/
var __spreadArray=this&&this.__spreadArray||function(t,e,i){if(i||arguments.length===2)for(var s=0,r=e.length,a;s<r;s++){if(a||!(s in e)){if(!a)a=Array.prototype.slice.call(e,0,s);a[s]=e[s]}}return t.concat(a||Array.prototype.slice.call(e))};System.register(["./p-6345a0d3.system.js","./p-577a162e.system.js","./p-36d0ec22.system.js","./p-0ba4eed5.system.js"],(function(t){"use strict";var e,i,s,r,a,o,n,l,c;return{setters:[function(t){e=t.r;i=t.c;s=t.h;r=t.g},function(t){a=t.v;o=t.s;n=t.e},function(t){l=t.m},function(t){c=t.v}],execute:function(){var h=a.propDefaultValues;var u=function(){function t(){}return t}();u.mainTitle="Circle Packing Title";u.subTitle="This is the circle packing chart's subtitle";u.height=400;u.width=400;u.circlePadding=5;u.margin={top:400*.01,bottom:400*.01,right:400*.01,left:400*.01};u.padding={top:400*.01,bottom:400*.01,right:400*.01,left:400*.01};u.dataDepth=5;u.displayDepth=2;u.parentAccessor="parentNode";u.nodeAccessor="childNode";u.sizeAccessor="value";u.colorPalette=h.colorPaletteSequentialGrey;u.dataLabel=h.dataLabelCenter;u.hoverStyle=h.hoverStyle;u.clickStyle=h.clickStyle;u.hoverOpacity=h.hoverOpacity;u.cursor=h.cursor;u.interactionKeys=h.interactionKeys;u.highestHeadingLevel=h.highestHeadingLevel;u.annotations=h.annotations;u.accessibility=h.accessibility;u.animationConfig=h.animationConfig;u.tooltipLabel=h.tooltipLabel;u.showTooltip=h.showTooltip;u.clickHighlight=h.clickHighlight;u.suppressEvents=h.suppressEvents;function d(t){var e=0,i=t.children,s=i&&i.length;if(!s)e=1;else while(--s>=0)e+=i[s].value;t.value=e}function p(){return this.eachAfter(d)}function f(t){var e=this,i,s=[e],r,a,o;do{i=s.reverse(),s=[];while(e=i.pop()){t(e),r=e.children;if(r)for(a=0,o=r.length;a<o;++a){s.push(r[a])}}}while(s.length);return this}function y(t){var e=this,i=[e],s,r;while(e=i.pop()){t(e),s=e.children;if(s)for(r=s.length-1;r>=0;--r){i.push(s[r])}}return this}function v(t){var e=this,i=[e],s=[],r,a,o;while(e=i.pop()){s.push(e),r=e.children;if(r)for(a=0,o=r.length;a<o;++a){i.push(r[a])}}while(e=s.pop()){t(e)}return this}function g(t){return this.eachAfter((function(e){var i=+t(e.data)||0,s=e.children,r=s&&s.length;while(--r>=0)i+=s[r].value;e.value=i}))}function b(t){return this.eachBefore((function(e){if(e.children){e.children.sort(t)}}))}function m(t){var e=this,i=S(e,t),s=[e];while(e!==i){e=e.parent;s.push(e)}var r=s.length;while(t!==i){s.splice(r,0,t);t=t.parent}return s}function S(t,e){if(t===e)return t;var i=t.ancestors(),s=e.ancestors(),r=null;t=i.pop();e=s.pop();while(t===e){r=t;t=i.pop();e=s.pop()}return r}function A(){var t=this,e=[t];while(t=t.parent){e.push(t)}return e}function C(){var t=[];this.each((function(e){t.push(e)}));return t}function x(){var t=[];this.eachBefore((function(e){if(!e.children){t.push(e)}}));return t}function D(){var t=this,e=[];t.each((function(i){if(i!==t){e.push({source:i.parent,target:i})}}));return e}function w(t,e){var i=new E(t),s=+t.value&&(i.value=t.value),r,a=[i],o,n,l,c;if(e==null)e=T;while(r=a.pop()){if(s)r.value=+r.data.value;if((n=e(r.data))&&(c=n.length)){r.children=new Array(c);for(l=c-1;l>=0;--l){a.push(o=r.children[l]=new E(n[l]));o.parent=r;o.depth=r.depth+1}}}return i.eachBefore(I)}function k(){return w(this).eachBefore(L)}function T(t){return t.children}function L(t){t.data=t.data.data}function I(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function E(t){this.data=t;this.depth=this.height=0;this.parent=null}E.prototype=w.prototype={constructor:E,count:p,each:f,eachAfter:v,eachBefore:y,sum:g,sort:b,path:m,ancestors:A,descendants:C,leaves:x,links:D,copy:k};var N=Array.prototype.slice;function P(t){var e=t.length,i,s;while(e){s=Math.random()*e--|0;i=t[e];t[e]=t[s];t[s]=i}return t}function W(t){var e=0,i=(t=P(N.call(t))).length,s=[],r,a;while(e<i){r=t[e];if(a&&U(a,r))++e;else a=K(s=z(s,r)),e=0}return a}function z(t,e){var i,s;if(H(e,t))return[e];for(i=0;i<t.length;++i){if(G(e,t[i])&&H(V(t[i],e),t)){return[t[i],e]}}for(i=0;i<t.length-1;++i){for(s=i+1;s<t.length;++s){if(G(V(t[i],t[s]),e)&&G(V(t[i],e),t[s])&&G(V(t[s],e),t[i])&&H(O(t[i],t[s],e),t)){return[t[i],t[s],e]}}}throw new Error}function G(t,e){var i=t.r-e.r,s=e.x-t.x,r=e.y-t.y;return i<0||i*i<s*s+r*r}function U(t,e){var i=t.r-e.r+1e-6,s=e.x-t.x,r=e.y-t.y;return i>0&&i*i>s*s+r*r}function H(t,e){for(var i=0;i<e.length;++i){if(!U(t,e[i])){return false}}return true}function K(t){switch(t.length){case 1:return R(t[0]);case 2:return V(t[0],t[1]);case 3:return O(t[0],t[1],t[2])}}function R(t){return{x:t.x,y:t.y,r:t.r}}function V(t,e){var i=t.x,s=t.y,r=t.r,a=e.x,o=e.y,n=e.r,l=a-i,c=o-s,h=n-r,u=Math.sqrt(l*l+c*c);return{x:(i+a+l/u*h)/2,y:(s+o+c/u*h)/2,r:(u+r+n)/2}}function O(t,e,i){var s=t.x,r=t.y,a=t.r,o=e.x,n=e.y,l=e.r,c=i.x,h=i.y,u=i.r,d=s-o,p=s-c,f=r-n,y=r-h,v=l-a,g=u-a,b=s*s+r*r-a*a,m=b-o*o-n*n+l*l,S=b-c*c-h*h+u*u,A=p*f-d*y,C=(f*S-y*m)/(A*2)-s,x=(y*v-f*g)/A,D=(p*m-d*S)/(A*2)-r,w=(d*g-p*v)/A,k=x*x+w*w-1,T=2*(a+C*x+D*w),L=C*C+D*D-a*a,I=-(k?(T+Math.sqrt(T*T-4*k*L))/(2*k):L/T);return{x:s+C+x*I,y:r+D+w*I,r:I}}function _(t,e,i){var s=t.x-e.x,r,a,o=t.y-e.y,n,l,c=s*s+o*o;if(c){a=e.r+i.r,a*=a;l=t.r+i.r,l*=l;if(a>l){r=(c+l-a)/(2*c);n=Math.sqrt(Math.max(0,l/c-r*r));i.x=t.x-r*s-n*o;i.y=t.y-r*o+n*s}else{r=(c+a-l)/(2*c);n=Math.sqrt(Math.max(0,a/c-r*r));i.x=e.x+r*s-n*o;i.y=e.y+r*o+n*s}}else{i.x=e.x+i.r;i.y=e.y}}function q(t,e){var i=t.r+e.r-1e-6,s=e.x-t.x,r=e.y-t.y;return i>0&&i*i>s*s+r*r}function Z(t){var e=t._,i=t.next._,s=e.r+i.r,r=(e.x*i.r+i.x*e.r)/s,a=(e.y*i.r+i.y*e.r)/s;return r*r+a*a}function B(t){this._=t;this.next=null;this.previous=null}function M(t){if(!(r=t.length))return 0;var e,i,s,r,a,o,n,l,c,h,u;e=t[0],e.x=0,e.y=0;if(!(r>1))return e.r;i=t[1],e.x=-i.r,i.x=e.r,i.y=0;if(!(r>2))return e.r+i.r;_(i,e,s=t[2]);e=new B(e),i=new B(i),s=new B(s);e.next=s.previous=i;i.next=e.previous=s;s.next=i.previous=e;t:for(n=3;n<r;++n){_(e._,i._,s=t[n]),s=new B(s);l=i.next,c=e.previous,h=i._.r,u=e._.r;do{if(h<=u){if(q(l._,s._)){i=l,e.next=i,i.previous=e,--n;continue t}h+=l._.r,l=l.next}else{if(q(c._,s._)){e=c,e.next=i,i.previous=e,--n;continue t}u+=c._.r,c=c.previous}}while(l!==c.next);s.previous=e,s.next=i,e.next=i.previous=i=s;a=Z(e);while((s=s.next)!==i){if((o=Z(s))<a){e=s,a=o}}i=e.next}e=[i._],s=i;while((s=s.next)!==i)e.push(s._);s=W(e);for(n=0;n<r;++n)e=t[n],e.x-=s.x,e.y-=s.y;return s.r}function F(t){return t==null?null:j(t)}function j(t){if(typeof t!=="function")throw new Error;return t}function $(){return 0}function J(t){return function(){return t}}function Q(t){return Math.sqrt(t.value)}function X(){var t=null,e=1,i=1,s=$;function r(r){r.x=e/2,r.y=i/2;if(t){r.eachBefore(Y(t)).eachAfter(tt(s,.5)).eachBefore(et(1))}else{r.eachBefore(Y(Q)).eachAfter(tt($,1)).eachAfter(tt(s,r.r/Math.min(e,i))).eachBefore(et(Math.min(e,i)/(2*r.r)))}return r}r.radius=function(e){return arguments.length?(t=F(e),r):t};r.size=function(t){return arguments.length?(e=+t[0],i=+t[1],r):[e,i]};r.padding=function(t){return arguments.length?(s=typeof t==="function"?t:J(+t),r):s};return r}function Y(t){return function(e){if(!e.children){e.r=Math.max(0,+t(e)||0)}}}function tt(t,e){return function(i){if(s=i.children){var s,r,a=s.length,o=t(i)*e||0,n;if(o)for(r=0;r<a;++r)s[r].r+=o;n=M(s);if(o)for(r=0;r<a;++r)s[r].r-=o;i.r=n+o}}}function et(t){return function(e){var i=e.parent;e.r*=t;if(i){e.x=i.x+t*e.x;e.y=i.y+t*e.y}}}var it="$",st={depth:-1},rt={};function at(t){return t.id}function ot(t){return t.parentId}function nt(){var t=at,e=ot;function i(i){var s,r,a=i.length,o,n,l,c=new Array(a),h,u,d={};for(r=0;r<a;++r){s=i[r],l=c[r]=new E(s);if((h=t(s,r,i))!=null&&(h+="")){u=it+(l.id=h);d[u]=u in d?rt:l}}for(r=0;r<a;++r){l=c[r],h=e(i[r],r,i);if(h==null||!(h+="")){if(o)throw new Error("multiple roots");o=l}else{n=d[it+h];if(!n)throw new Error("missing: "+h);if(n===rt)throw new Error("ambiguous: "+h);if(n.children)n.children.push(l);else n.children=[l];l.parent=n}}if(!o)throw new Error("no root");o.parent=st;o.eachBefore((function(t){t.depth=t.parent.depth+1;--a})).eachBefore(I);o.parent=null;if(a>0)throw new Error("cycle");return o}i.id=function(e){return arguments.length?(t=j(e),i):t};i.parentId=function(t){return arguments.length?(e=j(t),i):e};return i}var lt='.o-layout{width:100%;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.o-layout--chart{width:100%}.is--vertical .o-layout--chart{width:90%}circle-packing .screen-reader-info{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}circle-packing .annotations{pointer-events:none}circle-packing .annotations .handle{pointer-events:all}circle-packing .label{font:12px "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;text-anchor:middle}circle-packing .label,circle-packing .node--root{pointer-events:none}';var ct=a.getContrastingStroke,ht=a.createTextStrokeFilter,ut=a.convertColorsToTextures,dt=a.initializeElementAccess,pt=a.initializeDescriptionRoot,ft=a.setElementFocusHandler,yt=a.setElementAccessID,vt=a.setAccessibilityController,gt=a.hideNonessentialGroups,bt=a.setAccessTitle,mt=a.setAccessSubtitle,St=a.setAccessLongDescription,At=a.setAccessExecutiveSummary,Ct=a.setAccessPurpose,xt=a.setAccessContext,Dt=a.setAccessStatistics,wt=a.setAccessChartCounts,kt=a.setAccessStructure,Tt=a.setAccessAnnotation,Lt=a.retainAccessFocus,It=a.checkAccessFocus,Et=a.setElementInteractionAccessState,Nt=a.drawTooltip,Pt=a.setAccessibilityDescriptionWidth,Wt=a.annotate,zt=a.getPadding,Gt=a.chartAccessors,Ut=a.checkInteraction,Ht=a.checkClicked,Kt=a.checkHovered,Rt=a.convertVisaColor,Vt=a.getColors,Ot=a.getLicenses,_t=a.getScopedData,qt=a.initTooltipStyle,Zt=a.transitionEndAll,Bt=a.overrideTitleTooltip,Mt=a.roundTo,Ft=a.scopeDataKeys,jt=a.visaColors,$t=a.validateAccessibilityProps,Jt=a.findTagLevel,Qt=a.prepareRenderChange,Xt=a.resolveLabelCollision;var Yt=t("circle_packing",function(){function t(t){var s=this;e(this,t);this.clickEvent=i(this,"clickEvent",7);this.hoverEvent=i(this,"hoverEvent",7);this.mouseOutEvent=i(this,"mouseOutEvent",7);this.initialLoadEvent=i(this,"initialLoadEvent",7);this.initialLoadEndEvent=i(this,"initialLoadEndEvent",7);this.drawStartEvent=i(this,"drawStartEvent",7);this.drawEndEvent=i(this,"drawEndEvent",7);this.transitionEndEvent=i(this,"transitionEndEvent",7);this.shouldValidateAccessibility=true;this.currentDepth=0;this.zooming=false;this.timer=0;this.delay=200;this.prevent=false;this.updated=false;this.exitSize=0;this.enterSize=0;this.shouldZoom=false;this.shouldValidateInteractionKeys=false;this.shouldDrawInteractionState=false;this.shouldUpdateAnnotations=false;this.shouldResetRoot=false;this.shouldSetColors=false;this.shouldUpdateDisplayDepth=false;this.shouldUpdateLabels=false;this.shouldAddStrokeUnder=false;this.shouldUpdateCursor=false;this.shouldUpdateData=false;this.shouldUpdateTableData=false;this.shouldValidate=false;this.shouldBindInteractivity=false;this.shouldUpdateDescriptionWrapper=false;this.shouldSetChartAccessibilityTitle=false;this.shouldSetChartAccessibilitySubtitle=false;this.shouldSetChartAccessibilityLongDescription=false;this.shouldSetChartAccessibilityExecutiveSummary=false;this.shouldSetChartAccessibilityStatisticalNotes=false;this.shouldSetChartAccessibilityStructureNotes=false;this.shouldSetParentSVGAccessibility=false;this.shouldSetGeometryAccessibilityAttributes=false;this.shouldSetGeometryAriaLabels=false;this.shouldSetGroupAccessibilityAttributes=false;this.shouldSetGroupAccessibilityLabel=false;this.shouldSetChartAccessibilityPurpose=false;this.shouldSetChartAccessibilityContext=false;this.shouldSetChartAccessibilityCount=false;this.shouldSetAnnotationAccessibility=false;this.shouldUpdateLayout=false;this.shouldSetTextures=false;this.shouldSetStrokes=false;this.shouldSetTextStrokes=false;this.shouldSetTagLevels=false;this.shouldRedrawWrapper=false;this.shouldSetIDs=false;this.innerInteractionKeys=[];this.defaultsLoaded={};this.bottomLevel="p";this.topLevel="h2";this.strokes={};this.setCircleFilter=function(t,e,i){return!o(i[e]).classed("moving")&&!s.accessibility.hideStrokes?s.filter:null};this.setIDs=function(){s.rootG.selectAll("circle:not(.vcl-accessibility-focus-highlight)").attr("id",(function(t){return"circle-in-pack-"+s.generateValidId(t.data.id)}))};this.generateValidId=function(t){var e=t instanceof Date?t.getTime():t;return(e+"-"+s.chartID).replace(/\W/g,"-")};this.setCircleStyle=function(t,e,i){var r=o(i[e].parentNode).datum();var a=r.data.data;var n=s.colorArr[r.depth]||"#fff";var l=Ht(a,s.clickHighlight,s.innerInteractionKeys);var c=Kt(a,s.hoverHighlight,s.innerInteractionKeys);var h=r.depth!==0?l&&s.clickStyle.color?jt[s.clickStyle.color]||s.clickStyle.color||n:c&&s.hoverStyle.color?jt[s.hoverStyle.color]||s.hoverStyle.color||n:n:n;o(i[e]).attr("stroke",l?ct(jt[s.clickStyle.color]||s.clickStyle.color||s.preparedColors[r.depth]):c?ct(jt[s.hoverStyle.color]||s.hoverStyle.color||s.preparedColors[r.depth]):s.strokes[r.depth]).attr("stroke-width",l?s.clickStyle.strokeWidth||3:c?s.hoverStyle.strokeWidth||2:!s.accessibility.hideStrokes?1:0).attr("stroke-dasharray",c&&!l?"4 3":"");return h};this.mainTitle=u.mainTitle;this.subTitle=u.subTitle;this.height=u.height;this.width=u.width;this.margin=u.margin;this.padding=u.padding;this.circlePadding=u.circlePadding;this.highestHeadingLevel=u.highestHeadingLevel;this.data=undefined;this.uniqueID=undefined;this.dataDepth=u.dataDepth;this.displayDepth=u.displayDepth;this.parentAccessor=u.parentAccessor;this.nodeAccessor=u.nodeAccessor;this.sizeAccessor=u.sizeAccessor;this.colorPalette=u.colorPalette;this.colors=undefined;this.cursor=u.cursor;this.hoverStyle=u.hoverStyle;this.clickStyle=u.clickStyle;this.hoverOpacity=u.hoverOpacity;this.animationConfig=u.animationConfig;this.showTooltip=u.showTooltip;this.tooltipLabel=u.tooltipLabel;this.dataLabel=u.dataLabel;this.dataKeyNames=undefined;this.annotations=u.annotations;this.accessibility=u.accessibility;this.suppressEvents=u.suppressEvents;this.interactionKeys=undefined;this.hoverHighlight=undefined;this.clickHighlight=u.clickHighlight;this.zoomToNode=undefined}t.prototype.dataWatcher=function(t,e){this.updated=true;this.shouldUpdateData=true;this.shouldUpdateTableData=true;this.shouldValidate=true;this.shouldZoom=true;this.shouldAddStrokeUnder=true;this.shouldSetGeometryAccessibilityAttributes=true;this.shouldSetGeometryAriaLabels=true;this.shouldDrawInteractionState=true;this.shouldSetTextures=true;this.shouldSetStrokes=true;this.shouldSetColors=true};t.prototype.titleWatcher=function(t,e){this.shouldValidate=true;this.shouldUpdateDescriptionWrapper=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetParentSVGAccessibility=true};t.prototype.subtitleWatcher=function(t,e){this.shouldSetChartAccessibilitySubtitle=true;this.shouldSetParentSVGAccessibility=true};t.prototype.headingWatcher=function(t,e){this.shouldRedrawWrapper=true;this.shouldSetTagLevels=true;this.shouldSetChartAccessibilityCount=true;this.shouldUpdateDescriptionWrapper=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetChartAccessibilitySubtitle=true;this.shouldSetChartAccessibilityLongDescription=true;this.shouldSetChartAccessibilityContext=true;this.shouldSetChartAccessibilityExecutiveSummary=true;this.shouldSetChartAccessibilityPurpose=true;this.shouldSetChartAccessibilityStatisticalNotes=true;this.shouldSetChartAccessibilityStructureNotes=true;this.shouldSetAnnotationAccessibility=true};t.prototype.clusterWatcher=function(t,e){this.shouldUpdateData=true;this.shouldUpdateTableData=true;this.shouldZoom=true;this.shouldAddStrokeUnder=true;this.shouldSetGeometryAriaLabels=true;this.shouldDrawInteractionState=true};t.prototype.nodeWatcher=function(t,e){this.shouldUpdateData=true;this.shouldUpdateTableData=true;this.shouldZoom=true;this.shouldAddStrokeUnder=true;this.shouldSetGeometryAriaLabels=true;this.shouldDrawInteractionState=true};t.prototype.sizeWatcher=function(t,e){this.shouldUpdateData=true;this.shouldUpdateTableData=true;this.shouldSetGeometryAriaLabels=true;this.shouldZoom=true};t.prototype.heightWatcher=function(t,e){this.shouldUpdateLayout=true;this.shouldResetRoot=true;this.shouldUpdateData=true;this.shouldZoom=true;this.shouldAddStrokeUnder=true};t.prototype.dataDepthWatcher=function(t,e){this.shouldUpdateData=true;this.shouldSetColors=true;this.shouldZoom=true};t.prototype.displayDepthWatcher=function(t,e){this.shouldUpdateDisplayDepth=true;this.shouldZoom=true};t.prototype.circlePaddingWatcher=function(t,e){this.shouldUpdateData=true;this.shouldZoom=true};t.prototype.colorsWatcher=function(t,e){this.shouldSetColors=true;this.shouldDrawInteractionState=true;this.shouldSetTextures=true;this.shouldSetStrokes=true};t.prototype.showTooltipWatcher=function(t,e){this.shouldDrawInteractionState=true};t.prototype.tooltipLabelWatcher=function(t,e){this.shouldUpdateTableData=true;this.shouldSetParentSVGAccessibility=true;this.shouldSetGeometryAriaLabels=true};t.prototype.hoverOpacityWatcher=function(t,e){this.shouldDrawInteractionState=true};t.prototype.interactionStyleWatcher=function(t,e){this.shouldDrawInteractionState=true;this.shouldSetTextures=true;this.shouldSetStrokes=true;this.shouldSetColors=true};t.prototype.cursorWatcher=function(t,e){this.shouldUpdateCursor=true};t.prototype.clickWatcher=function(t,e){this.shouldDrawInteractionState=true};t.prototype.hoverWatcher=function(t,e){this.shouldDrawInteractionState=true};t.prototype.zoomWatcher=function(t,e){this.shouldZoom=true};t.prototype.interactionWatcher=function(t,e){this.shouldValidateInteractionKeys=true;this.shouldUpdateTableData=true;this.shouldDrawInteractionState=true;this.shouldSetGeometryAriaLabels=true};t.prototype.dataKeyNamesWatcher=function(t,e){this.shouldSetParentSVGAccessibility=true;this.shouldSetGroupAccessibilityLabel=true;this.shouldSetGeometryAriaLabels=true};t.prototype.labelWatcher=function(t,e){this.shouldUpdateTableData=true;this.shouldUpdateLabels=true;this.shouldAddStrokeUnder=true};t.prototype.accessibilityWatcher=function(t,e){this.shouldValidate=true;var i=t&&t.title?t.title:false;var s=e&&e.title?e.title:false;if(i!==s){this.shouldUpdateDescriptionWrapper=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetParentSVGAccessibility=true}var r=t&&t.executiveSummary?t.executiveSummary:false;var a=e&&e.executiveSummary?e.executiveSummary:false;if(r!==a){this.shouldSetChartAccessibilityExecutiveSummary=true}var o=t&&t.purpose?t.purpose:false;var n=e&&e.purpose?e.purpose:false;if(o!==n){this.shouldSetChartAccessibilityPurpose=true}var l=t&&t.longDescription?t.longDescription:false;var c=e&&e.longDescription?e.longDescription:false;if(l!==c){this.shouldSetChartAccessibilityLongDescription=true}var h=t&&t.contextExplanation?t.contextExplanation:false;var u=e&&e.contextExplanation?e.contextExplanation:false;if(h!==u){this.shouldSetChartAccessibilityContext=true}var d=t&&t.statisticalNotes?t.statisticalNotes:false;var p=e&&e.statisticalNotes?e.statisticalNotes:false;if(d!==p){this.shouldSetChartAccessibilityStatisticalNotes=true}var f=t&&t.structureNotes?t.structureNotes:false;var y=e&&e.structureNotes?e.structureNotes:false;if(f!==y){this.shouldSetChartAccessibilityStructureNotes=true}var v=t&&t.includeDataKeyNames;var g=e&&e.includeDataKeyNames;var b=t&&t.elementDescriptionAccessor?t.elementDescriptionAccessor:false;var m=e&&e.elementDescriptionAccessor?e.elementDescriptionAccessor:false;if(v!==g||b!==m){if(v!==g){this.shouldSetGroupAccessibilityLabel=true}this.shouldSetGeometryAriaLabels=true;this.shouldSetParentSVGAccessibility=true}var S=t&&t.hideTextures?t.hideTextures:false;var A=e&&e.hideTextures?e.hideTextures:false;if(S!==A){this.shouldSetTextures=true;this.shouldDrawInteractionState=true}var C=t&&t.hideStrokes?t.hideStrokes:false;var x=e&&e.hideStrokes?e.hideStrokes:false;if(C!==x){this.shouldSetStrokes=true;this.shouldDrawInteractionState=true}var D=t&&t.keyboardNavConfig&&t.keyboardNavConfig.disabled?t.keyboardNavConfig.disabled:false;var w=e&&e.keyboardNavConfig&&e.keyboardNavConfig.disabled?e.keyboardNavConfig.disabled:false;var k=t&&t.elementsAreInterface?t.elementsAreInterface:false;var T=e&&e.elementsAreInterface?e.elementsAreInterface:false;if(D!==w||k!==T){this.shouldSetGeometryAriaLabels=true;this.shouldSetParentSVGAccessibility=true;this.shouldUpdateDescriptionWrapper=true;this.shouldRedrawWrapper=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetChartAccessibilitySubtitle=true;this.shouldSetChartAccessibilityLongDescription=true;this.shouldSetChartAccessibilityContext=true;this.shouldSetChartAccessibilityExecutiveSummary=true;this.shouldSetChartAccessibilityPurpose=true;this.shouldSetChartAccessibilityStatisticalNotes=true;this.shouldSetChartAccessibilityStructureNotes=true}if(k!==T){this.shouldDrawInteractionState=true}};t.prototype.annotationsWatcher=function(t,e){this.shouldValidate=true;this.shouldUpdateAnnotations=true;this.shouldSetAnnotationAccessibility=true};t.prototype.idWatcher=function(t,e){console.error("Change detected in prop uniqueID from value "+e+" to value "+t+". This prop cannot be changed after component has loaded.")};t.prototype.suppressWatcher=function(t,e){this.shouldBindInteractivity=true;this.shouldUpdateCursor=true;this.shouldSetGeometryAriaLabels=true;this.shouldSetParentSVGAccessibility=true;this.shouldUpdateDescriptionWrapper=true;this.shouldRedrawWrapper=true;this.shouldValidate=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetChartAccessibilitySubtitle=true;this.shouldSetChartAccessibilityLongDescription=true;this.shouldSetChartAccessibilityContext=true;this.shouldSetChartAccessibilityExecutiveSummary=true;this.shouldSetChartAccessibilityPurpose=true;this.shouldSetChartAccessibilityStatisticalNotes=true;this.shouldSetChartAccessibilityStructureNotes=true};t.prototype.componentWillLoad=function(){var t=this;var e=this.uniqueID||"circle-pack-"+c();this.initialLoadEvent.emit({chartID:e});return new Promise((function(i){t.duration=0;t.chartID=e;t.circlePackingEl.id=t.chartID;t.setTagLevels();t.validateInteractionKeys();t.setTableData();t.setLayoutData();t.restructureData();t.shouldValidateAccessibilityProps();t.setColors();i("component will load")}))};t.prototype.componentWillUpdate=function(){return new Promise((function(t){t("component will update")}))};t.prototype.componentDidLoad=function(){var t=this;return new Promise((function(e){t.renderRootElements();t.setTooltipInitialStyle();t.setChartDescriptionWrapper();t.setChartAccessibilityTitle();t.setChartAccessibilitySubtitle();t.setChartAccessibilityLongDescription();t.setChartAccessibilityExecutiveSummary();t.setChartAccessibilityPurpose();t.setChartAccessibilityContext();t.setChartAccessibilityStatisticalNotes();t.setChartAccessibilityStructureNotes();t.setParentSVGAccessibility();t.prepareChartForDrawing();t.reSetRoot();t.setTextures();t.setStrokes();t.setTextStrokes();t.updateDisplayDepth();t.enterUpdateExitCircles(t.circleG,t.filterData(t.currentDepth));var i=t.getZoomTarget();t.drawZoomChildren(i);t.setChartCountAccessibility();t.setGeometryAccessibilityAttributes();t.setGeometryAriaLabels();t.addStrokeUnder();t.zoom(i);t.drawAnnotations();t.setAnnotationAccessibility();t.onChangeHandler();gt(t.root.node(),t.circleG.node(),true);e("component did load")})).then((function(){return t.initialLoadEndEvent.emit({chartID:t.chartID})}))};t.prototype.componentDidUpdate=function(){var t=this;return new Promise((function(e){t.duration=!t.animationConfig||!t.animationConfig.disabled?750:0;t.prepareChartForDrawing();if(t.shouldResetRoot){t.reSetRoot();t.shouldResetRoot=false}if(t.shouldSetColors){t.setColors();t.shouldSetColors=false}if(t.shouldSetTextures){t.setTextures();t.shouldSetTextures=false}if(t.shouldSetStrokes){t.setStrokes();t.shouldSetStrokes=false}if(t.shouldSetTextStrokes){t.setTextStrokes();t.shouldSetTextStrokes=false}if(t.shouldSetIDs){t.setIDs();t.shouldSetIDs=false}if(t.shouldUpdateDescriptionWrapper){t.setChartDescriptionWrapper();t.shouldUpdateDescriptionWrapper=false}if(t.shouldSetChartAccessibilityCount){t.setChartCountAccessibility();t.shouldSetChartAccessibilityCount=false}if(t.shouldSetChartAccessibilityTitle){t.setChartAccessibilityTitle();t.shouldSetChartAccessibilityTitle=false}if(t.shouldSetChartAccessibilitySubtitle){t.setChartAccessibilitySubtitle();t.shouldSetChartAccessibilitySubtitle=false}if(t.shouldSetChartAccessibilityLongDescription){t.setChartAccessibilityLongDescription();t.shouldSetChartAccessibilityLongDescription=false}if(t.shouldSetChartAccessibilityExecutiveSummary){t.setChartAccessibilityExecutiveSummary();t.shouldSetChartAccessibilityExecutiveSummary=false}if(t.shouldSetChartAccessibilityPurpose){t.setChartAccessibilityPurpose();t.shouldSetChartAccessibilityPurpose=false}if(t.shouldSetChartAccessibilityContext){t.setChartAccessibilityContext();t.shouldSetChartAccessibilityContext=false}if(t.shouldSetChartAccessibilityStatisticalNotes){t.setChartAccessibilityStatisticalNotes();t.shouldSetChartAccessibilityStatisticalNotes=false}if(t.shouldSetChartAccessibilityStructureNotes){t.setChartAccessibilityStructureNotes();t.shouldSetChartAccessibilityStructureNotes=false}if(t.shouldSetParentSVGAccessibility){t.setParentSVGAccessibility();t.shouldSetParentSVGAccessibility=false}if(t.shouldUpdateDisplayDepth){t.updateDisplayDepth();t.shouldUpdateDisplayDepth=false}if(t.shouldZoom){var i=t.getZoomTarget();t.drawZoomChildren(i);t.zoom(i);t.shouldZoom=false}else if(t.shouldUpdateLabels){var i=t.getZoomTarget();if(i.children&&i.children.length){t.setLabelSelections(i.children)}t.shouldUpdateLabels=false}if(t.shouldAddStrokeUnder){t.addStrokeUnder();t.shouldAddStrokeUnder=false}if(t.shouldSetGeometryAccessibilityAttributes){t.setGeometryAccessibilityAttributes();t.shouldSetGeometryAccessibilityAttributes=false}if(t.shouldSetGeometryAriaLabels){t.setGeometryAriaLabels();t.shouldSetGeometryAriaLabels=false}if(t.shouldBindInteractivity){t.bindInteractivity();t.shouldBindInteractivity=false}if(t.shouldDrawInteractionState){t.updateInteractionState();t.shouldDrawInteractionState=false}if(t.shouldUpdateCursor){t.updateCursor();t.shouldUpdateCursor=false}if(t.shouldUpdateAnnotations){t.drawAnnotations();t.shouldUpdateAnnotations=false}if(t.shouldSetAnnotationAccessibility){t.setAnnotationAccessibility();t.shouldSetAnnotationAccessibility=false}t.onChangeHandler();e("component did update")})).then((function(){return t.drawEndEvent.emit({chartID:t.chartID})}))};t.prototype.shouldValidateAccessibilityProps=function(){if(this.shouldValidateAccessibility&&!this.accessibility.disableValidation){this.shouldValidateAccessibility=false;$t(this.chartID,Object.assign({},this.accessibility),{annotations:this.annotations,data:this.data,uniqueID:this.uniqueID,context:{mainTitle:this.mainTitle,onClickEvent:!this.suppressEvents?this.clickEvent.emit:undefined}})}};t.prototype.setTableData=function(){var t=Ft(this,Gt,"circle-packing");this.tableData=_t(this.data,t);this.tableColumns=Object.keys(t)};t.prototype.setLayoutData=function(){this.padding=typeof this.padding==="string"?zt(this.padding):this.padding;this.innerHeight=this.height-this.margin.top-this.margin.bottom;this.innerWidth=this.width-this.margin.left-this.margin.right;this.innerPaddedHeight=this.innerHeight-this.padding.top-this.padding.bottom;this.innerPaddedWidth=this.innerWidth-this.padding.left-this.padding.right};t.prototype.restructureData=function(){var t=this;this.diameter=Math.min(this.innerPaddedWidth,this.innerPaddedHeight);this.holder=nt().id((function(e){return e[t.nodeAccessor]})).parentId((function(e){return e[t.parentAccessor]}))(this.data);this.rootCircle=w(this.holder).sum((function(e){return e.data[t.sizeAccessor]||1})).sort((function(t,e){return e.data.value-t.data.value}));this.nodes=X().size([this.diameter-this.circlePadding,this.diameter-this.circlePadding]).padding(this.circlePadding)(this.rootCircle).descendants();this.innerDataDepth=this.dataDepth?Math.min(l(this.nodes,(function(t){return t.depth})),this.dataDepth):l(this.nodes,(function(t){return t.depth}));this.nodes=this.nodes.filter((function(e){return!(e.depth>t.innerDataDepth)}))};t.prototype.validateInteractionKeys=function(){this.innerInteractionKeys=!this.interactionKeys||this.interactionKeys&&this.interactionKeys.length===0?[this.nodeAccessor]:__spreadArray([],this.interactionKeys,true)};t.prototype.prepareChartForDrawing=function(){var t=this.zoomToNode?this.generateValidId(this.zoomToNode[this.nodeAccessor]):"";var e=this.zoomToNode?this.rootG.select("#circle-in-pack-"+t).data()[0]:this.rootCircle;this.view=!this.view?[e.x,e.y,e.r*2]:this.view;this.zoomRatio=!this.zoomRatio?this.diameter/this.view[2]:this.zoomRatio;this.currentDepth=e.depth};t.prototype.renderRootElements=function(){this.svg=o(this.circlePackingEl).select(".visa-viz-circle-packing-container").append("svg").attr("width",this.width).attr("height",this.height).attr("viewBox","0 0 "+this.width+" "+this.height).attr("data-testid","root-svg");this.root=this.svg.append("g").attr("id","visa-viz-margin-container-g-"+this.chartID).attr("data-testid","margin-container");this.rootG=this.root.append("g").attr("id","visa-viz-padding-container-g-"+this.chartID).attr("data-testid","padding-container");this.circleG=this.rootG.append("g").attr("class","circle-pack-group").attr("data-testid","circle-group");this.textG=this.rootG.append("g").attr("class","circle-pack-text-group").attr("data-testid","dataLabel-group");this.tooltipG=o(this.circlePackingEl).select(".circle-packing-tooltip")};t.prototype.reSetRoot=function(){var t=Qt({selection:this.svg,duration:this.duration,namespace:"root_reset"});t.attr("width",this.width).attr("height",this.height).attr("viewBox","0 0 "+this.width+" "+this.height);var e=Qt({selection:this.root,duration:this.duration,namespace:"root_reset"});e.attr("transform","translate(".concat(this.diameter/2+this.margin.left,", ").concat(this.diameter/2+this.margin.top,")"));var i=Qt({selection:this.rootG,duration:this.duration,namespace:"root_reset"});i.attr("transform","translate(".concat(this.padding.left,", ").concat(this.padding.top,")"));if(typeof this.filter!=="undefined"){this.enterUpdateExitCircles(this.circleG,this.filterData(0))}Pt(this.chartID,this.width)};t.prototype.setGlobalSelections=function(){this.circle=this.rootG.selectAll("circle:not(.vcl-accessibility-focus-highlight)")};t.prototype.enterUpdateExitCircles=function(t,e){var i=e[0].depth;var s=t.selectAll(".g-level-"+i).data(e,(function(t){return t.data.id}));this.enterCircle=s.enter().append("g");this.enterSize+=this.enterCircle.size();this.exitCircle=s.exit();this.enterCircles(i);this.exitCircles(this.exitCircle,true);this.updateParentCircle=s.merge(this.enterCircle);this.updateParentCircle.order();this.checkRecursion(i)};t.prototype.enterCircles=function(t){var e=this;this.enterCircle.attr("class","g-level-"+t).attr("id",(function(t){return"circle-in-pack-"+e.generateValidId(t.data.id)}));this.enterCircle.append("circle").attr("filter",this.setCircleFilter).classed("node node-level-"+t,true).classed("node--root",(function(t,e,i){var s=o(i[e].parentNode).datum();return!s.parent})).on("mouseover",!this.suppressEvents?function(t,i,s){var r=o(s[i].parentNode).datum();e.onHoverHandler(r,s[i])}:null).on("mouseout",!this.suppressEvents?function(){e.onMouseOutHandler()}:null).on("click",!this.suppressEvents?function(t,i,s){var r=o(s[i].parentNode).datum();if(!e.zooming){e.clickEvent.emit({data:r.data.data,target:s[i]})}}:null).attr("fill",this.setCircleStyle).attr("opacity",(function(t,i,s){var r=o(s[i].parentNode).datum();var a=r.data.data;return Ut(a,1,e.hoverOpacity,e.hoverHighlight,e.clickHighlight,e.innerInteractionKeys)})).each((function(t,i,s){dt(s[i]);ft({node:s[i],geomType:"node",includeKeyNames:e.accessibility.includeDataKeyNames,dataKeys:Ft(e,Gt,"circle-packing"),dataKeyNames:e.dataKeyNames,recursive:true,groupName:"node",uniqueID:e.chartID});yt({node:s[i],uniqueID:e.chartID});var r=o(s[i].parentNode).datum();var a=Ut(r,true,false,"",e.clickHighlight,e.innerInteractionKeys);a=e.clickHighlight&&e.clickHighlight.length?a:false;var n=e.accessibility.elementsAreInterface;Et(s[i],a,n)})).attr("data-testid","circle").attr("data-id",(function(t,i,s){var r=o(s[i].parentNode).datum();var a=r.data.data;return"circle-".concat(a[e.parentAccessor],"-").concat(a[e.nodeAccessor])})).attr("cursor",!this.suppressEvents?this.cursor:null).attr("transform",(function(t){return"translate("+Mt((t.x-e.view[0])*e.zoomRatio,4)+","+Mt((t.y-e.view[1])*e.zoomRatio,4)+")"})).attr("r",0)};t.prototype.exitCircles=function(t,e){if(t.size()){this.exitSize+=t.size();if(e){this.exitSize+=t.selectAll("g").size()}var i=It(this.rootG.node());t.remove();this.setChartCountAccessibility();this.setGeometryAriaLabels();Lt({parentGNode:this.rootG.node(),focusDidExist:i,recursive:true})}};t.prototype.checkRecursion=function(t){var e=this;this.updateParentCircle.each((function(i,s,r){var a=e.currentDepth+e.innerDisplayDepth;var n=0;if(i.depth+1<=a){n=t+1}if(n&&i.children&&i.children.length){e.enterUpdateExitCircles(o(r[s]),i.children)}else{e.exitCircles(o(r[s]).selectAll("g"),false)}}))};t.prototype.setLabelSelections=function(t){var e=this.textG.selectAll("text").data(t,(function(t){return(t.data||{}).id}));this.enterText=e.enter().append("text");this.updateText=e.merge(this.enterText);this.exitText=e.exit().remove();this.enterLabels();this.drawLabels()};t.prototype.enterLabels=function(){var t=this;this.enterText.attr("filter",this.textFilter).attr("class","label circle-packing-dataLabel").attr("cursor",!this.suppressEvents?this.cursor:null).attr("data-testid","dataLabel").attr("data-x",(function(e){return Mt((e.x-t.view[0])*t.zoomRatio,4)})).attr("data-y",(function(e){return Mt((e.y-t.view[1])*t.zoomRatio,4)})).attr("data-translate-x",this.diameter/2+this.margin.left).attr("data-translate-y",this.diameter/2+this.margin.top).attr("x",(function(e){return Mt((e.x-t.view[0])*t.zoomRatio,4)})).attr("y",(function(e){return Mt((e.y-t.view[1])*t.zoomRatio,4)})).attr("text-anchor","middle")};t.prototype.drawLabels=function(){var t=this;this.updateText.attr("opacity",(function(e){return t.dataLabel.visible?1:0})).text((function(e){return t.dataLabel.labelAccessor?e.data.data[t.dataLabel.labelAccessor]:e.data.data[t.nodeAccessor]}));if(!this.shouldZoom&&this.shouldUpdateLabels)this.placeLabels()};t.prototype.placeLabels=function(){var t=this;var e=this.dataLabel.placement!=="auto"&&this.dataLabel.collisionHideOnly;var i=this.updateText.classed("moving",(function(e,i,s){var r=+o(s[i]).attr("data-x");var a=+o(s[i]).attr("data-y");var n=Mt((e.x-t.view[0])*t.zoomRatio,4);var l=Mt((e.y-t.view[1])*t.zoomRatio,4);return r!==n||a!==l})).attr("data-x",(function(e){return Mt((e.x-t.view[0])*t.zoomRatio,4)})).attr("data-y",(function(e){return Mt((e.y-t.view[1])*t.zoomRatio,4)})).attr("data-translate-x",this.diameter/2+this.margin.left).attr("data-translate-y",this.diameter/2+this.margin.top).style("visibility",(function(e,i,s){return t.dataLabel.placement==="auto"||t.dataLabel.collisionHideOnly?o(s[i]).style("visibility"):null})).attr("filter",null).transition("place").duration(this.duration);var s={all:{validPositions:["middle","top","bottom","left","right","bottom-right","bottom-left","top-left","top-right"],offsets:[1,1,2,4,4,1,1,1,1]},centroid:{validPositions:["middle"],offsets:[1]},top:{validPositions:["top","top-left","top-right"],offsets:[1,1,1]},middle:{validPositions:["middle","left","right"],offsets:[1,4,4]},bottom:{validPositions:["bottom","bottom-left","bottom-right"],offsets:[2,1,1]},right:{validPositions:["right","top-right","bottom-right"],offsets:[4,1,1]},left:{validPositions:["left","top-left","bottom-left"],offsets:[4,1,1]}};var r=this.dataLabel&&this.dataLabel.collisionPlacement;var a=e?["middle"]:r&&s[r]?s[r].validPositions:s["all"].validPositions;var n=e?[1]:r&&s[r]?s[r].offsets:s["all"].offsets;if(this.dataLabel.visible&&(this.dataLabel.placement==="auto"||this.dataLabel.collisionHideOnly)){this.bitmaps=Xt({labelSelection:i,avoidMarks:[],validPositions:a,offsets:n,accessors:[this.parentAccessor,this.nodeAccessor],size:[Mt(this.innerPaddedWidth),Mt(this.innerPaddedHeight)],hideOnly:this.dataLabel.visible&&e});if(e){i.attr("x",(function(e){return Mt((e.x-t.view[0])*t.zoomRatio,4)})).attr("y",(function(e){return Mt((e.y-t.view[1])*t.zoomRatio,4)}))}}else{i.attr("x",(function(e){return Mt((e.x-t.view[0])*t.zoomRatio,4)})).attr("y",(function(e){return Mt((e.y-t.view[1])*t.zoomRatio,4)}))}i.call(Zt,(function(){t.updateText.classed("moving",false);setTimeout((function(){t.addStrokeUnder()}),0)}))};t.prototype.addStrokeUnder=function(){this.updateText.attr("filter",this.textFilter)};t.prototype.setTextStrokes=function(){this.textFilter=ht({root:this.svg.node(),id:this.chartID,color:"#ffffff"});this.filter=ht({root:this.svg.node(),id:this.chartID,color:"#ffffff",strokeSizeOverride:1})};t.prototype.bindInteractivity=function(){var t=this;this.circle.on("mouseover",!this.suppressEvents?function(e,i,s){var r=o(s[i].parentNode).datum();t.onHoverHandler(r,s[i])}:null).on("mouseout",!this.suppressEvents?function(){t.onMouseOutHandler()}:null).on("click",!this.suppressEvents?function(e,i,s){var r=o(s[i].parentNode).datum();if(!t.zooming){t.clickEvent.emit({data:r.data.data,target:s[i]})}}:null)};t.prototype.drawAnnotations=function(){Wt({source:this.rootG.node(),data:this.annotations,width:this.width,height:this.height,padding:this.padding,margin:this.margin,bitmaps:this.bitmaps})};t.prototype.setAnnotationAccessibility=function(){Tt(this.circlePackingEl,this.annotations)};t.prototype.setColors=function(){this.preparedColors=this.colors?Rt(this.colors):Vt(this.colorPalette,this.innerDataDepth+1)};t.prototype.setTextures=function(){var t=this.preparedColors.range?this.preparedColors.range():this.preparedColors;if(this.accessibility.hideTextures||t.length>6){this.colorArr=this.preparedColors}else{var e=ut({colors:t,rootSVG:this.svg.node(),id:this.chartID,scheme:"categorical",disableTransitions:!this.duration});this.colorArr=this.preparedColors.range?this.preparedColors.copy().range(e):e}};t.prototype.setStrokes=function(){var t=this;this.strokes=[];this.preparedColors.forEach((function(e){t.strokes.push(ct(e))}))};t.prototype.updateDisplayDepth=function(){var t=this;this.innerDisplayDepth=this.displayDepth?Math.min(l(this.nodes,(function(t){return t.depth})),this.displayDepth):l(this.nodes,(function(t){return t.depth}));if(this.circleG){this.circleG.selectAll("g").each((function(e,i,s){if(e.depth>t.innerDisplayDepth){t.exitSize++;t.exitSize+=o(s[i]).selectAll("g").size();o(s[i]).remove()}}))}};t.prototype.updateCursor=function(){this.circle.attr("cursor",!this.suppressEvents?this.cursor:null)};t.prototype.updateInteractionState=function(){var t=this;this.circle.attr("fill",this.setCircleStyle).attr("filter",this.setCircleFilter).attr("opacity",(function(e,i,s){var r=o(s[i].parentNode).datum();var a=r.data.data;return Ut(a,1,t.hoverOpacity,t.hoverHighlight,t.clickHighlight,t.innerInteractionKeys)})).each((function(e,i,s){var r=o(s[i].parentNode).datum();var a=Ut(r,true,false,"",t.clickHighlight,t.innerInteractionKeys);a=t.clickHighlight&&t.clickHighlight.length?a:false;var n=t.accessibility.elementsAreInterface;Et(s[i],a,n)}));if(!this.zooming){Lt({parentGNode:this.rootG.node(),recursive:true})}};t.prototype.drawZoomChildren=function(t){if(t.children&&t.children.length){var e=this.generateValidId(t.data.id);this.enterUpdateExitCircles(this.rootG.select("#circle-in-pack-"+e),t.children);this.setGlobalSelections();this.setLabelSelections(t.children)}else if(t){this.setGlobalSelections();this.setLabelSelections([t])}};t.prototype.getZoomTarget=function(){var t=this.zoomToNode?this.generateValidId(this.zoomToNode[this.nodeAccessor]):"";return this.zoomToNode?this.rootG.select("#circle-in-pack-"+t).datum():this.rootCircle};t.prototype.zoom=function(t){var e=this;this.zooming=true;this.view=[t.x,t.y,t.r*2];this.zoomRatio=this.diameter/this.view[2];this.circle.classed("moving",(function(t,i,s){var r=o(s[i].parentNode).datum();var a=+o(s[i]).attr("data-cx");var n=+o(s[i]).attr("data-cy");var l=+o(s[i]).attr("r");var c=Mt((r.x-e.view[0])*e.zoomRatio,4);var h=Mt((r.y-e.view[1])*e.zoomRatio,4);var u=r.r*e.zoomRatio;return l!==u||a!==c||n!==h})).attr("data-cx",(function(t,i,s){var r=o(s[i].parentNode).datum();return Mt((r.x-e.view[0])*e.zoomRatio,4)})).attr("data-cy",(function(t,i,s){var r=o(s[i].parentNode).datum();return Mt((r.y-e.view[1])*e.zoomRatio,4)})).attr("data-r",(function(t,i,s){var r=o(s[i].parentNode).datum();return r.r*e.zoomRatio})).attr("data-translate-x",this.diameter/2+this.margin.left).attr("data-translate-y",this.diameter/2+this.margin.top);var i=this.circle.filter(".moving").attr("filter",null).transition("zoom").duration(this.duration).attr("transform",(function(t,i,s){var r=o(s[i].parentNode).datum();return"translate("+Mt((r.x-e.view[0])*e.zoomRatio,4)+","+Mt((r.y-e.view[1])*e.zoomRatio,4)+")"})).attr("r",(function(t,i,s){var r=o(s[i].parentNode).datum();return r.r*e.zoomRatio}));var s=function(){e.zooming=false;e.circle.classed("moving",false);setTimeout((function(){e.circle.attr("filter",e.setCircleFilter)}),0);Lt({parentGNode:e.rootG.node(),recursive:true});e.transitionEndEvent.emit({chartID:e.chartID})};if(this.duration&&i.size()>0){i.attrTween("x",(function(t,i,s){var r=o(s[i]).classed("vcl-accessibility-focus-source");return function(){if(r){Lt({parentGNode:e.rootG.node(),recursive:true})}return 0}})).call(Zt,s)}else{s()}this.placeLabels()};t.prototype.onHoverHandler=function(t,e){Bt(this.chartID,true);this.hoverEvent.emit({data:t.data.data,target:e});if(this.showTooltip){this.eventsTooltip({data:t.data.data,evt:n,isToShow:true})}};t.prototype.onMouseOutHandler=function(){Bt(this.chartID,false);this.mouseOutEvent.emit();if(this.showTooltip){this.eventsTooltip({isToShow:false})}};t.prototype.setTooltipInitialStyle=function(){qt(this.tooltipG)};t.prototype.eventsTooltip=function(t){var e=t.data,i=t.evt,s=t.isToShow;Nt({root:this.tooltipG,data:e,event:i,isToShow:s,tooltipLabel:this.tooltipLabel,dataLabel:this.dataLabel,dataKeyNames:this.dataKeyNames,ordinalAccessor:this.nodeAccessor,groupAccessor:this.parentAccessor,valueAccessor:this.sizeAccessor,chartType:"circle-packing"})};t.prototype.setTagLevels=function(){this.topLevel=Jt(this.highestHeadingLevel);this.bottomLevel=Jt(this.highestHeadingLevel,3)};t.prototype.setChartDescriptionWrapper=function(){pt({rootEle:this.circlePackingEl,title:this.accessibility.title||this.mainTitle,chartTag:"circle-packing",uniqueID:this.chartID,highestHeadingLevel:this.highestHeadingLevel,recursive:true,redraw:this.shouldRedrawWrapper,disableKeyNav:this.suppressEvents&&this.accessibility.elementsAreInterface===false&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled});this.shouldRedrawWrapper=false};t.prototype.setParentSVGAccessibility=function(){vt({node:this.svg.node(),chartTag:"circle-packing",title:this.accessibility.title||this.mainTitle,description:this.subTitle,uniqueID:this.chartID,geomType:"node",includeKeyNames:this.accessibility.includeDataKeyNames,dataKeys:Ft(this,Gt,"circle-packing"),dataKeyNames:this.dataKeyNames,groupAccessor:this.parentAccessor,groupName:"node",recursive:true,disableKeyNav:this.suppressEvents&&this.accessibility.elementsAreInterface===false&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled})};t.prototype.setGeometryAccessibilityAttributes=function(){this.rootG.selectAll(".node").each((function(t,e,i){dt(i[e])}))};t.prototype.setGeometryAriaLabels=function(){var t=this;var e=Ft(this,Gt,"circle-packing");this.rootG.selectAll(".node").each((function(i,s,r){ft({node:r[s],geomType:"node",includeKeyNames:t.accessibility.includeDataKeyNames,dataKeys:e,dataKeyNames:t.dataKeyNames,recursive:true,groupName:"node",uniqueID:t.chartID,disableKeyNav:t.suppressEvents&&t.accessibility.elementsAreInterface===false&&t.accessibility.keyboardNavConfig&&t.accessibility.keyboardNavConfig.disabled});yt({node:r[s],uniqueID:t.chartID})}))};t.prototype.setChartAccessibilityTitle=function(){bt(this.circlePackingEl,this.accessibility.title||this.mainTitle)};t.prototype.setChartAccessibilitySubtitle=function(){mt(this.circlePackingEl,this.subTitle)};t.prototype.setChartAccessibilityLongDescription=function(){St(this.circlePackingEl,this.accessibility.longDescription)};t.prototype.setChartAccessibilityExecutiveSummary=function(){At(this.circlePackingEl,this.accessibility.executiveSummary)};t.prototype.setChartAccessibilityPurpose=function(){Ct(this.circlePackingEl,this.accessibility.purpose)};t.prototype.setChartAccessibilityContext=function(){xt(this.circlePackingEl,this.accessibility.contextExplanation)};t.prototype.setChartAccessibilityStatisticalNotes=function(){Dt(this.circlePackingEl,this.accessibility.statisticalNotes)};t.prototype.setChartCountAccessibility=function(){wt({rootEle:this.circlePackingEl,parentGNode:this.circleG.node(),chartTag:"circle-packing",geomType:"node",groupName:"node",recursive:true})};t.prototype.setChartAccessibilityStructureNotes=function(){kt(this.circlePackingEl,this.accessibility.structureNotes)};t.prototype.onChangeHandler=function(){if(this.accessibility&&typeof this.accessibility.onChangeFunc==="function"){var t={updated:this.updated,added:this.enterSize,removed:this.exitSize};this.accessibility.onChangeFunc(t)}this.updated=false;this.enterSize=0;this.exitSize=0};t.prototype.filterData=function(t){return this.nodes.filter((function(e){if(e.depth===t){return true}return false}))};t.prototype.render=function(){this.drawStartEvent.emit({chartID:this.chartID});this.init();if(this.shouldSetTagLevels){this.setTagLevels();this.shouldSetTagLevels=false}if(this.shouldValidateInteractionKeys){this.validateInteractionKeys();this.shouldValidateInteractionKeys=false}if(this.shouldUpdateTableData){this.setTableData();this.shouldUpdateTableData=false}if(this.shouldValidate){this.shouldValidateAccessibilityProps();this.shouldValidate=false}if(this.shouldUpdateLayout){this.setLayoutData();this.shouldUpdateLayout=false}if(this.shouldUpdateData){this.restructureData();this.shouldUpdateData=false}return s("div",{class:"o-layout","data-testid":"outer-layout"},s("div",{class:"o-layout--chart","data-testid":"layout-chart"},s(this.topLevel,{"data-testid":"main-title"},this.mainTitle),s(this.bottomLevel,{class:"visa-ui-text--instructions","data-testid":"sub-title"},this.subTitle),s("keyboard-instructions",{uniqueID:this.chartID,geomType:"node",groupName:"node collection",chartTag:"circle-packing",width:this.width-(this.margin?this.margin.right||0:0),isInteractive:this.accessibility.elementsAreInterface,hasCousinNavigation:true,cousinResultOverride:"Drill up or down a level",disabled:this.suppressEvents&&this.accessibility.elementsAreInterface===false&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled}),s("div",{class:"visa-viz-circle-packing-container","data-testid":"chart-container"}),s("div",{class:"circle-packing-tooltip vcl-tooltip","data-testid":"tooltip-container",style:{display:this.showTooltip?"block":"none"}}),s("data-table",{uniqueID:this.chartID,unitTest:true,isCompact:true,tableColumns:this.tableColumns,dataKeyNames:this.dataKeyNames,data:this.tableData,padding:this.padding,margin:this.margin,hideDataTable:this.accessibility.hideDataTableButton})))};t.prototype.init=function(){var t=Object.keys(u);var e=0;var i={showTooltip:{exception:false},circlePadding:{exception:0},mainTitle:{exception:""},subTitle:{exception:""},hoverOpacity:{exception:0}};for(e=0;e<t.length;e++){var s=!i[t[e]]?false:this[t[e]]===i[t[e]].exception;if(!(this[t[e]]||s)&&!(u[t[e]]===this[t[e]])){this[t[e]]=u[t[e]]}}};Object.defineProperty(t.prototype,"circlePackingEl",{get:function(){return r(this)},enumerable:false,configurable:true});Object.defineProperty(t,"watchers",{get:function(){return{data:["dataWatcher"],mainTitle:["titleWatcher"],subTitle:["subtitleWatcher"],highestHeadingLevel:["headingWatcher"],parentAccessor:["clusterWatcher"],nodeAccessor:["nodeWatcher"],sizeAccessor:["sizeWatcher"],height:["heightWatcher"],width:["heightWatcher"],padding:["heightWatcher"],margin:["heightWatcher"],dataDepth:["dataDepthWatcher"],displayDepth:["displayDepthWatcher"],circlePadding:["circlePaddingWatcher"],colors:["colorsWatcher"],colorPalette:["colorsWatcher"],showTooltip:["showTooltipWatcher"],tooltipLabel:["tooltipLabelWatcher"],hoverOpacity:["hoverOpacityWatcher"],clickStyle:["interactionStyleWatcher"],hoverStyle:["interactionStyleWatcher"],cursor:["cursorWatcher"],clickHighlight:["clickWatcher"],hoverHighlight:["hoverWatcher"],zoomToNode:["zoomWatcher"],interactionKeys:["interactionWatcher"],dataKeyNames:["dataKeyNamesWatcher"],dataLabel:["labelWatcher"],accessibility:["accessibilityWatcher"],annotations:["annotationsWatcher"],uniqueID:["idWatcher"],suppressEvents:["suppressWatcher"]}},enumerable:false,configurable:true});return t}());window["VisaChartsLibOSSLicenses"]=Ot();Yt.style=lt}}}));