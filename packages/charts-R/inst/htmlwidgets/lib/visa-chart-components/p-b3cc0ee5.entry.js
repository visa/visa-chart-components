/**
 * Copyright (c) 2024 Visa, Inc.
 *
 * This source code is licensed under the MIT license
 * https://github.com/visa/visa-chart-components/blob/master/LICENSE
 *
 **/
import{r as t,c as i,h as s,g as h}from"./p-eeee2e3c.js";import{v as e,s as a,e as n}from"./p-a494a9b5.js";import{v as r}from"./p-9cc83250.js";import{w as o,c as l,a as c}from"./p-fef5c4ba.js";import{h as d,e as u,t as p,c as g,s as f,m as b,a as y,b as v,p as m,d as A,f as L,g as x,i as R}from"./p-2f90bdc4.js";import{c as W}from"./p-209ccfff.js";import{i as w}from"./p-85d34e7b.js";function T(t){return t.innerRadius}function k(t){return t.outerRadius}function S(t){return t.startAngle}function D(t){return t.endAngle}function N(t){return t&&t.padAngle}function C(t,i,s,h,e,a,n,r){var o=s-t,l=h-i,c=n-e,d=r-a,p=d*o-c*l;if(!(p*p<u))return[t+(p=(c*(i-a)-d*(t-e))/p)*o,i+p*l]}function E(t,i,s,h,e,a,n){var r=t-s,o=i-h,l=(n?a:-a)/A(r*r+o*o),c=l*o,d=-l*r,u=t+c,p=i+d,g=s+c,f=h+d,b=(u+g)/2,y=(p+f)/2,v=g-u,m=f-p,x=v*v+m*m,R=e-a,W=u*f-g*p,w=(m<0?-1:1)*A(L(0,R*R*x-W*W)),T=(W*m-v*w)/x,k=(-W*v-m*w)/x,S=(W*m+v*w)/x,D=(-W*v+m*w)/x,N=T-b,C=k-y,E=S-b,z=D-y;return N*N+C*C>E*E+z*z&&(T=S,k=D),{cx:T,cy:k,x01:-c,y01:-d,x11:T*(e/R-1),y11:k*(e/R-1)}}function z(t,i){return i<t?-1:i>t?1:i>=t?0:NaN}function M(t){return t}const{propDefaultValues:I}=e;class P{}P.mainTitle="Pie Chart Title",P.subTitle=I.subTitle.text,P.centerTitle="",P.centerSubTitle="",P.height=325,P.width=600,P.margin={top:30,bottom:30,right:30,left:30},P.padding={top:20,bottom:50,right:70,left:70},P.localization=I.localization,P.ordinalAccessor="label",P.valueAccessor="value",P.innerRatio=.7,P.showEdgeLine=!1,P.showPercentage=!0,P.showLabelNote=!0,P.labelOffset=25,P.accessibility=I.accessibility,P.animationConfig=I.animationConfig,P.highestHeadingLevel=I.highestHeadingLevel,P.colorPalette=I.colorPaletteSequential,P.sortOrder=I.sortOrderAsc,P.hoverStyle=I.hoverStyle,P.clickStyle=I.clickStyle,P.referenceStyle=I.referenceStyle,P.hoverOpacity=I.hoverOpacity,P.cursor=I.cursor,P.showTooltip=I.showTooltip,P.dataLabel=I.dataLabelNormalizedOut,P.tooltipLabel=I.tooltipLabel,P.annotations=I.annotations,P.suppressEvents=I.suppressEvents,P.clickHighlight=I.clickHighlight;const{getGlobalInstances:O,configLocalization:K,getActiveLanguageString:G,checkAttributeTransitions:$,createTextStrokeFilter:H,drawHoverStrokes:j,removeHoverStrokes:q,buildStrokes:F,convertColorsToTextures:V,initializeDescriptionRoot:_,initializeElementAccess:B,setElementFocusHandler:U,setElementAccessID:J,setAccessibilityController:Q,hideNonessentialGroups:X,setAccessTitle:Y,setAccessSubtitle:Z,setAccessLongDescription:tt,setAccessExecutiveSummary:it,setAccessPurpose:st,setAccessContext:ht,setAccessStatistics:et,setAccessChartCounts:at,setAccessStructure:nt,setAccessAnnotation:rt,retainAccessFocus:ot,checkAccessFocus:lt,setElementInteractionAccessState:ct,setAccessibilityDescriptionWidth:dt,autoTextColor:ut,annotate:pt,chartAccessors:gt,checkInteraction:ft,checkClicked:bt,checkHovered:yt,convertVisaColor:vt,drawTooltip:mt,formatStats:At,getColors:Lt,getLicenses:xt,getPadding:Rt,getScopedData:Wt,initTooltipStyle:wt,transitionEndAll:Tt,overrideTitleTooltip:kt,scopeDataKeys:St,visaColors:Dt,validateAccessibilityProps:Nt,validateLocalizationProps:Ct,findTagLevel:Et,prepareRenderChange:zt,roundTo:Mt,getTextWidth:It,resolveLabelCollision:Pt,setSubTitle:Ot}=e,Kt=class{constructor(s){t(this,s),this.clickEvent=i(this,"clickEvent",7),this.hoverEvent=i(this,"hoverEvent",7),this.mouseOutEvent=i(this,"mouseOutEvent",7),this.initialLoadEvent=i(this,"initialLoadEvent",7),this.initialLoadEndEvent=i(this,"initialLoadEndEvent",7),this.drawStartEvent=i(this,"drawStartEvent",7),this.drawEndEvent=i(this,"drawEndEvent",7),this.transitionEndEvent=i(this,"transitionEndEvent",7),this.shouldValidateAccessibility=!0,this.shouldValidateLocalization=!0,this.updated=!0,this.shouldValidate=!1,this.shouldUpdateCenterTitle=!1,this.shouldUpdateTableData=!1,this.shouldResetRoot=!1,this.shouldUpdateLabels=!1,this.shouldUpdateAnnotations=!1,this.shouldUpdateData=!1,this.shouldSetColors=!1,this.shouldSetSubTitle=!1,this.shouldUpdateCursor=!1,this.shouldUpdateGeometries=!1,this.shouldUpdateEdgeLines=!1,this.shouldUpdateInnerRatio=!1,this.shouldUpdateLayout=!1,this.shouldSetPieRadius=!1,this.shouldPrepareChartData=!1,this.shouldUpdateReferenceLines=!1,this.shouldValidateInteractionKeys=!1,this.shouldSetGlobalSelections=!1,this.shouldSetTestingAttributes=!1,this.shouldEnterUpdateExit=!1,this.shouldBindInteractivity=!1,this.shouldSetSelectionClass=!1,this.shouldDrawInteractionState=!1,this.shouldSetLabelOpacity=!1,this.shouldCheckLabelColor=!1,this.shouldUpdateScales=!1,this.shouldUpdateDescriptionWrapper=!1,this.shouldSetChartAccessibilityTitle=!1,this.shouldSetChartAccessibilitySubtitle=!1,this.shouldSetChartAccessibilityLongDescription=!1,this.shouldSetChartAccessibilityExecutiveSummary=!1,this.shouldSetChartAccessibilityStatisticalNotes=!1,this.shouldSetChartAccessibilityStructureNotes=!1,this.shouldSetParentSVGAccessibility=!1,this.shouldSetGeometryAccessibilityAttributes=!1,this.shouldSetGeometryAriaLabels=!1,this.shouldSetGroupAccessibilityAttributes=!1,this.shouldSetGroupAccessibilityLabel=!1,this.shouldSetChartAccessibilityPurpose=!1,this.shouldSetChartAccessibilityContext=!1,this.shouldRedrawWrapper=!1,this.shouldSetTagLevels=!1,this.shouldSetChartAccessibilityCount=!1,this.shouldSetAnnotationAccessibility=!1,this.shouldSetTextures=!1,this.shouldSetStrokes=!1,this.shouldSetLocalizationConfig=!1,this.strokes={},this.topLevel="h2",this.bottomLevel="p",this.textTreatmentHandler=(t,i,s,h)=>{const e=h||this.dataLabel.placement,n=this.clickHighlight&&this.clickHighlight.length>0&&bt(t.data,this.clickHighlight,this.innerInteractionKeys)&&this.clickStyle.color?Dt[this.clickStyle.color]||this.clickStyle.color:this.hoverHighlight&&yt(t.data,this.hoverHighlight,this.innerInteractionKeys)&&this.hoverStyle.color?Dt[this.hoverStyle.color]||this.hoverStyle.color:this.preparedColors[i],r="inside"===e?ut(n):Dt.dark_text,o=a(s[i]);return o.attr("filter",o.classed("textIsMoving")?null:H({root:this.svg.node(),id:this.chartID,color:"inside"===e?n:"#ffffff"})),r},this.localization=P.localization,this.mainTitle=P.mainTitle,this.subTitle=P.subTitle,this.centerTitle=P.centerTitle,this.centerSubTitle=P.centerSubTitle,this.height=P.height,this.width=P.width,this.highestHeadingLevel=P.highestHeadingLevel,this.margin=P.margin,this.padding=P.padding,this.data=void 0,this.uniqueID=void 0,this.ordinalAccessor=P.ordinalAccessor,this.valueAccessor=P.valueAccessor,this.sortOrder=P.sortOrder,this.colorPalette=P.colorPalette,this.colors=void 0,this.innerRatio=P.innerRatio,this.showEdgeLine=P.showEdgeLine,this.hoverStyle=P.hoverStyle,this.clickStyle=P.clickStyle,this.referenceStyle=P.referenceStyle,this.cursor=P.cursor,this.hoverOpacity=P.hoverOpacity,this.animationConfig=P.animationConfig,this.showPercentage=P.showPercentage,this.showTooltip=P.showTooltip,this.showLabelNote=P.showLabelNote,this.labelOffset=P.labelOffset,this.dataLabel=P.dataLabel,this.dataKeyNames=void 0,this.tooltipLabel=P.tooltipLabel,this.accessibility=P.accessibility,this.annotations=P.annotations,this.referenceData=void 0,this.suppressEvents=P.suppressEvents,this.hoverHighlight=void 0,this.clickHighlight=P.clickHighlight,this.interactionKeys=void 0,this.unitTest=!1}titleWatcher(t,i){this.shouldValidate=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetChartAccessibilityTitle=!0,this.shouldSetParentSVGAccessibility=!0}subtitleWatcher(t,i){this.shouldSetSubTitle=!0,this.shouldSetChartAccessibilitySubtitle=!0,this.shouldSetParentSVGAccessibility=!0}headingWatcher(t,i){this.shouldRedrawWrapper=!0,this.shouldSetTagLevels=!0,this.shouldSetChartAccessibilityCount=!0,this.shouldSetAnnotationAccessibility=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetSubTitle=!0,this.shouldSetChartAccessibilityTitle=!0,this.shouldSetChartAccessibilitySubtitle=!0,this.shouldSetChartAccessibilityLongDescription=!0,this.shouldSetChartAccessibilityContext=!0,this.shouldSetChartAccessibilityExecutiveSummary=!0,this.shouldSetChartAccessibilityPurpose=!0,this.shouldSetChartAccessibilityStatisticalNotes=!0,this.shouldSetChartAccessibilityStructureNotes=!0}centerTitleWatcher(t,i){this.shouldUpdateCenterTitle=!0}layoutWatcher(t,i){this.shouldUpdateLayout=!0,this.shouldUpdateData=!0,this.shouldResetRoot=!0,this.shouldUpdateGeometries=!0,this.shouldUpdateScales=!0,this.shouldSetPieRadius=!0,this.shouldSetGlobalSelections=!0,this.shouldEnterUpdateExit=!0,this.shouldUpdateLabels=!0,this.shouldUpdateEdgeLines=!0,this.shouldUpdateReferenceLines=!0,this.shouldUpdateAnnotations=!0}dataWatcher(t,i){this.updated=!0,this.shouldUpdateData=!0,this.shouldSetGlobalSelections=!0,this.shouldSetTestingAttributes=!0,this.shouldEnterUpdateExit=!0,this.shouldDrawInteractionState=!0,this.shouldUpdateTableData=!0,this.shouldValidate=!0,this.shouldUpdateGeometries=!0,this.shouldUpdateEdgeLines=!0,this.shouldUpdateLabels=!0,this.shouldUpdateReferenceLines=!0,this.shouldUpdateAnnotations=!0,this.shouldSetGeometryAccessibilityAttributes=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldSetTextures=!0,this.shouldSetStrokes=!0,this.shouldSetColors=!0,this.shouldCheckLabelColor=!0}idWatcher(t,i){console.error("Change detected in prop uniqueID from value "+i+" to value "+t+". This prop cannot be changed after component has loaded.")}ordinalAccessorWatcher(t,i){this.shouldValidate=!0,this.shouldUpdateData=!0,this.shouldSetGlobalSelections=!0,this.shouldUpdateTableData=!0,this.shouldUpdateGeometries=!0,this.shouldDrawInteractionState=!0,this.shouldUpdateEdgeLines=!0,this.shouldUpdateReferenceLines=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldSetLabelOpacity=!0,this.shouldCheckLabelColor=!0,this.shouldSetTextures=!0,this.shouldSetStrokes=!0,this.interactionKeys&&this.interactionKeys.length||(this.shouldValidateInteractionKeys=!0,this.shouldSetSelectionClass=!0)}valueAccessorWatcher(t,i){this.shouldValidate=!0,this.shouldUpdateData=!0,this.shouldUpdateScales=!0,this.shouldSetGlobalSelections=!0,this.shouldUpdateTableData=!0,this.shouldUpdateGeometries=!0,this.shouldUpdateEdgeLines=!0,this.shouldDrawInteractionState=!0,this.shouldSetLabelOpacity=!0,this.shouldCheckLabelColor=!0,this.shouldUpdateLabels=!0,this.shouldUpdateReferenceLines=!0,this.shouldUpdateAnnotations=!0,this.shouldSetGeometryAriaLabels=!0}sortWatcher(t,i){this.updated=!0,this.shouldUpdateData=!0,this.shouldSetGlobalSelections=!0,this.shouldSetTestingAttributes=!0,this.shouldEnterUpdateExit=!0,this.shouldDrawInteractionState=!0,this.shouldUpdateTableData=!0,this.shouldUpdateGeometries=!0,this.shouldUpdateEdgeLines=!0,this.shouldUpdateLabels=!0,this.shouldUpdateReferenceLines=!0,this.shouldUpdateAnnotations=!0,this.shouldSetGeometryAccessibilityAttributes=!0,this.shouldSetGeometryAriaLabels=!0}paletteWatcher(t,i){this.shouldSetColors=!0,this.shouldDrawInteractionState=!0,this.shouldCheckLabelColor=!0,this.shouldSetTextures=!0,this.shouldSetStrokes=!0}colorsWatcher(t,i){this.shouldSetColors=!0,this.shouldDrawInteractionState=!0,this.shouldCheckLabelColor=!0,this.shouldSetTextures=!0,this.shouldSetStrokes=!0}innerRatioWatcher(t,i){this.shouldSetPieRadius=!0,this.shouldUpdateData=!0,this.shouldUpdateInnerRatio=!0,this.shouldUpdateGeometries=!0,this.shouldUpdateEdgeLines=!0,this.shouldUpdateReferenceLines=!0}showEdgeLineWatcher(t,i){this.shouldUpdateEdgeLines=!0}referenceWatcher(t,i){this.shouldUpdateReferenceLines=!0}hoverOpacityWatcher(t,i){this.shouldDrawInteractionState=!0,this.shouldCheckLabelColor=!0,this.shouldSetLabelOpacity=!0}cursorWatcher(t,i){this.shouldUpdateCursor=!0}showPercentageWatcher(t,i){this.shouldUpdateLabels=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldUpdateTableData=!0}showTooltipWatcher(t,i){this.shouldDrawInteractionState=!0}tooltipLabelWatcher(t,i){this.shouldValidate=!0,this.shouldUpdateTableData=!0,this.shouldSetParentSVGAccessibility=!0,this.shouldSetGeometryAriaLabels=!0}labelWatcher(t,i){this.shouldUpdateLabels=!0,this.shouldValidate=!0,this.shouldUpdateTableData=!0;const s=!(!t||!t.placement)&&t.placement,h=!(!i||!i.placement)&&i.placement;(t&&t.visible)!==(i&&i.visible)&&(this.shouldSetLabelOpacity=!0),s!==h&&(this.shouldSetLabelOpacity=!0,this.shouldCheckLabelColor=!0)}labelNoteWatcher(t,i){this.shouldSetLabelOpacity=!0,this.shouldUpdateLabels=!0}labelOffsetWatcher(t,i){this.shouldUpdateLabels=!0}localizationWatcher(t,i){this.shouldValidate=!0,(!(!t||!t.language)&&t.language)!==(!(!i||!i.language)&&i.language)&&(this.shouldSetLocalizationConfig=!0,this.shouldUpdateTableData=!0,this.shouldCheckLabelColor=!0,this.shouldRedrawWrapper=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetChartAccessibilityCount=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldSetParentSVGAccessibility=!0),(!(!t||!t.numeralLocale)&&t.numeralLocale)!==(!(!i||!i.numeralLocale)&&i.numeralLocale)&&(this.shouldSetLocalizationConfig=!0,this.shouldUpdateTableData=!0,this.shouldCheckLabelColor=!0,this.shouldRedrawWrapper=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetChartAccessibilityCount=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldSetParentSVGAccessibility=!0)}accessibilityWatcher(t,i){this.shouldValidate=!0,(!(!t||!t.title)&&t.title)!==(!(!i||!i.title)&&i.title)&&(this.shouldUpdateDescriptionWrapper=!0,this.shouldSetChartAccessibilityTitle=!0,this.shouldSetParentSVGAccessibility=!0),(!(!t||!t.executiveSummary)&&t.executiveSummary)!==(!(!i||!i.executiveSummary)&&i.executiveSummary)&&(this.shouldSetChartAccessibilityExecutiveSummary=!0),(!(!t||!t.purpose)&&t.purpose)!==(!(!i||!i.purpose)&&i.purpose)&&(this.shouldSetChartAccessibilityPurpose=!0),(!(!t||!t.longDescription)&&t.longDescription)!==(!(!i||!i.longDescription)&&i.longDescription)&&(this.shouldSetChartAccessibilityLongDescription=!0),(!(!t||!t.contextExplanation)&&t.contextExplanation)!==(!(!i||!i.contextExplanation)&&i.contextExplanation)&&(this.shouldSetChartAccessibilityContext=!0),(!(!t||!t.statisticalNotes)&&t.statisticalNotes)!==(!(!i||!i.statisticalNotes)&&i.statisticalNotes)&&(this.shouldSetChartAccessibilityStatisticalNotes=!0),(!(!t||!t.structureNotes)&&t.structureNotes)!==(!(!i||!i.structureNotes)&&i.structureNotes)&&(this.shouldSetChartAccessibilityStructureNotes=!0);const s=t&&t.includeDataKeyNames,h=i&&i.includeDataKeyNames;s===h&&(!(!t||!t.elementDescriptionAccessor)&&t.elementDescriptionAccessor)===(!(!i||!i.elementDescriptionAccessor)&&i.elementDescriptionAccessor)||(s!==h&&(this.shouldSetGroupAccessibilityLabel=!0),this.shouldSetGeometryAriaLabels=!0,this.shouldSetParentSVGAccessibility=!0),(!(!t||!t.hideTextures)&&t.hideTextures)!==(!(!i||!i.hideTextures)&&i.hideTextures)&&(this.shouldSetTextures=!0,this.shouldDrawInteractionState=!0),(!(!t||!t.showSmallLabels)&&t.showSmallLabels)!==(!(!i||!i.showSmallLabels)&&i.showSmallLabels)&&(this.shouldSetLabelOpacity=!0),(!(!t||!t.hideStrokes)&&t.hideStrokes)!==(!(!i||!i.hideStrokes)&&i.hideStrokes)&&(this.shouldSetStrokes=!0,this.shouldDrawInteractionState=!0);const e=!(!t||!t.elementsAreInterface)&&t.elementsAreInterface,a=!(!i||!i.elementsAreInterface)&&i.elementsAreInterface;(!!(t&&t.keyboardNavConfig&&t.keyboardNavConfig.disabled)&&t.keyboardNavConfig.disabled)===(!!(i&&i.keyboardNavConfig&&i.keyboardNavConfig.disabled)&&i.keyboardNavConfig.disabled)&&e===a||(this.shouldSetGeometryAriaLabels=!0,this.shouldSetParentSVGAccessibility=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldRedrawWrapper=!0,this.shouldSetChartAccessibilityTitle=!0,this.shouldSetChartAccessibilitySubtitle=!0,this.shouldSetChartAccessibilityLongDescription=!0,this.shouldSetChartAccessibilityContext=!0,this.shouldSetChartAccessibilityExecutiveSummary=!0,this.shouldSetChartAccessibilityPurpose=!0,this.shouldSetChartAccessibilityStatisticalNotes=!0,this.shouldSetChartAccessibilityStructureNotes=!0),e!==a&&(this.shouldSetSelectionClass=!0)}annotationsWatcher(t,i){this.shouldValidate=!0,this.shouldUpdateAnnotations=!0,this.shouldSetAnnotationAccessibility=!0}referenceDataWatcher(t,i){this.shouldValidate=!0,this.shouldUpdateReferenceLines=!0,this.shouldUpdateTableData=!0,this.shouldSetAnnotationAccessibility=!0}suppressWatcher(t,i){this.shouldBindInteractivity=!0,this.shouldUpdateCursor=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldSetParentSVGAccessibility=!0,this.shouldUpdateDescriptionWrapper=!0,this.shouldRedrawWrapper=!0,this.shouldValidate=!0,this.shouldSetSubTitle=!0,this.shouldSetChartAccessibilityTitle=!0,this.shouldSetChartAccessibilitySubtitle=!0,this.shouldSetChartAccessibilityLongDescription=!0,this.shouldSetChartAccessibilityContext=!0,this.shouldSetChartAccessibilityExecutiveSummary=!0,this.shouldSetChartAccessibilityPurpose=!0,this.shouldSetChartAccessibilityStatisticalNotes=!0,this.shouldSetChartAccessibilityStructureNotes=!0}clickStyleWatcher(t,i){this.shouldDrawInteractionState=!0,this.shouldCheckLabelColor=!0,this.shouldSetLabelOpacity=!0,this.shouldSetStrokes=!0}hoverStyleWatcher(t,i){this.shouldDrawInteractionState=!0,this.shouldCheckLabelColor=!0,this.shouldSetLabelOpacity=!0,this.shouldSetStrokes=!0}clickWatcher(t,i){this.shouldDrawInteractionState=!0,this.shouldCheckLabelColor=!0,this.shouldSetLabelOpacity=!0,this.shouldSetSelectionClass=!0}hoverWatcher(t,i){this.shouldDrawInteractionState=!0,this.shouldCheckLabelColor=!0,this.shouldSetLabelOpacity=!0}interactionWatcher(t,i){this.shouldValidateInteractionKeys=!0,this.shouldDrawInteractionState=!0,this.shouldCheckLabelColor=!0,this.shouldSetLabelOpacity=!0,this.shouldSetSelectionClass=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldUpdateTableData=!0}dataKeyNamesWatcher(t,i){this.shouldSetParentSVGAccessibility=!0,this.shouldSetGroupAccessibilityLabel=!0,this.shouldSetGeometryAriaLabels=!0,this.shouldUpdateTableData=!0}unitTestWatcher(t,i){this.shouldSetTestingAttributes=!0}componentWillLoad(){const t=this.uniqueID||"pie-chart-"+r();return this.initialLoadEvent.emit({chartID:t}),new Promise((i=>{this.duration=0,this.chartID=t,this.pieChartEl.id=this.chartID,this.setLocalizationConfig(),this.setTagLevels(),this.prepareScales(),this.prepareData(),this.setLayoutData(),this.setPieRadius(),this.validateInteractionKeys(),this.setTableData(),this.shouldValidateAccessibilityProps(),this.shouldValidateLocalizationProps(),this.setColors(),i("component will load")}))}componentWillUpdate(){return new Promise((t=>{t("component will update")}))}componentDidLoad(){return new Promise((t=>{this.defaults=!0,this.shouldValidateAccessibilityProps(),this.shouldValidateLocalizationProps(),this.renderRootElements(),this.setTooltipInitialStyle(),this.setChartDescriptionWrapper(),this.setChartAccessibilityTitle(),this.setChartAccessibilitySubtitle(),this.setChartAccessibilityLongDescription(),this.setChartAccessibilityExecutiveSummary(),this.setChartAccessibilityPurpose(),this.setChartAccessibilityContext(),this.setChartAccessibilityStatisticalNotes(),this.setChartAccessibilityStructureNotes(),this.setParentSVGAccessibility(),this.reSetRoot(),this.setTextures(),this.setStrokes(),this.setSubTitleElements(),this.setGlobalSelections(),this.setTestingAttributes(),this.setColors(),this.setInnerRatio(),this.enterGeometries(),this.updateGeometries(),this.exitGeometries(),this.enterLabels("Labels"),this.updateLabels("Labels"),this.exitLabels("Labels"),this.enterEdgeLine(),this.updateEdgeLine("Edges"),this.exitEdgeLine(),this.enterLabels("RefLabels"),this.updateLabels("RefLabels"),this.exitLabels("RefLabels"),this.drawGeometries(),this.drawEdgeLine(),this.drawReferenceLines(),this.drawCenterTitle(),this.drawDataLabels("Labels"),this.drawDataLabels("RefLabels"),this.setChartCountAccessibility(),this.setGeometryAccessibilityAttributes(),this.setGeometryAriaLabels(),this.setSelectedClass(),this.updateCursor(),this.bindInteractivity(),this.drawAnnotations(),this.setAnnotationAccessibility(),this.onChangeHandler(),X(this.root.node(),this.pieG.node()),this.setGroupAccessibilityAttributes(),this.setGroupAccessibilityID(),this.defaults=!1,t("component did load")})).then((()=>this.initialLoadEndEvent.emit({chartID:this.chartID})))}componentDidUpdate(){return new Promise((t=>{this.duration=this.animationConfig&&this.animationConfig.disabled?0:750,this.shouldUpdateDescriptionWrapper&&(this.setChartDescriptionWrapper(),this.shouldUpdateDescriptionWrapper=!1),this.shouldSetChartAccessibilityCount&&(this.setChartCountAccessibility(),this.shouldSetChartAccessibilityCount=!1),this.shouldSetChartAccessibilityTitle&&(this.setChartAccessibilityTitle(),this.shouldSetChartAccessibilityTitle=!1),this.shouldSetChartAccessibilitySubtitle&&(this.setChartAccessibilitySubtitle(),this.shouldSetChartAccessibilitySubtitle=!1),this.shouldSetChartAccessibilityLongDescription&&(this.setChartAccessibilityLongDescription(),this.shouldSetChartAccessibilityLongDescription=!1),this.shouldSetChartAccessibilityExecutiveSummary&&(this.setChartAccessibilityExecutiveSummary(),this.shouldSetChartAccessibilityExecutiveSummary=!1),this.shouldSetChartAccessibilityPurpose&&(this.setChartAccessibilityPurpose(),this.shouldSetChartAccessibilityPurpose=!1),this.shouldSetChartAccessibilityContext&&(this.setChartAccessibilityContext(),this.shouldSetChartAccessibilityContext=!1),this.shouldSetChartAccessibilityStatisticalNotes&&(this.setChartAccessibilityStatisticalNotes(),this.shouldSetChartAccessibilityStatisticalNotes=!1),this.shouldSetChartAccessibilityStructureNotes&&(this.setChartAccessibilityStructureNotes(),this.shouldSetChartAccessibilityStructureNotes=!1),this.shouldSetParentSVGAccessibility&&(this.setParentSVGAccessibility(),this.shouldSetParentSVGAccessibility=!1),this.shouldResetRoot&&(this.reSetRoot(),this.shouldResetRoot=!1),this.shouldSetTextures&&(this.setTextures(),this.shouldSetTextures=!1),this.shouldSetStrokes&&(this.setStrokes(),this.shouldSetStrokes=!1),this.shouldSetGlobalSelections&&(this.setGlobalSelections(),this.shouldSetGlobalSelections=!1),this.shouldSetTestingAttributes&&(this.setTestingAttributes(),this.shouldSetTestingAttributes=!1),this.shouldSetSubTitle&&(this.setSubTitleElements(),this.shouldSetSubTitle=!1),this.shouldEnterUpdateExit&&(this.enterGeometries(),this.updateGeometries(),this.exitGeometries(),this.enterEdgeLine(),this.updateEdgeLine("Edges"),this.exitEdgeLine(),this.enterLabels("Labels"),this.updateLabels("Labels"),this.exitLabels("Labels"),this.enterLabels("RefLabels"),this.updateLabels("RefLabels"),this.exitLabels("RefLabels"),this.shouldEnterUpdateExit=!1),this.shouldUpdateReferenceLines&&(this.drawReferenceLines(),this.shouldUpdateReferenceLines=!1),this.shouldUpdateGeometries&&(this.drawGeometries(),this.shouldUpdateGeometries=!1),this.shouldUpdateEdgeLines&&(this.updateEdgeLine("Edges"),this.drawEdgeLine(),this.shouldUpdateEdgeLines=!1),this.shouldUpdateCenterTitle&&(this.drawCenterTitle(),this.shouldUpdateCenterTitle=!1),this.shouldUpdateLabels&&(this.drawDataLabels("Labels"),this.drawDataLabels("RefLabels"),this.shouldUpdateLabels=!1),this.shouldSetGeometryAccessibilityAttributes&&(this.setGeometryAccessibilityAttributes(),this.shouldSetGeometryAccessibilityAttributes=!1),this.shouldSetGeometryAriaLabels&&(this.setGeometryAriaLabels(),this.shouldSetGeometryAriaLabels=!1),this.shouldSetGroupAccessibilityLabel&&(this.setGroupAccessibilityID(),this.shouldSetGroupAccessibilityLabel=!1),this.shouldDrawInteractionState&&(this.updateInteractionState(),this.shouldDrawInteractionState=!1),this.shouldSetLabelOpacity&&(this.setLabelOpacity(),this.shouldSetLabelOpacity=!1),this.shouldCheckLabelColor&&(this.checkLabelColorAgainstBackground("Labels"),this.checkLabelColorAgainstBackground("RefLabels"),this.shouldCheckLabelColor=!1),this.shouldSetSelectionClass&&(this.setSelectedClass(),this.shouldSetSelectionClass=!1),this.shouldUpdateCursor&&(this.updateCursor(),this.shouldUpdateCursor=!1),this.shouldBindInteractivity&&(this.bindInteractivity(),this.shouldBindInteractivity=!1),this.shouldUpdateAnnotations&&(this.drawAnnotations(),this.shouldUpdateAnnotations=!1),this.shouldSetAnnotationAccessibility&&(this.setAnnotationAccessibility(),this.shouldSetAnnotationAccessibility=!1),this.onChangeHandler(),t("component did update")})).then((()=>this.drawEndEvent.emit({chartID:this.chartID})))}shouldValidateLocalizationProps(){const t=O(),i=t.i18Next.getResourceBundle(t.i18Next.language),s=t.numeral.localeData();this.shouldValidateLocalization&&!this.localization.skipValidation&&(this.shouldValidateLocalization=!1,Ct(this.chartID,Object.assign(Object.assign({},this.localization),{language:i,numeralLocale:s})))}shouldValidateAccessibilityProps(){if(this.shouldValidateAccessibility&&!this.accessibility.disableValidation){this.shouldValidateAccessibility=!1;const t="normalized";Nt(this.chartID,this.accessibility,{annotations:this.annotations,data:this.data,uniqueID:this.uniqueID,context:{mainTitle:this.mainTitle,onClickEvent:this.suppressEvents?void 0:this.clickEvent.emit,tooltipLabel:this.tooltipLabel,dataLabel:this.dataLabel,valueAccessor:this.valueAccessor},misc:{normalized:!!this.hasOwnProperty(t)&&this[t]}})}}validateInteractionKeys(){this.innerInteractionKeys=this.interactionKeys&&this.interactionKeys.length?this.interactionKeys:[this.ordinalAccessor]}getLanguageString(){return G(this.localization)}setLocalizationConfig(){K(this.localization)}setLayoutData(){this.padding="string"==typeof this.padding?Rt(this.padding):this.padding,this.innerHeight=this.height-this.margin.top-this.margin.bottom,this.innerWidth=this.width-this.margin.left-this.margin.right,this.innerPaddedHeight=this.innerHeight-this.padding.top-this.padding.bottom,this.innerPaddedWidth=this.innerWidth-this.padding.left-this.padding.right}setPieRadius(){this.radius=Math.min(this.innerPaddedWidth,this.innerPaddedHeight)/2,this.innerRadius=this.radius*this.innerRatio,this.outerRadius=this.radius}prepareData(){if(this.data){this.preppedData="asc"===this.sortOrder?[...this.data].sort(((t,i)=>Number(t[this.valueAccessor])-Number(i[this.valueAccessor]))):"desc"===this.sortOrder?[...this.data].sort(((t,i)=>Number(i[this.valueAccessor])-Number(t[this.valueAccessor]))):this.data;let t=0;this.preppedData.map((i=>{i[this.valueAccessor]=parseFloat(i[this.valueAccessor]),t+=i[this.valueAccessor],i.getSum=()=>t}))}if(this.refArr=[],this.referenceData&&this.referenceData.length){let t=0;this.preppedData.map((i=>t+=i[this.valueAccessor])),this.referenceData.forEach((i=>{const s=[];s.push(i),s.push({[this.ordinalAccessor]:"",[this.valueAccessor]:t-i[this.valueAccessor]});const h=this.pie(s);this.refArr.push(Object.assign({},h[0]))}))}this.pieData=this.pie(this.preppedData),this.refData=this.refArr}prepareScales(){this.pie=function(){var t=M,i=z,s=null,h=l(0),e=l(p),a=l(0);function n(n){var r,o,l,d,u,g=(n=c(n)).length,f=0,b=new Array(g),y=new Array(g),v=+h.apply(this,arguments),m=Math.min(p,Math.max(-p,e.apply(this,arguments)-v)),A=Math.min(Math.abs(m)/g,a.apply(this,arguments)),L=A*(m<0?-1:1);for(r=0;r<g;++r)(u=y[b[r]=r]=+t(n[r],r,n))>0&&(f+=u);for(null!=i?b.sort((function(t,s){return i(y[t],y[s])})):null!=s&&b.sort((function(t,i){return s(n[t],n[i])})),r=0,l=f?(m-g*L)/f:0;r<g;++r,v=d)y[o=b[r]]={data:n[o],index:r,value:u=y[o],startAngle:v,endAngle:d=v+(u>0?u*l:0)+L,padAngle:A};return y}return n.value=function(i){return arguments.length?(t="function"==typeof i?i:l(+i),n):t},n.sortValues=function(t){return arguments.length?(i=t,s=null,n):i},n.sort=function(t){return arguments.length?(s=t,i=null,n):s},n.startAngle=function(t){return arguments.length?(h="function"==typeof t?t:l(+t),n):h},n.endAngle=function(t){return arguments.length?(e="function"==typeof t?t:l(+t),n):e},n.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:l(+t),n):a},n}().value((t=>t[this.valueAccessor])).sort((()=>null)),this.arc=function(){var t=T,i=k,s=l(0),h=null,e=S,a=D,n=N,r=null,c=o(L);function L(){var o,l,L=+t.apply(this,arguments),W=+i.apply(this,arguments),w=e.apply(this,arguments)-d,T=a.apply(this,arguments)-d,k=y(T-w),S=T>w;if(r||(r=o=c()),W<L&&(l=W,W=L,L=l),W>u)if(k>p-u)r.moveTo(W*g(w),W*f(w)),r.arc(0,0,W,w,T,!S),L>u&&(r.moveTo(L*g(T),L*f(T)),r.arc(0,0,L,T,w,S));else{var D,N,z=w,M=T,I=w,P=T,O=k,K=k,G=n.apply(this,arguments)/2,$=G>u&&(h?+h.apply(this,arguments):A(L*L+W*W)),H=b(y(W-L)/2,+s.apply(this,arguments)),j=H,q=H;if($>u){var F=x($/L*f(G)),V=x($/W*f(G));(O-=2*F)>u?(I+=F*=S?1:-1,P-=F):(O=0,I=P=(w+T)/2),(K-=2*V)>u?(z+=V*=S?1:-1,M-=V):(K=0,z=M=(w+T)/2)}var _=W*g(z),B=W*f(z),U=L*g(P),J=L*f(P);if(H>u){var Q,X=W*g(M),Y=W*f(M),Z=L*g(I),tt=L*f(I);if(k<m)if(Q=C(_,B,Z,tt,X,Y,U,J)){var it=_-Q[0],st=B-Q[1],ht=X-Q[0],et=Y-Q[1],at=1/f(R((it*ht+st*et)/(A(it*it+st*st)*A(ht*ht+et*et)))/2),nt=A(Q[0]*Q[0]+Q[1]*Q[1]);j=b(H,(L-nt)/(at-1)),q=b(H,(W-nt)/(at+1))}else j=q=0}K>u?q>u?(D=E(Z,tt,_,B,W,q,S),N=E(X,Y,U,J,W,q,S),r.moveTo(D.cx+D.x01,D.cy+D.y01),q<H?r.arc(D.cx,D.cy,q,v(D.y01,D.x01),v(N.y01,N.x01),!S):(r.arc(D.cx,D.cy,q,v(D.y01,D.x01),v(D.y11,D.x11),!S),r.arc(0,0,W,v(D.cy+D.y11,D.cx+D.x11),v(N.cy+N.y11,N.cx+N.x11),!S),r.arc(N.cx,N.cy,q,v(N.y11,N.x11),v(N.y01,N.x01),!S))):(r.moveTo(_,B),r.arc(0,0,W,z,M,!S)):r.moveTo(_,B),L>u&&O>u?j>u?(D=E(U,J,X,Y,L,-j,S),N=E(_,B,Z,tt,L,-j,S),r.lineTo(D.cx+D.x01,D.cy+D.y01),j<H?r.arc(D.cx,D.cy,j,v(D.y01,D.x01),v(N.y01,N.x01),!S):(r.arc(D.cx,D.cy,j,v(D.y01,D.x01),v(D.y11,D.x11),!S),r.arc(0,0,L,v(D.cy+D.y11,D.cx+D.x11),v(N.cy+N.y11,N.cx+N.x11),S),r.arc(N.cx,N.cy,j,v(N.y11,N.x11),v(N.y01,N.x01),!S))):r.arc(0,0,L,P,I,S):r.lineTo(U,J)}else r.moveTo(0,0);if(r.closePath(),o)return r=null,o+""||null}return L.centroid=function(){var s=(+t.apply(this,arguments)+ +i.apply(this,arguments))/2,h=(+e.apply(this,arguments)+ +a.apply(this,arguments))/2-m/2;return[g(h)*s,f(h)*s]},L.innerRadius=function(i){return arguments.length?(t="function"==typeof i?i:l(+i),L):t},L.outerRadius=function(t){return arguments.length?(i="function"==typeof t?t:l(+t),L):i},L.cornerRadius=function(t){return arguments.length?(s="function"==typeof t?t:l(+t),L):s},L.padRadius=function(t){return arguments.length?(h=null==t?null:"function"==typeof t?t:l(+t),L):h},L.startAngle=function(t){return arguments.length?(e="function"==typeof t?t:l(+t),L):e},L.endAngle=function(t){return arguments.length?(a="function"==typeof t?t:l(+t),L):a},L.padAngle=function(t){return arguments.length?(n="function"==typeof t?t:l(+t),L):n},L.context=function(t){return arguments.length?(r=null==t?null:t,L):r},L}()}setTableData(){const t=St(this,gt,"pie-chart");if(this.showPercentage){const i=this.dataKeyNames&&(this.dataKeyNames[`${this.valueAccessor}`]||this.dataKeyNames[`${this.valueAccessor}%`])?this.dataKeyNames[`${this.valueAccessor}%`]||this.dataKeyNames[`${this.valueAccessor}`]+" (%)":`${this.valueAccessor}%`;t[i]="0[.][0][0]%",this.preppedData.forEach((t=>{t[i]=t[`${this.valueAccessor}`]/t.getSum()}))}this.tableData=Wt(this.preppedData,t),this.tableColumns=Object.keys(t)}setSubTitleElements(){Ot({root:this.subTitleG,subTitle:this.subTitle})}setColors(){const t=this.colors&&this.colors.length?vt(this.colors):Lt(this.colorPalette,this.preppedData.length-1);this.colors&&this.colors.length||t.push(Dt.base_grey),this.preparedColors=t}setTextures(){const t=this.preparedColors.range?this.preparedColors.range():this.preparedColors;if(this.accessibility.hideTextures||t.length>6)this.colorArr=this.preparedColors;else{const i=V({colors:t,rootSVG:this.svg.node(),id:this.chartID,scheme:"categorical",disableTransitions:!this.duration});this.colorArr=this.preparedColors.range?this.preparedColors.copy().range(i):i}}setStrokes(){this.strokes=F({root:this.svg.node(),id:this.chartID,colors:this.preparedColors.range?this.preparedColors.range():this.preparedColors,clickStyle:this.clickStyle,hoverStyle:this.hoverStyle,stacked:!0})}setInnerRatio(){this.innerRatio=0===this.innerRatio||this.innerRatio?this.innerRatio:P.innerRatio}setTestingAttributes(){this.unitTest?(a(this.pieChartEl).select(".visa-viz-d3-pie-container").attr("data-testid","chart-container"),a(this.pieChartEl).select(".pie-main-title").attr("data-testid","main-title"),a(this.pieChartEl).select(".pie-sub-title").attr("data-testid","sub-title"),this.svg.attr("data-testid","root-svg"),this.root.attr("data-testid","margin-container"),this.rootG.attr("data-testid","padding-container"),this.tooltipG.attr("data-testid","tooltip-container"),this.pieG.attr("data-testid","pie-group"),this.labelG.attr("data-testid","dataLabel-group"),this.refLabelG.attr("data-testid","refDataLabel-group"),this.edgeG.attr("data-testid","edgeLine-group"),this.rootG.select(".pie-center-title-group").attr("data-testid","centerTitle-group"),this.svg.select("defs").attr("data-testid","pattern-defs"),this.updatingLabels.attr("data-testid","dataLabel").attr("data-id",(t=>`label-${t[this.ordinalAccessor]}`)),this.updatingLabelsNotes.attr("data-testid","dataLabel-note").attr("data-id",(t=>`label-note-${t[this.ordinalAccessor]}`)),this.updatingEdges.attr("data-testid","pie-edge-line").attr("data-id",(t=>`pie-edge-line-${t[this.ordinalAccessor]}`)),this.update.attr("data-testid","pie").attr("data-id",(t=>`pie-${t[this.ordinalAccessor]}`)),this.references.selectAll(".arc-ref").attr("data-testid","reference-arc-line"),this.updatingRefLabels.attr("data-testid","refDataLabel").attr("data-id",(t=>`ref-label-${t[this.ordinalAccessor]}`)),this.updatingRefLabelsNotes.attr("data-testid","refDataLabel-note").attr("data-id",(t=>`ref-label-note-${t[this.ordinalAccessor]}`))):(a(this.pieChartEl).select(".visa-viz-d3-pie-container").attr("data-testid",null),a(this.pieChartEl).select(".pie-main-title").attr("data-testid",null),a(this.pieChartEl).select(".pie-sub-title").attr("data-testid",null),this.svg.attr("data-testid",null),this.root.attr("data-testid",null),this.rootG.attr("data-testid",null),this.tooltipG.attr("data-testid",null),this.pieG.attr("data-testid",null),this.labelG.attr("data-testid",null),this.refLabelG.attr("data-testid",null),this.edgeG.attr("data-testid",null),this.rootG.select(".pie-center-title-group").attr("data-testid",null),this.svg.select("defs").attr("data-testid",null),this.updatingLabels.attr("data-testid",null).attr("data-id",null),this.updatingLabelsNotes.attr("data-testid",null).attr("data-id",null),this.updatingEdges.attr("data-testid",null).attr("data-id",null),this.update.attr("data-testid",null).attr("data-id",null),this.references.selectAll(".arc-ref").attr("data-testid",null),this.updatingRefLabels.attr("data-testid",null).attr("data-id",null),this.updatingRefLabelsNotes.attr("data-testid",null).attr("data-id",null))}renderRootElements(){this.svg=a(this.pieChartEl).select(".visa-viz-d3-pie-container").append("svg").style("isolation","isolate").attr("width",this.width).attr("height",this.height).attr("viewBox","0 0 "+this.width+" "+this.height),this.root=this.svg.append("g").attr("id","visa-viz-margin-container-g-"+this.chartID),this.rootG=this.root.append("g").attr("id","visa-viz-padding-container-g-"+this.chartID),this.pieG=this.rootG.append("g").attr("class","pie-group"),this.labelG=this.rootG.append("g").attr("class","pie-dataLabel-group"),this.refLabelG=this.rootG.append("g").attr("class","pie-dataLabel-group"),this.edgeG=this.rootG.append("g").attr("class","pie-edge-line-group"),this.subTitleG=a(this.pieChartEl).select(".pie-sub-title"),this.tooltipG=a(this.pieChartEl).select(".pie-tooltip"),this.references=this.rootG.append("g").attr("class","pie-reference-line-group")}reSetRoot(){zt({selection:this.svg,duration:this.duration,namespace:"root_reset",easing:W}).attr("width",this.width).attr("height",this.height).attr("viewBox","0 0 "+this.width+" "+this.height),zt({selection:this.root,duration:this.duration,namespace:"root_reset",easing:W}).attr("transform",`translate(${this.margin.left}, ${this.margin.top})`),zt({selection:this.rootG,duration:this.duration,namespace:"root_reset",easing:W}).attr("transform",`translate(${this.padding.left+this.radius}, ${this.padding.top+this.radius})`),dt(this.chartID,this.width)}setGlobalSelections(){const t=this.pieG.selectAll(".arc").data(this.pieData,(t=>(t[this.ordinalAccessor]=t.data[this.ordinalAccessor],t[this.ordinalAccessor])));this.enter=t.enter().append("path"),this.exit=t.exit(),this.update=t.merge(this.enter),this.exitSize=this.exit.size(),this.enterSize=this.enter.size();const i=this.labelG.selectAll(".pie-dataLabel-highlight").data(this.pieData);this.enteringLabels=i.enter().append("text"),this.exitingLabels=i.exit(),this.updatingLabels=i.merge(this.enteringLabels);const s=this.labelG.selectAll(".pie-dataLabel-note").data(this.pieData);this.enteringLabelsNotes=s.enter().append("text"),this.exitingLabelsNotes=s.exit(),this.updatingLabelsNotes=s.merge(this.enteringLabelsNotes);const h=this.refLabelG.selectAll(".pie-dataLabel-highlight").data(this.refData);this.enteringRefLabels=h.enter().append("text"),this.exitingRefLabels=h.exit(),this.updatingRefLabels=h.merge(this.enteringRefLabels);const e=this.refLabelG.selectAll(".pie-dataLabel-note").data(this.refData);this.enteringRefLabelsNotes=e.enter().append("text"),this.exitingRefLabelsNotes=e.exit(),this.updatingRefLabelsNotes=e.merge(this.enteringRefLabelsNotes);const a=this.edgeG.selectAll(".edge-line").data(this.pieData);this.enteringEdges=a.enter().append("path"),this.exitingEdges=a.exit(),this.updatingEdges=a.merge(this.enteringEdges)}updateInteractionState(){q(this.svg.node()),this.update.attr("opacity",(t=>ft(t.data,1,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys))).attr("fill",((t,i)=>this.clickHighlight&&this.clickHighlight.length>0&&bt(t.data,this.clickHighlight,this.innerInteractionKeys)&&this.clickStyle.color?Dt[this.clickStyle.color]||this.clickStyle.color:this.hoverHighlight&&yt(t.data,this.hoverHighlight,this.innerInteractionKeys)&&this.hoverStyle.color?Dt[this.hoverStyle.color]||this.hoverStyle.color:2===this.preppedData.length&&1===i?this.preparedColors[i]:this.colorArr[i]||this.colorArr[0])).attr("filter",((t,i,s)=>{if(!this.accessibility.hideStrokes&&!a(s[i]).classed("geometryIsMoving")){const h=this.clickHighlight&&this.clickHighlight.length>0&&bt(t.data,this.clickHighlight,this.innerInteractionKeys),e=this.hoverHighlight&&yt(t.data,this.hoverHighlight,this.innerInteractionKeys),n=this.preparedColors[i],r=h?"click":e&&!a(s[i]).classed("geometryIsMoving")?"hover":"rest",o=h&&this.clickStyle.color?Dt[this.clickStyle.color]||this.clickStyle.color:h?n:e&&this.hoverStyle.color?Dt[this.hoverStyle.color]||this.hoverStyle.color:n;return"hover"===r&&j({inputElement:s[i],id:this.chartID,key:t[this.ordinalAccessor],strokeWidth:this.hoverStyle.strokeWidth,fill:o}),this.strokes[r+o]}return null})),ot({parentGNode:this.rootG.node()})}setLabelOpacity(){const t=this.dataLabel.visible?1:0,i=this.showLabelNote?1:0,s=this.updatingLabels.merge(this.updatingRefLabels),h=this.updatingLabelsNotes.merge(this.updatingRefLabelsNotes);if(s.attr("data-use-dx",!0).attr("data-use-dy",!0).attr("opacity",((i,s,h)=>{const e=+a(h[s]).attr("opacity"),n=a(h[s]).style("visibility"),r=ft(i.data,t,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)<1?0:1;return(1===r&&"hidden"===n||e!==r)&&(1===r?a(h[s]).classed("collision-added",!0).style("visibility",null):a(h[s]).classed("collision-removed",!0)),r})),h.attr("data-use-dx",!0).attr("data-use-dy",!0).attr("opacity",((t,s,h)=>{const e=+a(h[s]).attr("opacity"),n=a(h[s]).style("visibility"),r=ft(t.data,i,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)<1?0:1;return(1===r&&"hidden"===n||e!==r)&&(1===r?a(h[s]).classed("collision-added",!0).style("visibility",null):a(h[s]).classed("collision-removed",!0)),r})),this.dataLabel.collisionHideOnly){const t=s.filter(((t,i,s)=>a(s[i]).classed("collision-added"))),i=s.filter(((t,i,s)=>a(s[i]).classed("collision-removed"))),e=h.filter(((t,i,s)=>a(s[i]).classed("collision-added"))),n=h.filter(((t,i,s)=>a(s[i]).classed("collision-removed"))),r=["middle"],o=[1];i.size()>0&&(this.bitmaps=Pt({bitmaps:this.bitmaps,labelSelection:i,avoidMarks:[],validPositions:["middle"],offsets:[1],accessors:["key"],size:[Mt(this.width,0),Mt(this.height,0)],hideOnly:!1,removeOnly:!0}),i.classed("collision-removed",!1)),n.size()>0&&(this.bitmaps=Pt({bitmaps:this.bitmaps,labelSelection:n,avoidMarks:[],validPositions:["middle"],offsets:[1],accessors:["key"],size:[Mt(this.width,0),Mt(this.height,0)],hideOnly:!1,removeOnly:!0}),n.classed("collision-removed",!1)),t.size()>0&&(this.bitmaps=Pt({bitmaps:this.bitmaps,labelSelection:t,avoidMarks:[],validPositions:r,offsets:o,accessors:[this.ordinalAccessor],size:[Mt(this.width,0),Mt(this.height,0)],hideOnly:this.dataLabel.visible&&this.dataLabel.collisionHideOnly,suppressMarkDraw:!0}),t.classed("collision-added",!1)),e.size()>0&&(this.bitmaps=Pt({bitmaps:this.bitmaps,labelSelection:e,avoidMarks:[],validPositions:r,offsets:o,accessors:[this.ordinalAccessor],size:[Mt(this.width,0),Mt(this.height,0)],hideOnly:this.dataLabel.visible&&this.dataLabel.collisionHideOnly,suppressMarkDraw:!0}),e.classed("collision-added",!1))}}checkLabelColorAgainstBackground(t){const i="RefLabels"===t?"edge":this.dataLabel.placement;this.updatingLabels.attr("fill",((t,s,h)=>this.textTreatmentHandler(t,s,h,i)))}enterGeometries(){this.enter.interrupt(),this.enter.attr("class","arc").classed("entering",!0).attr("opacity",0).on("click",this.suppressEvents?null:(t,i,s)=>this.onClickHandler(t.data,s[i])).on("mouseover",this.suppressEvents?null:(t,i,s)=>this.onHoverHandler(t.data,s[i])).on("mouseout",this.suppressEvents?null:()=>this.onMouseOutHandler()).attr("cursor",this.suppressEvents?null:this.cursor).each(((t,i,s)=>{B(s[i])})),this.update.order()}updateGeometries(){this.update.interrupt(),this.update.transition("opacity").duration(this.duration).ease(W).attr("opacity",(t=>ft(t.data,1,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)))}exitGeometries(){this.exit.interrupt(),this.exit.transition("exit").duration(this.duration).ease(W).attr("opacity",0)[this.duration?"attrTween":"attr"]("d",((t,i,s)=>{const h={startAngle:0,endAngle:0,innerRadius:this.innerRadius,outerRadius:this.outerRadius};if(!this.duration)return this.arc(h);const e=s[i],a=w(e._current,h);return t=>(e._current=a(t),this.arc(e._current))})),this.update.transition("accessibilityAfterExit").duration(this.duration).ease(W).call(Tt,(()=>{const t=lt(this.rootG.node());this.exit.remove(),this.setChartCountAccessibility(),this.setGroupAccessibilityID(),this.setGeometryAriaLabels(),ot({parentGNode:this.rootG.node(),focusDidExist:t})}))}drawGeometries(){this.update.classed("geometryIsMoving",((t,i,s)=>$(a(s[i]),[{attr:"d",newValue:this.arc({startAngle:t.startAngle,endAngle:t.endAngle,innerRadius:this.innerRadius,outerRadius:this.outerRadius})}]))).attr("data-translate-x",this.radius+this.padding.left+this.margin.left).attr("data-translate-y",this.radius+this.padding.top+this.margin.top).attr("data-d",((t,i,s)=>{let h="inner",e=0;"inside"!==this.dataLabel.placement&&(h="outer",e=this.labelOffset);const n={startAngle:t.startAngle,endAngle:t.endAngle,innerRadius:this.innerRadius,outerRadius:this.outerRadius},r={startAngle:t.startAngle,endAngle:t.endAngle,innerRadius:this[h+"Radius"]+e,outerRadius:this.outerRadius+e};return a(s[i]).attr("data-fake-x",this.arc.centroid(r)[0]).attr("data-fake-y",this.arc.centroid(r)[1]).attr("data-r",1),this.arc(n)})).transition("update").duration(this.duration).ease(W)[this.duration?"attrTween":"attr"]("d",((t,i,s)=>{const h=s[i];let e=h._current;const n={startAngle:t.startAngle,endAngle:t.endAngle,innerRadius:this.innerRadius,outerRadius:this.outerRadius};a(s[i]).classed("entering")&&(e={startAngle:0,endAngle:0,innerRadius:this.innerRadius,outerRadius:this.outerRadius},a(s[i]).classed("entering",!1));const r=w(e,n);return this.duration?t=>(h._current=r(t),this.arc(h._current)):(h._current=r(1),this.arc(n))})).call(Tt,(()=>{this.update.classed("geometryIsMoving",!1),this.updateInteractionState(),ot({parentGNode:this.rootG.node()}),this.transitionEndEvent.emit({chartID:this.chartID})}))}setSelectedClass(){this.update.classed("highlight",(t=>{const i=ft(t.data,!0,!1,"",this.clickHighlight,this.innerInteractionKeys);return!(!this.clickHighlight||!this.clickHighlight.length)&&i})).each(((t,i,s)=>{let h=ft(t.data,!0,!1,"",this.clickHighlight,this.innerInteractionKeys);h=!(!this.clickHighlight||!this.clickHighlight.length)&&h,ct(s[i],h,this.accessibility.elementsAreInterface)}))}drawReferenceLines(){const t=this.references.selectAll(".arc-ref").data(this.refData),i=t.enter().append("path").attr("opacity",0).attr("class","arc-ref").attr("fill","none").attr("stroke-width",0).classed("entering",!0).each(((t,i,s)=>{B(s[i])}));t.exit().transition("exit").duration(this.duration).ease(W).attr("opacity",0)[this.duration?"attrTween":"attr"]("d",((t,i,s)=>{const h=s[i],e=h._current,a={startAngle:0,endAngle:0,innerRadius:Math.max(0,this.innerRadius-5),outerRadius:this.outerRadius+5},n=w(e,a);return this.duration?t=>(h._current=n(t),this.arc(h._current)):this.arc(a)})).remove(),this.updateRefPie=t.merge(i).classed("ignore",((t,i)=>0!==i)),this.updateRefPie.attr("opacity",this.referenceStyle.opacity).attr("stroke-dasharray",this.referenceStyle.dashed).transition("update").duration(this.duration).ease(W).attr("stroke-width",0!==this.innerRatio?3:0).attr(0!==this.innerRatio?"fill":"stroke","rgba(0,0,0,0)").attr(0!==this.innerRatio?"stroke":"fill",((t,i)=>Dt[this.referenceStyle.color]||this.referenceStyle.color||this.preparedColors[i]))[this.duration?"attrTween":"attr"]("d",((t,i,s)=>{const h={startAngle:t.endAngle,endAngle:t.endAngle,innerRadius:Math.max(0,this.innerRadius-5),outerRadius:this.outerRadius+5},e=s[i];let n=e._current;a(e).classed("entering")&&(n={startAngle:0,endAngle:0,innerRadius:Math.max(0,this.innerRadius-5),outerRadius:this.outerRadius+5},a(e).classed("entering",!1));const r=w(n,h);return this.duration?t=>(e._current=r(t),this.arc(e._current)):(e._current=r(1),this.arc(h))}))}enterLabels(t){const i="RefLabels"===t?"edge":this.dataLabel.placement,s=this.dataLabel.visible?1:0,h=this.showLabelNote?1:0;this["entering"+t].attr("class","pie-dataLabel-highlight").attr("opacity",0).attr("opacity",(t=>ft(t.data,s,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)<1?0:Number.EPSILON)).classed("entering",!0).attr("fill",((t,s,h)=>this.textTreatmentHandler(t,s,h,i))).attr("cursor",this.suppressEvents||"RefLabels"===t?null:this.cursor).on("click",this.suppressEvents||"RefLabels"===t?null:(t,i,s)=>this.onClickHandler(t.data,s[i])).on("mouseover",this.suppressEvents||"RefLabels"===t?null:(t,i,s)=>this.onHoverHandler(t.data,s[i])).on("mouseout",this.suppressEvents||"RefLabels"===t?null:()=>this.onMouseOutHandler()),this["entering"+t+"Notes"].attr("class","pie-dataLabel-note").attr("opacity",0).attr("opacity",(t=>ft(t.data,h,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)<1?0:Number.EPSILON)).classed("entering",!0).attr("cursor",this.suppressEvents||"RefLabels"===t?null:this.cursor).on("click",this.suppressEvents||"RefLabels"===t?null:(t,i,s)=>this.onClickHandler(t.data,s[i])).on("mouseover",this.suppressEvents||"RefLabels"===t?null:(t,i,s)=>this.onHoverHandler(t.data,s[i])).on("mouseout",this.suppressEvents||"RefLabels"===t?null:()=>this.onMouseOutHandler())}updateLabels(t){this.updatingLabels.interrupt();const i=this.dataLabel.visible?1:0,s=this.showLabelNote?1:0;this["updating"+t].transition("opacity").ease(W).duration(this.duration).attr("opacity",(t=>ft(t.data,i,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)<1?0:1)),this["updating"+t+"Notes"].transition("opacity").duration(this.duration).ease(W).attr("opacity",(t=>ft(t.data,s,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)<1?0:1))}exitLabels(t){const i="RefLabels"===t?"edge":this.dataLabel.placement;this["exiting"+t].transition("exit").duration(this.duration).ease(W).attr("opacity",0)[this.duration?"attrTween":"attr"]("x",((s,h,e)=>{const n=e[h];let r="inner",o=0;"inside"!==i&&(r="outer",o=this.labelOffset);const l={startAngle:0,start:0,endAngle:0,innerRadius:this[r+"Radius"]+o,outerRadius:this.outerRadius+o};if(!this.duration)return a(n).attr("y",this.arc.centroid(l)[1]),a(n).text("edge"===i&&h===this.preppedData.length-1&&"RefLabels"!==t?"":this.showPercentage?At((s.endAngle-s.startAngle)/(2*Math.PI),"0.0%"):this.dataLabel.format?At(s.data[this.valueAccessor],this.dataLabel.format):s.data[this.valueAccessor]),this.arc.centroid(l)[0];const c=w(n._current,l);return s=>(n._current=c(s),a(n).attr("y",this.arc.centroid(n._current)[1]),a(n).text("edge"===i&&h===this.preppedData.length-1&&"RefLabels"!==t?"":this.showPercentage?At((n._current.endAngle-n._current.start)/(2*Math.PI),"0.[0]%"):this.dataLabel.format?At(n._current.value,this.dataLabel.format):n._current.value),this.arc.centroid(n._current)[0])})).remove(),this["exiting"+t+"Notes"].transition("exit").duration(this.duration).ease(W).attr("opacity",0)[this.duration?"attrTween":"attr"]("x",((t,s,h)=>{const e=h[s];let n="inner",r=0;"inside"!==i&&(n="outer",r=this.labelOffset);const o={value:0,startAngle:0,endAngle:0,innerRadius:this[n+"Radius"]+r,outerRadius:this.outerRadius+r};if(!this.duration)return a(e).attr("y",this.arc.centroid(o)[1]),this.arc.centroid(o)[0];const l=w(e._current,o);return t=>(e._current=l(t),a(e).attr("y",this.arc.centroid(e._current)[1]),this.arc.centroid(e._current)[0])})).remove()}drawDataLabels(t){const i="RefLabels"===t?"edge":this.dataLabel.placement;if("Labels"===t&&this.dataLabel.visible&&this.dataLabel.collisionHideOnly){let t=this.rootG.select(".pie-center-title-group").selectAll("text");this.bitmaps=Pt({labelSelection:a(".empty-stuff-vcc-do-not-use"),avoidMarks:[t,this.updatingEdges,this.update],validPositions:["middle"],offsets:[1],accessors:[this.ordinalAccessor],size:[Mt(this.width,0),Mt(this.height,0)]})}this["updating"+t].style("visibility",((t,i,s)=>"auto"===this.dataLabel.placement||this.dataLabel.collisionHideOnly?a(s[i]).style("visibility"):null)).transition("update").duration(this.duration).ease(W)[this.duration?"attrTween":"attr"]("x",((s,h,e)=>{const n=e[h];let r=n._current,o="innerRadius",l=0,c="startAngle";"inside"!==i&&(o="outerRadius",l=this.labelOffset),"edge"===i&&(c="endAngle");const d={value:s.data[this.valueAccessor],start:s.startAngle,startAngle:s[c],endAngle:s.endAngle,innerRadius:this[o]+l,outerRadius:this.outerRadius+l};a(n).attr("data-use-dx",!0).attr("data-use-dy",!0).attr("data-translate-x",this.radius+this.padding.left+this.margin.left).attr("data-translate-y",this.radius+this.padding.top+this.margin.top).attr("data-x",this.arc.centroid(d)[0]).attr("data-y",this.arc.centroid(d)[1]).attr("data-r",1).attr("dx",0).attr("dy","inside"===i?"0.1em":0).attr("text-anchor","inside"===i?"middle":"edge"===i?s.endAngle<Math.PI?"start":"end":s.startAngle+(s.endAngle-s.startAngle)/2<Math.PI?"start":"end").text("edge"===i&&h===this.preppedData.length-1&&"RefLabels"!==t?"":this.showPercentage?At((s.endAngle-s.startAngle)/(2*Math.PI),"0.0%"):this.dataLabel.format?At(s.data[this.valueAccessor],this.dataLabel.format):s.data[this.valueAccessor]),a(n).classed("entering")&&(r={value:s.data[this.valueAccessor],start:s.startAngle,startAngle:0,endAngle:0,innerRadius:this[o]+l,outerRadius:this.outerRadius+l},a(n).classed("entering",!1));const u=w(r,d);if(this.dataLabel.visible&&this.dataLabel.collisionHideOnly){const t=["middle"],i=[1];this.bitmaps=Pt({bitmaps:this.bitmaps,labelSelection:a(n),avoidMarks:[],validPositions:t,offsets:i,accessors:[this.ordinalAccessor],size:[Mt(this.width,0),Mt(this.height,0)],hideOnly:this.dataLabel.visible&&this.dataLabel.collisionHideOnly})}return this.duration?s=>(n._current=u(s),a(n).attr("y",this.arc.centroid(n._current)[1]),a(n).text("edge"===i&&h===this.preppedData.length-1&&"RefLabels"!==t?"":this.showPercentage?At((n._current.endAngle-n._current.start)/(2*Math.PI),"0.0%"):this.dataLabel.format?At(n._current.value,this.dataLabel.format):n._current.value),this.arc.centroid(n._current)[0]):(n._current=u(1),a(n).attr("y",this.arc.centroid(d)[1]),a(n).text("edge"===i&&h===this.preppedData.length-1&&"RefLabels"!==t?"":this.showPercentage?At((s.endAngle-s.startAngle)/(2*Math.PI),"0.0%"):this.dataLabel.format?At(s.data[this.valueAccessor],this.dataLabel.format):s.data[this.valueAccessor]),this.arc.centroid(d)[0])})).call(Tt,(()=>{})),this["updating"+t+"Notes"].style("visibility",((t,i,s)=>"auto"===this.dataLabel.placement||this.dataLabel.collisionHideOnly?a(s[i]).style("visibility"):null)).transition("update").duration(this.duration).ease(W)[this.duration?"attrTween":"attr"]("x",((s,h,e)=>{const n=e[h];let r=n._current;const o="edge"===i?"endAngle":"startAngle";a(e[h]).classed("entering")&&(r={startAngle:0,endAngle:0,innerRadius:this.outerRadius+this.labelOffset,outerRadius:this.outerRadius+this.labelOffset},a(e[h]).classed("entering",!1));const l={startAngle:s[o],endAngle:s.endAngle,innerRadius:this.outerRadius+this.labelOffset,outerRadius:this.outerRadius+this.labelOffset};a(n).attr("data-use-dx",!0).attr("data-use-dy",!0).attr("data-translate-x",this.radius+this.padding.left+this.margin.left).attr("data-translate-y",this.radius+this.padding.top+this.margin.top+5).attr("data-x",this.arc.centroid(l)[0]).attr("data-y",this.arc.centroid(l)[1]).attr("dx",0).text("edge"===i&&h===this.preppedData.length-1&&"RefLabels"!==t?"":s.data[this.ordinalAccessor]).attr("dy","inside"===i?0:"1.4em").attr("text-anchor","edge"===i?s.endAngle<Math.PI?"start":"end":s.startAngle+(s.endAngle-s.startAngle)/2<Math.PI?"start":"end");const c=w(r,l);if(this.showLabelNote&&this.dataLabel.visible&&this.dataLabel.collisionHideOnly){const t=["middle"],i=[1];this.bitmaps=Pt({bitmaps:this.bitmaps,labelSelection:a(n),avoidMarks:[],validPositions:t,offsets:i,accessors:[this.ordinalAccessor],size:[Mt(this.width,0),Mt(this.height,0)],hideOnly:this.showLabelNote&&this.dataLabel.visible&&this.dataLabel.collisionHideOnly})}return this.duration?t=>(n._current=c(t),a(n).attr("y",this.arc.centroid(n._current)[1]),this.arc.centroid(n._current)[0]):(n._current=c(1),a(n).attr("y",this.arc.centroid(l)[1]),this.arc.centroid(l)[0])})).call(Tt,(()=>{}))}drawCenterTitle(){let t=this.rootG.select(".pie-center-title-group");this.defaults&&(t=this.rootG.append("g").attr("class","pie-center-title-group").style("opacity",1),t.append("text").attr("class","visa-ui-header--1 visa-viz-title").attr("text-anchor","middle").attr("x",0).attr("y",0).attr("fill",Dt.dark_text),t.append("text").attr("class","visa-ui-text--body visa-viz-subtitle").attr("text-anchor","middle").attr("x",0).attr("fill",Dt.dark_text)),t.select(".visa-viz-title").text(this.centerTitle).attr("data-fill",!0).attr("data-width",((t,i,s)=>{if(this.dataLabel.visible&&this.dataLabel.collisionHideOnly){const t=s[i],h=getComputedStyle(t),e=parseFloat(h.fontSize),n=It(t.textContent,e,!0,h.fontFamily),r=Math.max(e-1,1);return a(t).attr("data-x",0).attr("data-y",-r/2).attr("data-height",r).attr("data-translate-x",this.radius+this.padding.left+this.margin.left).attr("data-translate-y",this.radius+this.padding.top+this.margin.top),n}})),t.select(".visa-viz-subtitle").attr("data-x",0).attr("data-y",this.centerTitle?20:10).attr("y",this.centerTitle?20:10).text(this.centerSubTitle).attr("data-fill",!0).attr("data-width",((t,i,s)=>{if(this.dataLabel.visible&&this.dataLabel.collisionHideOnly){const t=s[i],h=getComputedStyle(t),e=parseFloat(h.fontSize),n=It(t.textContent,e,!0,h.fontFamily),r=Math.max(e-1,1);return a(t).attr("data-x",0).attr("data-y",(this.centerTitle?20:10)-r/2).attr("data-height",r).attr("data-translate-x",this.radius+this.padding.left+this.margin.left).attr("data-translate-y",this.radius+this.padding.top+this.margin.top),n}}));const i=H({root:this.svg.node(),id:this.chartID,color:"#ffffff"});t.attr("filter",i)}enterEdgeLine(){this.enteringEdges.attr("class","edge-line").attr("opacity",0).classed("entering",!0).attr("stroke-width",1).attr("stroke",Dt.dark_text).attr("fill","none")}updateEdgeLine(t){let i=1;this.showEdgeLine||"edge"===this.dataLabel.placement||(i=0),this.updatingEdges.transition("edgeOpacity").duration(this.duration).ease(W).attr("opacity",((s,h)=>"refEdges"===t&&0!==h?0:i))}exitEdgeLine(){this.exitingEdges.transition("exit").duration(this.duration).ease(W).attr("opacity",0)[this.duration?"attrTween":"attr"]("d",((t,i,s)=>{const h=s[i],e={startAngle:0,endAngle:0,innerRadius:(this.radius+this.radius*this.innerRatio)/2,outerRadius:(this.radius+this.radius*this.innerRatio)/2};if(!this.duration)return this.arc(e);const a=w(h._current,e);return t=>(h._current=a(t),this.arc(h._current))})).remove()}drawEdgeLine(){this.updatingEdges.attr("data-translate-x",this.radius+this.padding.left+this.margin.left).attr("data-translate-y",this.radius+this.padding.top+this.margin.top).attr("data-d",((t,i,s)=>{const h=s[i],e={startAngle:t.endAngle,endAngle:t.endAngle,innerRadius:Math.max(0,this.innerRadius-5),outerRadius:this.outerRadius+5};return a(h).attr("data-fake-x",this.arc.centroid(e)[0]).attr("data-fake-y",this.arc.centroid(e)[1]),this.arc(e)})).transition("update").duration(this.duration).ease(W)[this.duration?"attrTween":"attr"]("d",((t,i,s)=>{const h=s[i];let e=h._current;a(h).classed("entering")&&(e={startAngle:0,endAngle:0,innerRadius:Math.max(0,this.innerRadius-5),outerRadius:this.outerRadius+5},a(h).classed("entering",!1));const n={startAngle:t.endAngle,endAngle:t.endAngle,innerRadius:Math.max(0,this.innerRadius-5),outerRadius:this.outerRadius+5},r=w(e,n);return this.duration?t=>(h._current=r(t),this.arc(h._current)):(h._current=r(1),this.arc(n))}))}drawAnnotations(){pt({source:this.rootG.node(),data:this.annotations,width:this.width,height:this.height,padding:this.padding,margin:this.margin,bitmaps:this.bitmaps})}setAnnotationAccessibility(){rt(this.getLanguageString(),this.pieChartEl,this.annotations,this.refArr)}setTagLevels(){this.topLevel=Et(this.highestHeadingLevel),this.bottomLevel=Et(this.highestHeadingLevel,3)}setChartDescriptionWrapper(){_({language:this.getLanguageString(),rootEle:this.pieChartEl,title:this.accessibility.title||this.mainTitle,chartTag:"pie-chart",uniqueID:this.chartID,highestHeadingLevel:this.highestHeadingLevel,redraw:this.shouldRedrawWrapper,disableKeyNav:this.suppressEvents&&!1===this.accessibility.elementsAreInterface&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled,hideDataTable:this.accessibility.hideDataTableButton}),this.shouldRedrawWrapper=!1}setParentSVGAccessibility(){Q({chartTag:"pie-chart",language:this.getLanguageString(),node:this.svg.node(),title:this.accessibility.title||this.mainTitle,description:this.subTitle,uniqueID:this.chartID,geomType:"slice",includeKeyNames:this.accessibility.includeDataKeyNames,dataKeys:St(this,gt,"pie-chart"),dataKeyNames:this.dataKeyNames,groupName:"pie",disableKeyNav:this.suppressEvents&&!1===this.accessibility.elementsAreInterface&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled,normalized:this.showPercentage,valueAccessor:this.valueAccessor})}setGeometryAccessibilityAttributes(){this.update.each(((t,i,s)=>{B(s[i])})),this.updateRefPie.each(((t,i,s)=>{B(s[i])}))}setGeometryAriaLabels(){const t=St(this,gt,"pie-chart");this.update.each(((i,s,h)=>{U({chartTag:"pie-chart",language:this.getLanguageString(),node:h[s],geomType:"slice",includeKeyNames:this.accessibility.includeDataKeyNames,dataKeys:t,dataKeyNames:this.dataKeyNames,groupName:"pie",uniqueID:this.chartID,disableKeyNav:this.suppressEvents&&!1===this.accessibility.elementsAreInterface&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled,normalized:this.showPercentage,valueAccessor:this.valueAccessor}),J({node:h[s],uniqueID:this.chartID})})),this.updateRefPie.each(((i,s,h)=>{U({node:h[s],geomType:"slice",includeKeyNames:this.accessibility.includeDataKeyNames,dataKeys:t,groupName:"pie",uniqueID:this.chartID,disableKeyNav:this.suppressEvents&&!1===this.accessibility.elementsAreInterface&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled,normalized:this.showPercentage,valueAccessor:this.valueAccessor}),J({node:h[s],uniqueID:this.chartID})}))}setGroupAccessibilityAttributes(){B(this.pieG.node())}setGroupAccessibilityID(){this.pieG.each(((t,i,s)=>{J({node:s[i],uniqueID:this.chartID})}))}setChartAccessibilityTitle(){Y(this.getLanguageString(),this.pieChartEl,this.accessibility.title||this.mainTitle)}setChartAccessibilitySubtitle(){Z(this.getLanguageString(),this.pieChartEl,this.subTitle)}setChartAccessibilityLongDescription(){tt(this.getLanguageString(),this.pieChartEl,this.accessibility.longDescription)}setChartAccessibilityExecutiveSummary(){it(this.getLanguageString(),this.pieChartEl,this.accessibility.executiveSummary)}setChartAccessibilityPurpose(){st(this.getLanguageString(),this.pieChartEl,this.accessibility.purpose)}setChartAccessibilityContext(){ht(this.getLanguageString(),this.pieChartEl,this.accessibility.contextExplanation)}setChartAccessibilityStatisticalNotes(){et(this.getLanguageString(),this.pieChartEl,this.accessibility.statisticalNotes)}setChartCountAccessibility(){at({rootEle:this.pieChartEl,parentGNode:this.pieG.node(),chartTag:"pie-chart",geomType:"slice",groupName:"pie"})}setChartAccessibilityStructureNotes(){nt(this.getLanguageString(),this.pieChartEl,this.accessibility.structureNotes)}onChangeHandler(){this.accessibility&&"function"==typeof this.accessibility.onChangeFunc&&this.accessibility.onChangeFunc({updated:this.updated,added:this.enterSize,removed:this.exitSize}),this.updated=!1,this.enterSize=0,this.exitSize=0}updateCursor(){this.update.attr("cursor",this.suppressEvents?null:this.cursor),this.updatingLabels.attr("cursor",this.suppressEvents?null:this.cursor)}bindInteractivity(){this.update.on("click",this.suppressEvents?null:(t,i,s)=>this.onClickHandler(t.data,s[i])).on("mouseover",this.suppressEvents?null:(t,i,s)=>this.onHoverHandler(t.data,s[i])).on("mouseout",this.suppressEvents?null:()=>this.onMouseOutHandler()),this.updatingLabels.on("click",this.suppressEvents?null:(t,i,s)=>this.onClickHandler(t.data,s[i])).on("mouseover",this.suppressEvents?null:(t,i,s)=>this.onHoverHandler(t.data,s[i])).on("mouseout",this.suppressEvents?null:()=>this.onMouseOutHandler()),this.updatingLabelsNotes.on("click",this.suppressEvents?null:(t,i,s)=>this.onClickHandler(t.data,s[i])).on("mouseover",this.suppressEvents?null:(t,i,s)=>this.onHoverHandler(t.data,s[i])).on("mouseout",this.suppressEvents?null:()=>this.onMouseOutHandler())}onClickHandler(t,i){this.clickEvent.emit({data:t,target:i})}onHoverHandler(t,i){kt(this.chartID,!0),this.hoverEvent.emit({data:t,target:i}),this.showTooltip&&this.eventsTooltip({data:t,evt:n,isToShow:!0})}onMouseOutHandler(){kt(this.chartID,!1),this.mouseOutEvent.emit(),this.showTooltip&&this.eventsTooltip({isToShow:!1})}setTooltipInitialStyle(){wt(this.tooltipG)}eventsTooltip({data:t,evt:i,isToShow:s}){mt({root:this.tooltipG,data:t,event:i,isToShow:s,tooltipLabel:this.tooltipLabel,dataLabel:this.dataLabel,dataKeyNames:this.dataKeyNames,ordinalAccessor:this.ordinalAccessor,valueAccessor:this.valueAccessor,chartType:"pie",normalized:this.showPercentage})}render(){return this.drawStartEvent.emit({chartID:this.chartID}),this.init(),this.shouldSetLocalizationConfig&&(this.setLocalizationConfig(),this.shouldSetLocalizationConfig=!1),this.shouldSetTagLevels&&(this.setTagLevels(),this.shouldSetTagLevels=!1),this.shouldUpdateScales&&(this.prepareScales(),this.shouldUpdateScales=!1),this.shouldUpdateData&&(this.prepareData(),this.shouldUpdateData=!1),this.shouldUpdateLayout&&(this.setLayoutData(),this.shouldUpdateLayout=!1),this.shouldSetPieRadius&&(this.setPieRadius(),this.shouldSetPieRadius=!1),this.shouldUpdateInnerRatio&&(this.setInnerRatio(),this.shouldUpdateInnerRatio=!1),this.shouldValidateInteractionKeys&&(this.validateInteractionKeys(),this.shouldValidateInteractionKeys=!1),this.shouldUpdateTableData&&(this.setTableData(),this.shouldUpdateTableData=!1),this.shouldValidate&&(this.shouldValidateAccessibilityProps(),this.shouldValidateLocalizationProps(),this.shouldValidateLocalizationProps(),this.shouldValidate=!1),this.shouldSetColors&&(this.setColors(),this.shouldSetColors=!1),s("div",{class:"o-layout is--vertical"},s("div",{class:"o-layout--chart"},s(this.topLevel,{class:"pie-main-title vcl-main-title"},this.mainTitle),s(this.bottomLevel,{class:"visa-ui-text--instructions pie-sub-title vcl-sub-title"}),s("keyboard-instructions",{uniqueID:this.chartID,geomType:"slice",groupName:"pie",language:this.getLanguageString(),chartTag:"pie-chart",width:this.width-(this.margin&&this.margin.right||0),isInteractive:this.accessibility.elementsAreInterface,hasCousinNavigation:!1,disabled:this.suppressEvents&&!1===this.accessibility.elementsAreInterface&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled}),s("div",{class:"visa-viz-d3-pie-container"}),s("div",{class:"pie-tooltip vcl-tooltip",style:{display:this.showTooltip?"block":"none"}}),s("data-table",{uniqueID:this.chartID,isCompact:!0,language:this.getLanguageString(),tableColumns:this.tableColumns,dataKeyNames:this.dataKeyNames,data:this.tableData,padding:this.padding,margin:this.margin,hideDataTable:this.accessibility.hideDataTableButton,unitTest:this.unitTest})))}init(){const t=Object.keys(P);let i=0;const s={showLabelNote:{exception:!1},innerRatio:{exception:0},showPercentage:{exception:!1},showTooltip:{exception:!1},mainTitle:{exception:""},subTitle:{exception:""},hoverOpacity:{exception:0}};for(i=0;i<t.length;i++)this[t[i]]=this[t[i]]||s[t[i]]&&this[t[i]]===s[t[i]].exception?this[t[i]]:P[t[i]]}get pieChartEl(){return h(this)}static get watchers(){return{mainTitle:["titleWatcher"],subTitle:["subtitleWatcher"],highestHeadingLevel:["headingWatcher"],centerTitle:["centerTitleWatcher"],centerSubTitle:["centerTitleWatcher"],height:["layoutWatcher"],width:["layoutWatcher"],padding:["layoutWatcher"],margin:["layoutWatcher"],data:["dataWatcher"],uniqueID:["idWatcher"],ordinalAccessor:["ordinalAccessorWatcher"],valueAccessor:["valueAccessorWatcher"],sortOrder:["sortWatcher"],colorPalette:["paletteWatcher"],colors:["colorsWatcher"],innerRatio:["innerRatioWatcher"],showEdgeLine:["showEdgeLineWatcher"],referenceStyle:["referenceWatcher"],hoverOpacity:["hoverOpacityWatcher"],cursor:["cursorWatcher"],showPercentage:["showPercentageWatcher"],showTooltip:["showTooltipWatcher"],tooltipLabel:["tooltipLabelWatcher"],dataLabel:["labelWatcher"],showLabelNote:["labelNoteWatcher"],labelOffset:["labelOffsetWatcher"],localization:["localizationWatcher"],accessibility:["accessibilityWatcher"],annotations:["annotationsWatcher"],referenceData:["referenceDataWatcher"],suppressEvents:["suppressWatcher"],clickStyle:["clickStyleWatcher"],hoverStyle:["hoverStyleWatcher"],clickHighlight:["clickWatcher"],hoverHighlight:["hoverWatcher"],interactionKeys:["interactionWatcher"],dataKeyNames:["dataKeyNamesWatcher"],unitTest:["unitTestWatcher"]}}};window.VisaChartsLibOSSLicenses=xt(),Kt.style=".o-layout{width:100%;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.o-layout--chart{width:100%}.is--vertical .o-layout--chart{width:90%}pie-chart .vcl-sub-title-keyword{-webkit-padding-before:1px;padding:3px 6px 1px 6px}pie-chart .annotations{pointer-events:none}pie-chart .annotations .handle{pointer-events:all}pie-chart .screen-reader-info{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}pie-chart .data-table-link{color:#767676;text-decoration:none;font-size:12px;margin-left:5%}pie-chart .hidden{display:none}pie-chart .pie-tooltip{z-index:1}pie-chart .arc text{font:0.625rem sans-serif;text-anchor:middle;cursor:default}pie-chart .pie-dataLabel-highlight{font-size:1.5rem;font-weight:300}pie-chart .pie-dataLabel-note{font-size:0.75rem;fill:#767676}pie-chart .pie-center-title-group{fill:#767676}pie-chart .pie-center-title-group .visa-ui-header--1{font-size:2rem}";export{Kt as pie_chart}